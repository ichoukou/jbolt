var jbolt_admin_js_version="2.9.9";var jboltJsDevMode=false;var jboltWindow=$(window);var jboltDocument=$(document);var jboltBody=$("body");var jboltAdmin=jboltBody.find(".jbolt_admin");var jboltAdminLeftNavs=jboltBody.find(".jbolt_admin_left_navs");var jboltWindowWidth=jboltWindow.width();var jboltWindowHeight=jboltWindow.height();var mainPjaxContainerId="#jbolt-container";var mainPjaxContainer=$(mainPjaxContainerId);var summernote_img_uploadurl="admin/summernote/upload/image/";var hasImportSelect2=false;var multipleUploadFiles=new Array();var JBOLT_ASSETS_VERSION=$.trim($("#JBOLT_ASSETS_VERSION").text());if(!JBOLT_ASSETS_VERSION){JBOLT_ASSETS_VERSION=randomId()}var JBOLT_BASE_UPLOAD_PATH_PRE=$.trim($("#JBOLT_BASE_UPLOAD_PATH_PRE").text());var loadedPlugins={};var jboltPlugins={"morris":{"js":["assets/plugins/morris/morris.min.js","assets/plugins/morris/raphael.min.js"],"css":["assets/plugins/morris/morris.css"]},"webcam":{"js":["assets/plugins/webcam/jquery.webcam.min.js"]},"summernote":{"js":["assets/plugins/summernote/summernote-bs4.min.js","assets/plugins/summernote/lang/summernote-zh-CN.min.js"],"css":["assets/plugins/summernote/summernote-bs4.css"]},"neditor":{"js":["assets/plugins/neditor/neditor.config.js","assets/plugins/neditor/neditor.all.js","assets/plugins/neditor/neditor.service.js"]},"fileinput":{"js":["assets/plugins/bootstrap-fileinput/js/plugins/canvas-to-blob.min.js","assets/plugins/bootstrap-fileinput/js/plugins/sortable.min.js","assets/plugins/bootstrap-fileinput/js/plugins/piexif.min.js","assets/plugins/bootstrap-fileinput/js/plugins/purify.min.js","assets/plugins/bootstrap-fileinput/js/fileinput.min.js","assets/plugins/bootstrap-fileinput/themes/fa/theme.min.js","assets/plugins/bootstrap-fileinput/themes/explorer-fa/theme.min.js","assets/plugins/bootstrap-fileinput/js/locales/zh.js"],"css":["assets/plugins/bootstrap-fileinput/css/fileinput.min.css","assets/plugins/bootstrap-fileinput/themes/explorer-fa/theme.min.css"]},"imgviewer":{"js":["assets/plugins/viewer/js/viewer.min.js","assets/plugins/viewer/js/jquery-viewer.min.js"],"css":["assets/plugins/viewer/css/viewer.min.css"]},"jbolttable":{"js":["assets/plugins/jbolt-table/jbolt-table"+(jboltJsDevMode?"":".min")+".js?v="+(jboltJsDevMode?(randomId()):JBOLT_ASSETS_VERSION)],"css":["assets/plugins/jbolt-table/jbolt-table"+(jboltJsDevMode?"":".min")+".css?v="+(jboltJsDevMode?(randomId()):JBOLT_ASSETS_VERSION)]},"jstree":{"js":["assets/plugins/jstree/jstree.min.js"],"css":["assets/plugins/jstree/themes/default/style.min.css"]},"splitjs":{"js":["assets/plugins/splitjs/split/split.min.js"]}};var g=function(a){return"string"==typeof a?document.getElementById(a):a};var isOk=function(a){return a&&a.length>0};var jboltlog=function(a){if(jboltJsDevMode){console.log(a)}};function jstreeSetJBoltInputValueHandler(a,b){JBoltInputUtil.setValue(a,b.text,b.id)}function jboltInputSetValueHandler(b,c,a){JBoltInputUtil.setValue(b,c,a)}var JBoltInputUtil={init:function(c){var b=getRealJqueryObject(c);if(!isOk(b)){return false}var a=b.find("input[data-jboltinput]");if(!isOk(a)){return false}this.initInputs(a)},initInputs:function(b){if(!isOk(b)){return false}var d=this;var a=b.length;for(var c=0;c<a;c++){d.initInput(b.eq(c))}},filterTable:function(a){if(isOk(a.input_layer)){var d=$.trim(a.val());if(isOk(d)){var c,e,b=a.input_layer.find("table>tbody");b.find("tr").each(function(){c=$(this);e=c.text();if(e.indexOf(d)!=-1){c.css({"color":"#f00"}).show(100)}else{c.css({"color":"#333"}).hide(100)}})}else{a.input_layer.find("table>tbody>tr").css({"color":"#333"}).show(100)}}},initInput:function(input){var that=this;var readonly=input.data("readonly");var filterHandler=input.data("filter-handler");var canInput=true;if(!filterHandler&&(readonly==undefined||(typeof(readonly)=="boolean"&&readonly==true))){input.attr("readonly","readonly");canInput=false}var loadType=input.data("load-type");if(!loadType){loadType="html";input.data("load-type",loadType)}var checkSuccess=false;if(loadType=="html"){checkSuccess=that.checkInputByHtml(input)}else{if(loadType=="ajaxportal"){checkSuccess=that.checkInputByAjaxPortal(input)}}if(checkSuccess){var inputId=input.attr("id");if(!inputId){inputId=randomId();input.attr("id",inputId)}input.off("click").on("click",function(e){e.preventDefault();e.stopPropagation();that.showJBoltInputLayer(input);return false});if(canInput&&filterHandler){input.off("input").on("input",function(e){e.preventDefault();e.stopPropagation();if(filterHandler=="filterTable"){that.filterTable(input)}else{var exe_handler=eval(filterHandler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler(input)}}return false})}}},hideJBoltInputLayer:function(a){if(isOk(a)){if(isOk(a.input_layer)){a.input_layer.slideUp(100);var c=a.input_layer.find(".jbolt_ajaxportal_menu");if(isOk(c)){c.hide()}}}else{var b=$(".jbolt_input_layer");if(isOk(b)){b.find(".jbolt_ajaxportal_menu").hide();b.slideUp(100)}}},setValue:function(o,m,f){var c=getRealJqueryObject(o);var j=c.closest(".jbolt_input_layer");
if(isOk(j)){var h=j.data("jbolt-input-id");if(isOk(h)){var k=j.prev("#"+h);var e=k.data("zero-clear");k.val((e&&(!f||isOk(f)==false||(typeof(f)=="string"&&f=="0")))?"":m);var d=k.data("hidden-input");if(d){if(d.indexOf(",")!=-1){var l=d.split(",");var a=isArray(f);var n=l.length;if(isOk(l)&&a&&n==f.length){for(var b=0;b<n;b++){$("#"+l[b]).val(f[b])}}else{alert("id为："+h+"的JBoltInput组件 隐藏域个数与赋值个数不一致")}}else{$("#"+d).val(f)}}}}this.hideJBoltInputLayer()},showJBoltInputLayer:function(k){var i=this;var a=k.input_layer;if(isOk(a)&&!a.is(":hidden")){return false}i.hideJBoltInputLayer();var e=k.data("load-type");if(!a){a=$("<div class='jbolt_input_layer'></div>");if(e=="html"){var r=k.data("content-id");var l=getRealJqueryObject(r);if(isOk(l)){l.addClass("show");a.append(l)}else{a.html('<div class="alert alert-warning d-inline-block"><i class="fa fa-warning mr-1"></i>暂无数据</div>')}a.insertAfter(k)}else{var d=k.data("url");d=actionUrl(d);var b=$('<div data-ajaxportal data-refresh data-url="'+d+'"></div>');a.append(b);a.insertAfter(k);b.ajaxPortal(true)}a.on("click",function(t){t.preventDefault();t.stopPropagation();return false});a.on("click",".jbolt_ajaxportal_menu a[data-func='refresh']",function(u){u.preventDefault();u.stopPropagation();var v=$(this).closest(".jbolt_ajaxportal_menu");v.hide();var t=v.closest("[data-ajaxportal][data-refresh]");t.ajaxPortal(true);return false})}else{if(e=="html"){var r=k.data("content-id");var l=a.find("#"+r);if(!isOk(l)){var l=getRealJqueryObject(r);if(isOk(l)){l.addClass("show");a.append(l)}else{a.html('<div class="alert alert-warning d-inline-block"><i class="fa fa-warning mr-1"></i>暂无数据</div>')}}}else{var s=a.find("[data-ajaxportal]");if(!isOk(s)){var b=$('<div data-ajaxportal data-url="'+d+'"></div>');a.append(b);b.ajaxPortal(true)}}}var f=k.offset(),n=k.outerHeight(),m=f.top+n+4,c=f.left,p=k.outerWidth(),h=k.data("width"),q=k.data("height");dataMaxHeight=k.data("max-height");if(h&&h>p){var j=jboltWindowWidth-c-20;if(j<h&&j>p){p=j}else{p=h}}if(!q){q=400}var o=k.attr("id");a.data("jbolt-input-id",o);a.css({"top":m+"px","left":c+"px","width":p+"px","max-width":p+"px","max-height":q+"px"});k.input_layer=a;a.slideDown(100)},checkInputByHtml:function(a){var b=this;var c=a.data("content-id");if(!c){showFormEleErrorStyle(a,"请设置data-content-id属性");return false}return true},checkInputByAjaxPortal:function(a){var c=this;var b=a.data("url");if(!b){c.showErrorStyle(a,"请设置data-url属性");return false}return true}};function jsonToUrlParams(e){var d=[];for(var c in e){var b=encodeURIComponent(c);var f=encodeURIComponent(e[c]);d.push(b+"="+f)}var a=d.join("&");return a}var DownloadUtil={downloadByEle:function(k){var h=this,b=getRealJqueryObject(k),a=b.data("url"),f=b.data("downloading");if(!a){LayerMsgBox.alert("请设置data-url='下载地址'！",2);return false}var i=b.data("form"),e=b.data("filename"),c=b.data("loading"),d,j=b.data("handler");if(i){d=$("#"+i).serialize()}h.download({ele:b,url:a,fileName:e,params:d,loading:c,handler:j})},init:function(){var a=this;jboltBody.on("click","[data-downloadbtn]",function(b){b.preventDefault();b.stopPropagation();a.downloadByEle(this);return false})},download:function(b){var a=b.url,e=b.loading||"下载中...";if(!a){LayerMsgBox.alert("请设置data-url='下载地址'！",2);return false}if(b.ele.data("downloading")){LayerMsgBox.alert("正在下载,请稍等",0);return false}b.ele.data("downloading",true);if(b.params){var d=b.params;if(typeof(b.params)=="object"){d=jsonToUrlParams(b.params)}if(d){if(a.indexOf("?")!=-1){a=a+"&"+d}else{a=a+"?"+d}}}LayerMsgBox.loading(e,jboltAjaxTimeout);var c=new XMLHttpRequest();c.timeout=jboltAjaxTimeout;c.open("GET",a,true);c.responseType="blob";c.onload=function(){if(this.status===200){var h=this.response;var f=new FileReader();f.readAsDataURL(h);f.onload=function(k){var j=document.createElement("a");if(b.fileName){j.download=b.fileName}else{var l=c.getResponseHeader("Content-disposition");if(l){l=decodeURI(l);var i=l.split("=");if(i&&i.length==2){j.download=$.trim(i[1])}}else{b.ele.data("downloading",false);LayerMsgBox.alert("下载失败,未设置下载文件的filename",2);return false}}j.href=k.target.result;jboltBody.append(j);j.click();$(j).remove();b.ele.data("downloading",false);LayerMsgBox.closeLoading()}}else{b.ele.data("downloading",false);LayerMsgBox.alert("网络异常",2)}};c.send()}};var JSTreeUtil={delNodeId:0,init:function(c){var b=getRealJqueryObject(c);if(!isOk(b)){return false}var a=b.find("div[data-jstree],section[data-jstree],p[data-jstree]");if(!isOk(a)){return false}this.initTrees(a)},initTrees:function(a){if(!isOk(a)){return false}var b=this;loadJBoltPlugin(["jstree"],function(){var c=a.length;for(var d=0;d<c;d++){b.initTree(a.eq(d),false)}})},initTree:function(a,c){var b=this;if(c){loadJBoltPlugin(["jstree"],function(){b._initTree(a)})}else{b._initTree(a)}},processCurdDialog:function(a,b,c,d){alert("dialog")},processDeletePortal:function(a,b,d,e){var c=this;LayerMsgBox.confirm("确定删除此项?",function(){LayerMsgBox.loading("执行中...");Ajax.get(b,function(f){LayerMsgBox.success("删除成功",1000);
c.delNodeId=e.id;if(d.is_selected(e)){d.delete_node(d.get_selected())}else{d.delete_node(e)}})})},processCurdPortal:function(b,d,e,h,i){var f=this;var c=b.data("portalid");var a=$("#"+c);if(e=="delete"){f.processDeletePortal(b,d,h,i)}else{a.ajaxPortal(true,d,true)}},refresh:function(a,b){var c=a.data("read-url");if(c.indexOf("?")!=-1){c=c+"&selectId="+b}else{if(c[c.length-1]!="/"){c=c+"/"+b}else{c=c+b}}Ajax.get(c,function(e){var d=e.data;a.jstree(true).deselect_all();a.jstree(true).settings.core.data=d;a.jstree(true).refresh();if(b){setTimeout(function(){a.jstree(true).select_node({id:b,selected:true})},100)}})},processCurdHandler:function(k,c,j){var i=k.data("target");if(i==undefined||i=="undefined"){i="dialog"}var f=$.jstree.reference(c),d=f.get_node(c);var b=d.id;if((b==0&&j=="delete")||(b==0&&j=="edit")||(b>0&&i=="dialog"&&j=="edit")){LayerMsgBox.alert("不能操作根节点",2);return false}var h=this;var e=d.id;var a="";switch(j){case"add":a=k.data("add-url")+e;break;case"edit":a=k.data("edit-url")+e;break;case"portalEdit":a=k.data("edit-url")+e;break;case"delete":a=k.data("delete-url")+e;break}switch(i){case"dialog":h.processCurdDialog(k,a,j,f,d);break;case"portal":h.processCurdPortal(k,a,j,f,d);break}},processChangeTextHandler:function(a,d,b){var c=this;switch(b){case"portalEdit":c.processCurdHandler(a,d,"portalEdit");break}},_initTree:function(tree){var that=this;var read_url=tree.data("read-url");var curd=tree.data("curd");if(curd==undefined||curd=="undefined"){curd=false}var treeOptions={"core":{"data":[],"check_callback":true},"plugins":["themes","wholerow","dnd"],};if(curd){var target=tree.data("target");if(target&&target=="portal"){var portalId=tree.data("portalid");if(!portalId){LayerMsgBox.alert("当data-target='portal'时，请设置:data-portalid",2);return false}}var createUrl=tree.data("add-url");if(!createUrl){LayerMsgBox.alert("请设置创建节点的接口地址:data-add-url",2);return false}var updateUrl=tree.data("edit-url");if(!updateUrl){LayerMsgBox.alert("请设置更新节点的接口地址:data-edit-url",2);return false}var deleteUrl=tree.data("delete-url");if(!deleteUrl){LayerMsgBox.alert("请设置创建节点的接口地址:data-delete-url",2);return false}var moveUrl=tree.data("move-url");if(!moveUrl){LayerMsgBox.alert("请设置创建节点的接口地址:data-move-url",2);return false}treeOptions["plugins"].push("contextmenu");treeOptions["contextmenu"]={"items":{"refresh":{"label":"刷新数据","action":function(data){var reference=data.reference;var inst=$.jstree.reference(reference),obj=inst.get_node(reference);that.refresh(tree,obj.id);return false}},"add":{"label":"创建子项","action":function(data){var reference=data.reference;that.processCurdHandler(tree,reference,"add");return false}},"edit":{"label":"编辑此项","action":function(data){var reference=data.reference;that.processCurdHandler(tree,reference,"edit");return false}},"delete":{"label":"删除此项","action":function(data){var reference=data.reference;that.processCurdHandler(tree,reference,"delete");return false}}}}}else{tree.on("contextmenu",function(){return false})}var openType=tree.data("open-type");if(openType){if(read_url.charAt(read_url.length-1)=="/"){read_url=read_url.substring(0,read_url.length-1)}if(read_url.indexOf("?")!=-1){read_url=read_url+"&openType="+openType}else{read_url=read_url+"?openType="+openType}}Ajax.get(read_url,function(data){var treeDatas=data.data;treeOptions["core"]["data"]=treeDatas;var theTree=tree.jstree(treeOptions);var changehandler=tree.data("change-handler");if(changehandler){theTree.on("changed.jstree",function(e,tdata){if(tdata&&tdata.node){if(typeof(changehandler)=="string"&&changehandler=="portalEdit"){that.processChangeTextHandler(tree,tdata.node,"portalEdit")}else{var exe_handler=eval(changehandler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler(tree,tdata.node)}}}})}if(curd){theTree.on("move_node.jstree",function(e,tdata){Ajax.post(moveUrl,{"id":tdata.node.id,"pid":tdata.parent,"rank":tdata.position},function(res){that.refresh(tree,tdata.node.id);LayerMsgBox.success("操作成功",1000)})})}})}};AssetsLazyLoad=(function(m){var j,k,b={},f=0,i={css:[],js:[]},p=m.styleSheets,d,h;function o(s,r){var t=m.createElement(s),q;for(q in r){if(r.hasOwnProperty(q)){t.setAttribute(q,r[q])}}return t}function l(q){var s=b[q],t,r;if(s){t=s.callback;r=s.urls;r.shift();f=0;if(!r.length){t&&t.call(s.context,s.obj);b[q]=null;i[q].length&&n(q)}}}function c(){var q=navigator.userAgent;j={async:m.createElement("script").async===true};(j.webkit=/AppleWebKit\//.test(q))||(j.ie=/MSIE|Trident/.test(q))||(j.opera=/Opera/.test(q))||(j.gecko=/Gecko\//.test(q))||(j.unknown=true)}function n(B,A,C,x,t){d=new Date().getTime();var v=function(){l(B)},D=B==="css",r=[],w,y,u,s,z,q;j||c();if(A){A=typeof A==="string"?[A]:A.concat();if(D||j.async||j.gecko||j.opera){i[B].push({urls:A,callback:C,obj:x,context:t})}else{for(w=0,y=A.length;w<y;++w){i[B].push({urls:[A[w]],callback:w===y-1?C:null,obj:x,context:t})}}}if(b[B]||!(s=b[B]=i[B].shift())){return}k||(k=m.head||m.getElementsByTagName("head")[0]);z=s.urls.concat();for(w=0,y=z.length;w<y;++w){q=z[w];
if(D){u=j.gecko?o("style"):o("link",{href:q,rel:"stylesheet"})}else{u=o("script",{src:q});u.async=false}u.className="lazyload";u.setAttribute("charset","utf-8");if(j.ie&&!D&&"onreadystatechange" in u&&!("draggable" in u)){u.onreadystatechange=function(){if(/loaded|complete/.test(u.readyState)){u.onreadystatechange=null;v()}}}else{if(D&&(j.gecko||j.webkit)){if(j.webkit){s.urls[w]=u.href;e()}else{u.innerHTML='@import "'+q+'";';a(u)}}else{u.onload=u.onerror=v}}r.push(u)}for(w=0,y=r.length;w<y;++w){k.appendChild(r[w]);var q=z[w];if(/.js/.exec(q)){jboltlog((w+1)+"--> js成功:  "+q)}else{if(/.css/.exec(q)){jboltlog((w+1)+"--> css成功:  "+q)}else{console.log("error:  "+q)}}}h=new Date().getTime();jboltlog("执行时间: "+(h-d)+" ms  -------  end时间戳:"+h)}function a(s){var r;try{r=!!s.sheet.cssRules}catch(q){f+=1;if(f<200){setTimeout(function(){a(s)},50)}else{r&&l("css")}return}l("css")}function e(){var r=b.css,q;if(r){q=p.length;while(--q>=0){if(p[q].href===r.urls[0]){l("css");break}}f+=1;if(r){if(f<200){setTimeout(e,50)}else{l("css")}}}}return{css:function(s,t,r,q){n("css",s,t,r,q)},js:function(s,t,r,q){n("js",s,t,r,q)}}})(this.document);var ImageViewerUtil={initViewers:function(a){if(!isOk(a)){return false}var b=this;loadJBoltPlugin("imgviewer",function(){var c=a.length;for(var d=0;d<c;d++){b.initViewer(a.eq(d),false)}})},init:function(c){var b=getRealJqueryObject(c);if(!isOk(b)){return false}var a=b.find("[data-imgviewer]");if(!isOk(a)){return false}this.initViewers(a)},_initViewer:function(d){var c=d[0].tagName.toLowerCase()=="img";if(c){var b=d.data("orignurl");if(b){d.viewer({navbar:false,url:"data-orignurl"})}else{d.viewer({navbar:false})}}else{var a=d.data("useorign");if(a){d.viewer({url:"data-orignurl"})}else{d.viewer()}}},initViewer:function(c,b){var a=this;if(b){loadJBoltPlugin("imgviewer",function(){a._initViewer(c)})}else{this._initViewer(c)}}};function processAutocompleteItem(d,f){var j="";if(f.indexOf(",")==-1){j=d[f];if(!j&&(j=="undefined"||j==undefined)){if(f!="text"){j=d["text"];if(!j&&(j=="undefined"||j==undefined)){j=d["name"];if(!j&&(j=="undefined"||j==undefined)){j=d["title"]}}}else{if(!j&&(j=="undefined"||j==undefined)){j=d["name"];if(!j&&(j=="undefined"||j==undefined)){j=d["title"]}}}}return"<span style='width:100%;'>"+j+"</span>"}var h=f.split(",");var k,e,a,b;for(var c in h){e=h[c];if(e.indexOf("_")!=-1){a=e.split("_");k=d[a[0]];b=a[1]}else{k=d[e];b="100px"}j=j+"<span style='width:"+b+";'>"+(k?k:"-")+"</span>"}return j}var AutocompleteUtil={initInputs:function(b){if(!isOk(b)){return false}var a=b.length;for(var c=0;c<a;c++){this.initInput(b.eq(c))}},init:function(c){var b=getRealJqueryObject(c);if(!isOk(b)){return false}var a=b.find("input[data-autocomplete]");if(!isOk(a)){return false}this.initInputs(a)},defaultFormat:function(b,a){return processAutocompleteItem(b,a)},processGetSyncEditor:function(c,b){var d=c.data("sync-editor-id");if(!d){return null}var h=c.data("sync-editor-type");var a=c.data("sync-attr");var e=document.createElement("input");var f=$(e);f.data("editor-id",d);f.data("editor-type",h);f.data("value-attr",a?a:b);return f},processGetAutocomplateHiddens:function(c){var b=new Array();if(c){if(c.indexOf(",")==-1){b.push($("#"+c))}else{var a=c.split(",");for(var d in a){b.push($("#"+a[d]))}}}return b},changeHiddenInputValue:function(c,f,d){var e=c.data("value-attr");var h="";if(e){if(e=="value"){h=h+(d?d:"")}else{h=h+f[e]}}else{h=h+(d?d:"")}var a=c.data("editor-type");if(a){var b=c.data("editor-id");if(a=="neditor"){UE.getEditor(b).execCommand("insertHtml",h)}else{if(a=="summernote"){$("#"+b).summernote("code",h)}else{c.val(h)}}}else{c.val(h)}},changeHiddenInputsValue:function(a,d,c){if(isArray(a)){for(var b in a){this.changeHiddenInputValue(a[b],d,c)}}else{this.changeHiddenInputValue(a,d,c)}},clearHiddenInputsValue:function(a){if(isArray(a)){for(var b in a){a[b].val("")}}else{a.val("")}},initInput:function(input){var url=input.data("url");if(!url){LayerMsgBox.alert("autocomplete组件未设置data-url属性",2);return false}url=actionUrl(url);var hiddenInputId=input.data("hiddeninput");var synceditor_id=input.data("sync-editor-id");if(!hiddenInputId&&!synceditor_id){LayerMsgBox.alert("autocomplete组件未设置data-hiddeninput或data-sync-editor-id属性,需关联指定的隐藏域或者editor",2);return false}var that=this,syncInputArray=new Array(),width=input.data("width"),widthAuto=false,text_attr=input.data("text-attr"),value_attr=input.data("value-attr"),column_attr=input.data("column-attr"),formatHandler=input.data("format-handler"),handler=input.data("handler"),limit=input.data("limit");if(!limit){limit=100}if(!width){width=parseInt(input.css("width"));widthAuto=true}if(!text_attr){text_attr="text"}if(!value_attr){value_attr="value"}if(!column_attr){column_attr=text_attr}if(column_attr.indexOf(",")!=-1&&widthAuto){var arr=column_attr.split(",");var autoW=(arr.length+1)*90;if(autoW>width){width=autoW}}var hiddenInput=that.processGetAutocomplateHiddens(hiddenInputId),editor=that.processGetSyncEditor(input,value_attr);if(editor){hiddenInput.push(editor)
}if(hiddenInput.length==0){LayerMsgBox.alert("请关联指定的正确的隐藏域或者editor",2);return false}input.autocomplete(url,{minChars:0,width:width,scrollHeight:300,matchContains:true,autoFill:false,matchSubset:false,mustMatch:false,dataType:"json",max:limit,parse:function(res){var rows=[];if(!res||(!res.data)){return rows}var datas=res.data,size=datas.length,text,value;for(var i=0;i<size;i++){text=processOptionText(datas[i],text_attr);value=processOptionValue(datas[i],value_attr);rows[rows.length]={data:datas[i],value:value,result:text}}return rows},formatItem:function(row,i,max){return that.defaultFormat(row,column_attr)}}).result(function(e,data,value,sec){that.changeHiddenInputsValue(hiddenInput,data,value);if(handler){var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler(input,hiddenInput,value)}}}).bind("unmatch",function(){input.val("");that.clearHiddenInputsValue(hiddenInput);if(handler){var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler(input,hiddenInput,value)}}}).blur(function(){if(isArray(hiddenInput)){var clear=true,hinput;for(var i in hiddenInput){hinput=hiddenInput[i];if($.trim(hinput.val())){clear=false}}if(clear){input.val("")}}else{if(hiddenInput.val()==""){input.val("")}}}).on("input",function(){that.clearHiddenInputsValue(hiddenInput)})}};function closeJBoltLayer(){JBoltLayerUtil.close()}var JBoltLayerUtil={init:function(){var a=this;jboltBody.on("click","[data-jboltlayertrigger]",function(b){b.preventDefault();b.stopPropagation();JBoltInputUtil.hideJBoltInputLayer();JBoltTabUtil.hideJboltContextMenu();FormDate.hide();a.open($(this));return false}).on("click","[data-closejboltlayer]",function(b){b.preventDefault();b.stopPropagation();a.close();return false}).on("click",".jbolt_layer",function(c){c.preventDefault();c.stopPropagation();var b=$(this);if(!b.data("cancel-click")){a.close()}return false}).on("click",".jbolt_layer_portal",function(b){if(b.target.tagName.toLowerCase()!="input"){FormDate.hide()}JBoltInputUtil.hideJBoltInputLayer();b.stopPropagation()}).on("click",".jbolt_admin_main",function(b){a.close()}).on("submit",".jbolt_layer_portal form[data-jboltlayersubmit]",function(){var c=$(this);var b=c.closest("[data-ajaxportal]");if(isOk(b)){var d=c.data("needcheck");if(d!=undefined&&d!=null&&d==true){if(FormChecker.check(c)){formSubmitToAjaxPortal(c,b)}}else{formSubmitToAjaxPortal(c,b)}}return false})},openByNav:function(b,c){var a=$("<a style='display:none;' class='openByNavTrigger' href='"+b+"'></a>");if((typeof(c.close)=="string"&&c.close=="false")||(typeof(c.close)=="boolean"&&c.close==false)){a.data("noclose",true);a.attr("data-noclose","true")}if((typeof(c.nomask)=="string"&&c.nomask=="true")||(typeof(c.nomask)=="boolean"&&c.nomask==true)){a.data("nomask",true);a.attr("data-nomask","true")}if((typeof(c.resize)=="string"&&c.resize=="true")||(typeof(c.resize)=="boolean"&&c.resize==true)){a.data("resize",true);a.attr("data-resize","true")}if(c.width){a.data("width",c.width)}if(c.dir){a.data("dir",c.dir)}if(c.confirm){a.data("confirm",c.confirm);a.attr("data-confirm",c.confirm)}if(c.height){a.data("height",c.height)}else{if(c.top){a.data("top",c.top)}}jboltBody.append(a);this.open(a)},open:function(e){var b=e.attr("href");if(!b){b=e.data("url")}if(!b){LayerMsgBox.alert("jboltlayertrigger未设置URL",2);return false}var k=false;var o=$("#jbolt_layer");if(o&&o.length==1){if(e[0].hasAttribute("data-keep-open")&&e.data("keep-open")){k=true}if(k==false){o.remove()}}var m=e.attr("id");if(!m){m=randomId();e.attr("id",m)}var l=e.data("top");if(l&&typeof(l)=="string"&&l.indexOf("%")!=-1){var d=Number(l.replace("%",""));l=parseInt(jboltWindowHeight*d/100)}else{if(l&&typeof(l)=="string"&&l.indexOf("%")==-1){l=Number(l)}}if(!l&&l!=0){l=0}var n=e.data("height");if(n){if(typeof(n)=="string"&&n.indexOf("%")!=-1){var d=Number(n.replace("%",""));n=parseInt(jboltWindowHeight*d/100)}else{if(typeof(n)=="string"&&n.indexOf("%")==-1){n=Number(n)}}if(l==0){l=jboltWindowHeight-n;if(l<0){l=0}}}var a=true;if(e[0].hasAttribute("data-noclose")){a=false}var i=e[0].hasAttribute("data-nomask");var c=e.data("width");if(c&&typeof(c)=="string"&&c.indexOf("%")!=-1){var d=Number(c.replace("%",""));c=parseInt(jboltWindowWidth*d/100)}else{if(c&&typeof(c)=="string"&&c.indexOf("%")==-1){c=Number(c)}}if(!c){c=jboltWindowWidth/2;if(c<900){c=900}else{if(c>1360){c=1360}}}e.data("portal-width",c);var f=e.data("dir");if(!f){f="right";e.data("dir",f)}var h=e.data("resize");if(k==false){var j=$('<div draggable="false" data-triggerid="'+m+'" class="jbolt_layer '+(i?" nomask ":"")+f+(a?" hasclose ":" noclose ")+'" id="jbolt_layer">'+(h?"<div style='top:"+l+"px;' class='jbolt_layer_resizebox'></div><div style='top:"+(a?(l+40):l)+"px;' class='jbolt_layer_resizebar'></div>":"")+'<div draggable="false" data-dir="'+f+'" class="jbolt_layer_portal '+(h?"resize":"")+'"  style="top:'+l+"px;width:"+c+'px"   data-ajaxportal  data-url="'+b+'"></div></div>');jboltBody.append(j);if(a){j.append('<a data-closejboltlayer  style="top:'+l+'px;"  class="jbolt_layer_close">&times;</a>')
}this.load();this.showOpenAnimate(e);if(h){this.processResizeEvent(j,e)}}else{this.load(b)}},processResizeEvent:function(c,b){var d=this,i=c.find(".jbolt_layer_portal"),h=c.find(".jbolt_layer_resizebar"),f=c.find(".jbolt_layer_resizebox"),a=b.data("dir"),e=c.find(".jbolt_layer_close");if(isOk(i)&&isOk(h)){h.on("mousedown",function(n){FormDate.hide(c);JBoltInputUtil.hideJBoltInputLayer();n.preventDefault();n.stopPropagation();c.addClass("resizing");c.data("resizing",true);c.data("cancel-click",true);c.css("cursor","e-resize");var p=i.offset(),o=getMousePos(n),j,l,k=p.left-o.x,m=Math.abs(k);if(a=="right"){j=o.x;l=0;f.css({left:j,right:l})}else{j=0;l=o.x;f.css({left:j,width:l})}return false}).on("click",function(j){j.preventDefault();j.stopPropagation();return false});c.on("mouseup",function(k){k.preventDefault();var j=c.data("resizing");if(j){k.preventDefault();k.stopPropagation();var l=getMousePos(k);d.resize(i,e,h,l.x);c.data("resizing",false);c.removeAttr("data-resizing");c.css("cursor","auto");setTimeout(function(){c.data("cancel-click",false);c.removeClass("resizing")},60);return false}}).on("mousemove",function(o){o.preventDefault();o.stopPropagation();var j=c.data("resizing");if(j){var q=i.offset(),p=getMousePos(o),k,m,l=q.left-p.x,n=Math.abs(l);if(a=="right"){k=p.x;m=0;f.css({left:k,right:m})}else{k=0;m=p.x;f.css({left:k,width:m})}}return false})}},load:function(b){var c=$("#jbolt_layer");if(c&&c.length==1){var a=c.find(".jbolt_layer_portal");if(b){a.ajaxPortal(true,b,true)}else{a.ajaxPortal(true)}}},close:function(){var c=this;var d=$("#jbolt_layer");if(d&&d.length==1){var e=d.data("triggerid");var a=$("#"+e);var h=a.attr("data-confirm");var f=(typeof(h)!="undefined");if(f){var b=a.data("confirm");if(!b){b="确认关闭?"}LayerMsgBox.confirm(b,function(){c.showCloseAnimateAndRemove(a,d)})}else{c.showCloseAnimateAndRemove(a,d)}if(a.hasClass("openByNavTrigger")){a.remove()}}FormDate.hide(d);JBoltInputUtil.hideJBoltInputLayer();JBoltTabUtil.hideJboltContextMenu()},showCloseAnimateAndRemove:function(d,e){var c=d.data("dir");if(!c){c="right"}var a=e.find(".jbolt_layer_portal");var h=e.find(".jbolt_layer_close");var f=e.find(".jbolt_layer_resizebar");var b=d.data("portal-width");if(c=="right"){a.css({right:-b+"px"});h.hide().css({right:-b+"px"});f.hide().css({right:-b+"px",zIndex:0})}else{a.css({left:-jboltWindowWidth+"px"});h.hide().css({left:-jboltWindowWidth+"px"});f.hide().css({left:-jboltWindowWidth+"px",zIndex:0})}e.fadeOut(300,function(){e.remove()})},resize:function(f,e,c,d){e.hide();c.hide().css({zIndex:0});var a=f.data("dir");if(!a){a="right"}var b=jboltWindowWidth-d;if(a=="right"){f.css("width",b);if(isOk(c)){setTimeout(function(){c.css({right:b-5,zIndex:101}).fadeIn(200)},300)}if(isOk(e)){setTimeout(function(){e.css({right:b}).fadeIn(200)},300)}}else{b=d;f.css("width",d);if(isOk(c)){setTimeout(function(){c.css({left:b-5,zIndex:101}).fadeIn(200)},300)}if(isOk(e)){setTimeout(function(){e.css({left:b}).fadeIn(200)},300)}}},showOpenAnimate:function(c){var e=$("#jbolt_layer");if(e&&e.length==1){e.fadeIn(200);var a=e.find(".jbolt_layer_portal");var h=e.find(".jbolt_layer_close");var f=e.find(".jbolt_layer_resizebar");var b=c.data("dir");if(!b){b="right"}if(e.hasClass("nomask")){e.addClass(b)}var d=c.data("portal-width");if(b=="right"){a.css({right:"0px"});if(isOk(f)){setTimeout(function(){f.css({right:d-5,zIndex:101}).fadeIn(200)},300)}if(isOk(h)){setTimeout(function(){h.css({right:d}).fadeIn(200)},300)}}else{a.css({left:"0px",});if(isOk(f)){setTimeout(function(){f.css({left:d-5,zIndex:101}).fadeIn(200)},300)}if(isOk(h)){setTimeout(function(){h.css({left:d}).fadeIn(200)},300)}}}}};function getMousePos(b){var d=b||window.event;var f=document.documentElement.scrollLeft||document.body.scrollLeft;var c=document.documentElement.scrollTop||document.body.scrollTop;var a=d.pageX||d.clientX+f;var h=d.pageY||d.clientY+c;return{"x":a,"y":h}}var jbolt_tabbar=$("#jbolt_tabbar");var jbolt_tabs_container=$("#jbolt_tabs");var jbolt_tabs_array=[];var JBoltTabContextifyOptions={dividerClass:"divider",items:[{header:'<i class="fa fa-th mr-1"></i>可选操作'},{text:'<i class="fa fa-close mr-1"></i>关闭这个',onclick:function(a){JBoltTabUtil.closeJboltTab(a.data.key)}},{text:'<i class="fa fa-refresh mr-1"></i>刷新',onclick:function(a){JBoltTabUtil.showJboltTab(a.data.key,false,refreshPjaxContainer)}},{divider:true},{text:'<i class="fa fa-window-close-o mr-1"></i>关闭其它',onclick:function(a){JBoltTabUtil.closeOtherJboltTab(a.data.key)}},{text:'<i class="fa fa-toggle-left mr-1"></i>关闭左侧',onclick:function(a){JBoltTabUtil.closeAllLeftJboltTab(a.data.key)}},{text:'<i class="fa fa-toggle-right mr-1"></i>关闭右侧',onclick:function(a){JBoltTabUtil.closeAllRightJboltTab(a.data.key)}},{text:'<i class="fa fa-window-close mr-1"></i>关闭所有',onclick:function(a){JBoltTabUtil.closeAllJboltTab()}},]};function pjaxAdminLeftNavWithIframe(a){LayerMsgBox.load(3);mainPjaxContainer.html('<iframe frameborder="0" src="'+a+'" class="jbolt_main_iframe"></iframe>');var b=mainPjaxContainer.find("iframe");
b.on("load",function(){LayerMsgBox.closeLoadNow()}).on("error",function(){LayerMsgBox.closeLoadNow()})}function adminLeftNavshowInDialog(f,b,i){var a="80%",e="80%",d="no";if(i.width){a=i.width}if(i.height){e=i.height}if(i.btn&&i.btn=="true"){d="yes"}if(i.title){var c=$.trim(i.title);if(c&&c.length>0){f=c}}b=actionUrl(b);DialogUtil.openNewDialog({title:f,width:a,height:e,url:b,scroll:"yes",btn:d})}var JBoltTabUtil={init:function(){var a=this;a.createJboltTabContextMenu();a.initAdminLeftNavTabsEvent();a.initTabsEvent();a.initTabsTriggerEvent()},initTabsTriggerEvent:function(){var a=this;jboltBody.on("click","[data-tabtrigger]",function(h){h.preventDefault();h.stopPropagation();var b=$(this);var d=b.attr("href");if(!d){d=b.data("url")}var i=b.attr("target");if(!i){i=b.data("target")}if(d&&d.indexOf("javascript")==-1){if(i&&i=="_self"){currentTabContentRedirectWithAjaxPortal(d)}else{var j=b.data("key");var k=b.data("title");if(!k){k=b.text()}var f=b.data("open-type");if(!f){f=1}var c=a.getCurrentTab();if(c){var l=c.data("key");switch(f){case 1:a.addJboltTab(j,d,k,l);break;case 2:a.addJboltTabWithIFrame(j,d,k,l);break}}else{switch(f){case 1:a.addJboltTab(j,d,k);break;case 2:a.addJboltTabWithIFrame(j,d,k);break}}}}})},initAdminLeftNavTabsEvent:function(){var a=this;jboltBody.on("click",".jbolt_admin_left_navs a:not([target]):not([href='javascript:void(0)'])",function(f){f.preventDefault();f.stopPropagation();var i=$(this);var c=i.attr("href");if(c&&c.indexOf("javascript")==-1){var d=i.data("key");var h=$.trim(i.text().replace("├",""));var b=i.data("open-type");if(!b){b=1}var j=i.data("open-option");switch(b){case 1:a.addJboltTab(d,c,h);break;case 2:a.addJboltTabWithIFrame(d,c,h);break;case 3:activeLeftNavByKey(d);adminLeftNavshowInDialog(h,c,j);break;case 4:activeLeftNavByKey(d);JBoltLayerUtil.openByNav(c,j);break;default:a.addJboltTab(d,c,h);break}}})},initTabsEvent:function(){var a=this;jboltBody.on("click","ul.jbolt_tabs>li",function(c){var b=$(this).data("key");a.showJboltTab(b,true)}).on("click","ul.jbolt_tabs>li>i.close",function(c){c.preventDefault();c.stopPropagation();var b=$(this).parent().data("key");a.closeJboltTab(b)}).on("click","#jbolt_tabbar .jbolt_tab_left",function(b){b.preventDefault();a.jboltTabToLeft()}).on("click","#jbolt_tabbar .jbolt_tab_right",function(b){b.preventDefault();b.stopPropagation();a.jboltTabToRight()}).on("click","#jboltTabContextMenu>a",function(d){d.preventDefault();d.stopPropagation();var c=$(this).data("func");var b=$(this).data("key");switch(c){case"close":JBoltTabUtil.closeJboltTab(b);break;case"closeAll":JBoltTabUtil.closeAllJboltTab();break;case"closeLeft":JBoltTabUtil.closeAllLeftJboltTab(b);break;case"closeRight":JBoltTabUtil.closeAllRightJboltTab(b);break;case"closeOther":JBoltTabUtil.closeOtherJboltTab(b);break;case"refresh":JBoltTabUtil.showJboltTab(b,false,refreshPjaxContainer);break}a.hideJboltContextMenu();return false}).on("dblclick","ul.jbolt_tabs>li",function(d){d.preventDefault();d.stopPropagation();var b=$(this).data("key");a.showJboltTab(b,true);var c=mainPjaxContainer.find(" div#tab_content_"+b);if(c&&c.length==1){LayerMsgBox.confirm("确认刷新此选项卡内容？",function(){c.ajaxPortal(true)})}}).on("contextmenu","ul.jbolt_tabs>li",function(b){b.preventDefault();b.stopPropagation();var c=getMousePos(b);a.showTabContextmenu($(this),c);return false}).on("click","#jboltTabContextMenu",function(b){b.preventDefault();b.stopPropagation();return false}).on("click",function(){a.hideJboltContextMenu()})},createJboltTabContextMenu:function(){var b=$("#jboltTabContextMenu");if(!b||b.length==0){var a='<div id="jboltTabContextMenu" class="dropdown-menu">'+'<span class="dropdown-item-text"><i class="fa fa-th mr-1"></i>可选操作</span>'+'<div class="dropdown-divider"></div>'+'<a class="dropdown-item" data-func="close" href="javascript:void(0)"><i class="fa fa-close mr-1"></i>关闭这个</a>'+'<a class="dropdown-item" data-func="refresh" href="javascript:void(0)"><i class="fa fa-refresh mr-1"></i>刷新</a>'+'<a class="dropdown-item" data-func="closeOther" href="javascript:void(0)"><i class="fa fa-window-close-o mr-1"></i>关闭其它</a>'+'<a class="dropdown-item" data-func="closeLeft" href="javascript:void(0)"><i class="fa fa-toggle-left mr-1"></i>关闭左侧</a>'+'<a class="dropdown-item" data-func="closeRight" href="javascript:void(0)"><i class="fa fa-toggle-right mr-1"></i>关闭右侧</a>'+'<a class="dropdown-item" data-func="closeAll" href="javascript:void(0)"><i class="fa fa-window-close mr-1"></i>关闭所有</a>'+"</div>";jboltBody.append(a)}},hideJboltContextMenu:function(){var a=$("#jboltTabContextMenu");if(a&&a.length==1){a.hide()}},showTabContextmenu:function(a,e){var c=$(a);var b=c.data("key");var d=$("#jboltTabContextMenu");if(!d||d.length==0){this.createJboltTabContextMenu()}d.data("key",b);d.find("a").data("key",b);d.css({top:e.y,left:e.x});d.show()},getCurrentTab:function(){var a=jbolt_tabs_container.find("li.active");if(a&&a.length==1){return a}return null},getCurrentTabContent:function(){var a=mainPjaxContainer.find("div.jbolt_tabcontent.active");
if(a&&a.length==1){return a}return null},isJboltTabExist:function(b){var a=jbolt_tabs_container.find("li[data-key='"+b+"']");return a&&a.length==1},addJboltTabWithoutContentUrl:function(){var k=this;var j=mainPjaxContainer.find(".jbolt_page[data-key]");if(j&&j.length==1){var b=j.data("key");var a=jboltAdminLeftNavs.find("a[href='"+b+"']");if(a&&a.length==1){var m=a.data("key");var o=$.trim(a.text().replace("├",""));k.addJboltTabWithoutContent(m,b,o)}else{var o=j.data("text");if(o){k.addJboltTabWithoutContent(m,b,o)}else{var e=j.data("dontchangeleftnav");if(e){var h=jboltAdminLeftNavs.find("a[href]");if(isOk(h)){var n,f,c,d,i;h.each(function(){n=$(this);f=n.attr("href");c=$.trim(n.text().replace("├",""));if(b.indexOf(f)!=-1){if((!d||!i)||f.length>d){i=c;d=f.length}}});if(!i){var l=j.find(".jbolt_page_title h1");if(isOk(l)){i=l.text()}if(!i){i=" "}}k.addJboltTabWithoutContent(m,b,i)}}else{k.showFirstLeftNavTab()}}}}},addJboltTabWithoutContent:function(b,a,f){var e=this;var c=e.isJboltTabExist(b);if(!c){jbolt_tabs_container.append('<li id="tab_'+b+'" data-key="'+b+'" data-url="'+a+'"><span>'+f+'</span><i class="close">&times;</i></li>');var d=mainPjaxContainer.find("div.jbolt_tabcontent");if(d&&d.length==1){d.data("key",b);d.data("url",a);d.attr("id","tab_content_"+b)}}e.showJboltTab(b)},initTabContextMenuEvent:function(){$("#tab_"+key).tabContextMenu(JBoltTabContextifyOptions)},addJboltTabWithIFrame:function(d,c,i,b){var h=this;var f=h.isJboltTabExist(d);if(f){h.showJboltTab(d,true)}else{LayerMsgBox.load(3);b=b?b:"";jbolt_tabs_container.append('<li id="tab_'+d+'" data-key="'+d+'" data-trigger-tab-key="'+b+'"  data-url="'+c+'"><span>'+i+'</span><i class="close">&times;</i></li>');mainPjaxContainer.append('<div class="jbolt_tabcontent" id="tab_content_'+d+'"   data-key="'+d+'" data-trigger-tab-key="'+b+'" data-url="'+c+'"><iframe frameborder="0" src="'+c+'" class="jbolt_main_iframe"></iframe></div>');h.showJboltTab(d);h.jboltTabToRight();var a="#tab_content_"+d+">iframe";var e=mainPjaxContainer.find(a);e.on("load",function(){LayerMsgBox.closeLoadNow()}).on("error",function(){LayerMsgBox.closeLoadNow()})}},addJboltTab:function(c,b,f,a){var e=this;var d=e.isJboltTabExist(c);if(d){e.showJboltTab(c,true)}else{a=a?a:"";jbolt_tabs_container.append('<li id="tab_'+c+'" data-key="'+c+'" data-trigger-tab-key="'+a+'" data-url="'+b+'"><span>'+f+'</span><i class="close">&times;</i></li>');mainPjaxContainer.append('<div class="jbolt_tabcontent" id="tab_content_'+c+'" data-trigger-tab-key="'+a+'" data-ajaxportal data-key="'+c+'" data-url="'+b+'"></div>');mainPjaxContainer.find("div#tab_content_"+c).ajaxPortal(true);e.showJboltTab(c);e.jboltTabToRight()}},hideAllJboltTab:function(){jbolt_tabs_container.find("li.active").removeClass("active");mainPjaxContainer.find("div.jbolt_tabcontent.active").removeClass("active")},changeUrlByContentPortal:function(){var c=this.getCurrentTab();var b=this.getCurrentTabContent();var a=b.data("url");c.data("url",a)},changeUrl:function(a){var c=this.getCurrentTab();var b=this.getCurrentTabContent();if(c&&c.length==1){a=actionUrl(a);c.data("url",a);b.data("url",a);c.attr("data-url",a);b.attr("data-url",a)}},showJboltTab:function(e,c,h){var f=this;var a=jbolt_tabs_container.find("li#tab_"+e);if(a&&a.length==1){var b=a.hasClass("active");if(!b){f.hideAllJboltTab();a.addClass("active");var d=mainPjaxContainer.find("div#tab_content_"+e);d.addClass("active");activeLeftNavByKey(e);processAutoRefreshTabContent(d)}if(c){f.changeTabLocation()}if(h){h()}}},showFirstLeftNavTab:function(){var c=this;var e=jboltAdminLeftNavs.find("a[data-hasurl]").first();if(e&&e.length==1){var a=e.attr("href");if(a&&a.indexOf("javascript")==-1){var b=e.data("key");var d=e.text().replace("├","");c.addJboltTab(b,a,d)}}},openTabByNav:function(d){var a=d.attr("href");if(a&&a.indexOf("javascript")==-1){var b=d.data("key");var c=d.text().replace("├","");this.addJboltTab(b,a,c)}},getTabCount:function(){var a=jbolt_tabs_container.find("li");if(a&&a.length>0){return a.length}return 0},close:function(a){this.closeJboltTab(a.data("key"))},closeJboltTab:function(b){var d=this;var a=jbolt_tabs_container.find("li#tab_"+b);if(a&&a.length==1){var e=a.hasClass("active");if(e){d.changeToBrotherTab(a)}a.remove();mainPjaxContainer.find("div#tab_content_"+b).remove();var c=d.getTabCount();if(c==0){d.showFirstLeftNavTab()}if(!e){d.changeTabLocation()}}},closeOtherJboltTab:function(b){var c=this;c.showJboltTab(b);var a=jbolt_tabs_container.find("li:not("+"#tab_"+b+")");if(a&&a.length>0){a.each(function(){var d=$(this);var e=d.data("key");d.remove();mainPjaxContainer.find("div#tab_content_"+e).remove()})}},closeAllJboltTab:function(){jbolt_tabs_container.empty();mainPjaxContainer.empty();this.showFirstLeftNavTab()},closeAllLeftJboltTab:function(d){var e=this;var a=jbolt_tabs_container.find("li#tab_"+d);var c=a.prevAll("li");var f=a.hasClass("active");var b=false;if(c&&c.length>0){c.each(function(){var h=$(this);var i=h.data("key");if(h.hasClass("active")){b=true
}h.remove();mainPjaxContainer.find("div#tab_content_"+i).remove()})}if(!f&&b){e.showJboltTab(d)}},closeAllRightJboltTab:function(d){var e=this;var a=jbolt_tabs_container.find("li#tab_"+d);var c=a.nextAll("li");var f=a.hasClass("active");var b=false;if(c&&c.length>0){c.each(function(){var h=$(this);var i=h.data("key");if(h.hasClass("active")){b=true}h.remove();mainPjaxContainer.find("div#tab_content_"+i).remove()})}if(!f&&b){e.showJboltTab(d)}},changeToBrotherTab:function(a){var e=this;var b=a.prev();var d=b&&b.length==1;if(!d){b=a.next();d=b&&b.length==1}if(d){var c=b.data("key");e.showJboltTab(c)}else{e.showFirstLeftNavTab()}},checkCanToLeft:function(){var b=jbolt_tabbar.width();var a=jbolt_tabs_container.outerWidth();if(a>b){var d=Math.abs(parseInt(jbolt_tabs_container.css("margin-left")));var c=Math.abs(parseInt(b-a));if(d<c){return true}}return false},checkCanToRight:function(){var a=Math.abs(parseInt(jbolt_tabs_container.css("margin-left")));return a!=0},jboltTabToLeft:function(){jbolt_tabs_container.css("margin-left","0px")},jboltTabToRight:function(){var f=jbolt_tabbar.width();var d=jbolt_tabs_container.outerWidth();if(d>f){var b=(f/2)-d;var e=null;var a=0;var c=Math.abs(b);jbolt_tabs_container.find("li").each(function(){b=a*-1;a=a+$(this).outerWidth();if(a>=c){return false}});jbolt_tabs_container.css("margin-left",b+"px")}},changeTabLocation:function(){var e=this;var h=jbolt_tabbar.width();var d=jbolt_tabs_container.outerWidth();if(d>h){var b=e.getCurrentTab();var j=Math.abs(parseInt(jbolt_tabs_container.css("margin-left")));var f=0;var c=0;jbolt_tabs_container.find("li").each(function(){var k=$(this);c=c+k.outerWidth();if(k.data("key")==b.data("key")){return false}else{f=f+k.outerWidth()}});if(j==0){if(f<=h){}else{var i=f*-1;jbolt_tabs_container.css("margin-left",i+"px")}}else{if(c<=h){e.jboltTabToLeft()}else{var a=(h/2)-d;var i=f*-1;if(f>Math.abs(parseInt(a))){e.jboltTabToRight()}else{jbolt_tabs_container.css("margin-left",i+"px")}}}}else{e.jboltTabToLeft()}}};(function(a){a.fn.extend({toJsonObject:function(){var c={};var b=this.serializeArray();a.each(b,function(){if(c[this.name]){if(!c[this.name].push){c[this.name]=[c[this.name]]}c[this.name].push(this.value||"")}else{c[this.name]=this.value||""}});return c}})})(jQuery);(function(a){a.fn.extend({toggleContent:function(c){var b=this.html();if(b&&b>0){this.html("")}else{this.html(c)}}})})(jQuery);function randomId(){var a=Math.random();a=a.toString().replace(".","");return new Date().getTime()+a}var SwitchBtnUtil={initBtn:function(b){var c=this;var e=b.attr("src");if(!e){var d=b.data("value");if(!d||d=="null"||d=="undefined"){d=false}else{d=true}var a=b.data("style");if(!a){a="default"}var e="assets/img/switch/"+a+"/"+(d?"on":"off")+".png";b.attr("src",e)}b.off("click").on("click",function(j){j.preventDefault();j.stopPropagation();var i=b.data("doing");if(i){return false}i=true;b.data("doing",true);var h=b.data("url");var f=b.data("confirm");if(h){if(f){LayerMsgBox.confirm(f,function(){c.switchIt(b)},function(){b.data("doing",false)})}else{c.switchIt(b)}}else{c.switchSuccessHandler(b)}})},initBtns:function(d){if(!isOk(d)){return false}var c=this,a=d.length;for(var b=0;b<a;b++){c.initBtn(d.eq(b))}},init:function(d){var c=this;var a=getRealJqueryObject(d);if(!isOk(a)){return false}var b=a.find("img[data-switchbtn]");if(!isOk(b)){return false}c.initBtns(b)},switchIt:function(b){var c=this;var a=b.data("url");LayerMsgBox.loading("正在执行...",10000);a=actionUrl(a);$.ajax({type:"post",url:a,timeout:10000,dataType:"json",success:function(d){if(d.state=="ok"){c.switchSuccessHandler(b,d.data)}else{b.data("doing",false);if(d.msg&&d.msg=="jbolt_system_locked"){showJboltLockSystem()}else{if(d.msg&&d.msg=="jbolt_nologin"){showReloginDialog()}else{LayerMsgBox.alert(d.msg,2)}}}},error:function(){b.data("doing",false);LayerMsgBox.alert("操作失败",2)}})},processJBoltTableFixedColumnSameSwitchBtn:function(j){var c=j.closest("table.jbolt_table");if(!isOk(c)){return false}var e=c.closest(".jbolt_table_view");if(!isOk(e)){return false}var b=j.closest(".jbolt_table_fixed");var f=isOk(b);var a=j.attr("src");var i=j.closest("td");var o=i.index();var m=j.closest("tr");var h=m.index();var n=i.data("col-index");var l;if(f){var d=e.find(".jbolt_table_box>.jbolt_table_body:first>table");if(!isOk(d)){return false}l=d.find("tbody>tr:eq("+h+")>td[data-col-index='"+n+"']")}else{var k=e.find(".jbolt_table_fixed>.jbolt_table_body>table");if(!isOk(k)){return false}l=k.find("tbody>tr:eq("+h+")>td[data-col-index='"+n+"']")}if(isOk(l)){l.find("img[data-switchbtn]").attr("src",a)}},switchSuccessHandler:function(_btn,onOrOff){var src=_btn.attr("src");var handler=_btn.data("handler");var on=src.indexOf("off")!=-1;if(onOrOff==undefined){if(src.indexOf("off")!=-1){src=src.replace("off","on")}else{src=src.replace("on","off")}}else{if(typeof(onOrOff)=="boolean"){if(onOrOff){if(src.indexOf("off")!=-1){src=src.replace("off","on")}}else{if(src.indexOf("on")!=-1){src=src.replace("on","off")}}}else{if(src.indexOf("off")!=-1){src=src.replace("off","on")
}else{src=src.replace("on","off")}}}_btn.attr("src",src);this.processJBoltTableFixedColumnSameSwitchBtn(_btn);LayerMsgBox.closeLoadingNow();if(handler){var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){LayerMsgBox.success("操作成功",300,function(){exe_handler(_btn,on);_btn.data("doing",false)})}else{LayerMsgBox.success("操作成功",300,function(){_btn.data("doing",false)})}}else{LayerMsgBox.success("操作成功",300,function(){_btn.data("doing",false)})}}};var CheckboxUtil={processHiddenInput:function(a,c){var b=this.getCheckedValueToString(a);$("#"+c).val(b)},initCheckBoxEvent:function(ck,name,hiddenInputId,handler){var that=this;if(handler){if(handler=="processHiddenInput"){ck.find("input[type='checkbox'][name='"+name+"']").unbind("change").on("change",function(){that.processHiddenInput(name,hiddenInputId)})}else{var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){ck.find("input[type='checkbox'][name='"+name+"']").unbind("change").on("change",function(){var input=$(this);exe_handler(input,input.is(":checked"))})}}}},initCheckboxs:function(b){if(!isOk(b)){return false}var a=b.length;for(var c=0;c<a;c++){this.initCheckbox(b.eq(c))}},initCheckbox:function(j){var d=this,k=j.data("handler"),a=j.data("name"),i=j.data("value")+"",f=j.data("default")+"",c=j.data("hiddeninput"),b=j.data("url"),h=j.data("label");if(b){d.insertDatas(j,b,a,h,function(){d.initCheckBoxEvent(j,a,c,k);d.setChecked(a,i,f);d.processDisabled(j)})}else{var e=j.find(".checkbox-inline");if(e){d.processCheckboxAlignAndWidth(j)}d.initCheckBoxEvent(j,a,c,k);d.setChecked(a,i,f);d.processDisabled(j)}},processDisabled:function(c){var a=c[0].hasAttribute("data-disabled");if(a){var e=c.data("disabled");if(e==undefined||e==""||e=="undefined"||(typeof(e)=="boolean"&&e==true)){var d=c.data("name");var b=$("input[type='checkbox'][name='"+d+"']");b.attr("disabled","disabled")}}},init:function(c){var b=getRealJqueryObject(c);if(!isOk(b)){return false}var a=b.find("[data-checkbox]");if(!isOk(a)){return false}this.initCheckboxs(a)},insertDatas:function(q,b,c,o,p){var j=this;q.empty();var d=q.data("width");var m="";var l="";if(d){var i=d.split(",");m=i[0];l=i[1]}else{m="100px";l="col"}var h="";if(o){var f=(q.data("rule")&&(!q.data("notnull")));if(m.indexOf("px")!=-1){h='<label class="col-auto col-form-label '+(f?"is_required":"")+'" style="width:'+m+'">'+o+"</label>"}else{h='<label class="'+m+" col-form-label "+(f?"is_required":"")+'">'+o+"</label>"}}var k="";var e=q.data("inline");if(e){k="checkbox-inline"}var a=q.data("text-attr");if(!a){a="text"}var n=q.data("value-attr");if(!n){n="value"}Ajax.get(b,function(v){h+='<div class="'+l+'"  style="padding-top: 1px;">';var u=v.data;var z=c.replace("\\.","_");if(u&&u.length>0){var y,x,w,t;for(var r in u){y=u[r];x=processOptionText(y,a);w=processOptionValue(y,n);t=z+"_"+r;var s='<div class="checkbox checkbox-primary '+k+'">'+'<input  id="'+t+'" type="checkbox" name="'+c+'" value="'+w+'"/>'+'<label for="'+t+'">'+x+"</label>"+"</div>";h+=s}h+="</div>";q.html(h);if(e){j.processCheckboxAlignAndWidth(q)}if(p){p()}}})},processCheckboxAlignAndWidth:function(c){var e=c.data("align-left");if(e){var d=c.find(".checkbox.checkbox-inline");if(isOk(d)){var a=0,b;d.each(function(){b=$(this).outerWidth();if(b>a){a=b}});d.css({"width":a+"px","max-width":a+"px"})}}},checkByArray:function(d,c){c=c.toString();if(c.indexOf(",")!=-1){var a=c.split(",");if(a&&a.length>0){for(var e in a){var b=$("input[type='checkbox'][name='"+d+"'][value='"+a[e]+"']");if(isOk(b)){b.attr("checked","checked")}}}}else{var b=$("input[type='checkbox'][name='"+d+"'][value='"+c+"']");if(isOk(b)){b.attr("checked","checked")}}},setChecked:function(b,d,a){if(d!=undefined&&d!="undefined"&&d!=""){d=d+""}if(a!=undefined&&a!="undefined"&&a!=""){a=a+""}var c=this;if(d){c.checkByArray(b,d)}else{if(a||a==0||a=="0"){c.checkByArray(b,a)}}},checkIt:function(a){$(a).each(function(){if(!this.checked){$(this).prop("checked",true).change()}})},uncheckIt:function(a){$(a).each(function(){if(this.checked){$(this).prop("checked",false).change()}})},checkAll:function(a){jboltBody.find("input[type='checkbox'][name='"+a+"']:not(:checked)").prop("checked",true).change()},uncheckAll:function(a){jboltBody.find("input[type='checkbox'][name='"+a+"']:checked").prop("checked",false).change()},convertCheckAll:function(a){var c=jboltBody.find("input[type='checkbox'][name='"+a+"']:checked");var b=jboltBody.find("input[type='checkbox'][name='"+a+"']:not(:checked)");if(isOk(c)){c.prop("checked",false).change()}if(isOk(b)){b.prop("checked",true).change()}},getCheckedValue:function(b,e){var d=new Array(),a,f;if(e){var c=getRealJqueryObject(e);if(isOk(c)){f=c.find("input[type='checkbox'][name='"+b+"']:checked")}}else{f=jboltBody.find("input[type='checkbox'][name='"+b+"']:checked")}if(isOk(f)){f.each(function(h){d.push($(this).val())})}return d},getCheckedValueToString:function(b,c,f){var e=this,a;var d=e.getCheckedValue(b,f);if(isOk(d)){a=d.join(c?c:",")}return a
},getCheckedTextToString:function(c,d,f){var e=this,a;var b=e.getCheckedText(c,f);if(isOk(b)){a=b.join(d?d:",")}return a},getCheckedText:function(c,e){var a=new Array(),f;if(e){var d=getRealJqueryObject(e);if(isOk(d)){f=d.find("input[type='checkbox'][name='"+c+"']:checked")}}else{f=jboltBody.find("input[type='checkbox'][name='"+c+"']:checked")}if(isOk(f)){var b;f.each(function(h){b=f.eq(h).parent().find("label");if(isOk(b)){a.push(b.text())}})}return a}};var HtmlEditorUtil={ing:false,initEditors:function(h){if(!isOk(h)){return false}var c=this,e=h.length;if(e>0){var l=new Array();var a=new Array();var j,d;for(var b=0;b<e;b++){d=h.eq(b);j=d.data("editor");if(j=="summernote"){a.push(d)}else{if(j=="neditor"){l.push(d)}}}var f=l.length;var k=a.length;if(f>0){loadJBoltPlugin(["neditor"],function(){for(var m=0;m<f;m++){c.initEditor(l[m])}})}if(k>0){loadJBoltPlugin(["summernote"],function(){for(var m=0;m<k;m++){c.initEditor(a[m])}})}}},init:function(c){var a=getRealJqueryObject(c);if(!isOk(a)){return false}var b=jboltBody.find("[data-editor]");if(!isOk(b)){return false}this.ing=false;this.initEditors(b)},initNEditor:function(h){var i=this;var c=h.attr("id");if(!c){alert("请设置编辑器的id属性");return false}var b=h.data("imgmaxsize");if(!b){b=200}b=b*1024;var d=h.data("videomaxsize");if(!d){d=10}d=d*1024*1024*1024;var n={imageMaxSize:b,videoMaxSize:d,wordCount:false,elementPathEnabled:false,toolbars:[["source","undo","redo","bold","italic","underline","strikethrough","fontborder","indent","superscript","subscript","justifyleft","justifyright","justifycenter","justifyjustify","forecolor","backcolor","removeformat","formatmatch","autotypeset","touppercase","tolowercase","fontfamily","fontsize","paragraph","customstyle","searchreplace","blockquote","pasteplain","selectall","cleardoc","link","unlink","emotion","spechars","insertorderedlist","insertunorderedlist","horizontal","date","time","insertimage","wordimage","imagenone","imageleft","imageright","imagecenter","lineheight","map","insertvideo","insertcode","inserttable","edittable","edittd","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","deletecaption","inserttitle","mergecells","deletetable","insertparagraphbeforetable","directionalityltr","directionalityrtl","rowspacingtop","rowspacingbottom","background","template","scrawl","drafts","print","preview","help","fullscreen",]],allowDivTransToP:false};var a=h.data("width");var l=h.data("height");if(!a){a="100%"}if(!l){l=300}n["initialFrameWidth"]=a;n["initialFrameHeight"]=l;var e=h.data("urlprefix");if(!e){e=h.data("imghost")}if(e){n["imageUrlPrefix"]=e;n["scrawlUrlPrefix"]=e;n["videoUrlPrefix"]=e;n["fileUrlPrefix"]=e}else{var m=h.data("imageurlprefix");if(m){n["imageUrlPrefix"]=imageurlprefix}var f=h.data("scrawlurlprefix");if(f){n["scrawlUrlPrefix"]=f}var j=h.data("videourlprefix");if(j){n["videoUrlPrefix"]=j}var k=h.data("fileurlprefix");if(k){n["fileUrlPrefix"]=k}}i.processInitNEditor(h,n)},processInitNEditor:function(f,a){var c=this;var b=f.attr("id");if(!b){alert("请设置编辑器的id属性");return false}var e=f.data("hiddeninput");UE.delEditor(b);var d=UE.getEditor(b,a);d.addListener("contentChange",function(){if(e){var i=$("#"+b).closest(".jbolt_page").find("#"+e);if(i&&i.length>0){var h=d.getContent();i.val(h)}}})},initSummernoteEditor:function(h){var f=this;var e=h.attr("id");if(!e){alert("请设置编辑器的id属性");return false}var d=h.data("width");var a=h.data("height");var c=h.data("maxsize");if(!c){c=200}var i=h.data("placeholder");var b={lang:"zh-CN",dialogsInBody:true,toolbar:[["style",["style"]],["font",["bold","italic","underline","clear","strikethrough","superscript","subscript"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph","height"]],["insert",["hr","table","link","picture","video"]],["misc",["fullscreen","codeview","undo","redo","help"]]],callbacks:{onImageUpload:function(n,m,k){if(f.ing){alert("有文件正在上传，请稍后~~")}else{f.ing=true;var j=n.length;for(var l=0;l<j;l++){if(n[l].size/1024>c){f.ing=false;LayerMsgBox.alert("图片文件不能大于"+c+"k",2);return false}f.sendSummernoteFile(h,n[l])}f.ing=false}},onChange:function(k,j){var m=h.data("hiddeninput");if(m){var l=$("#"+m);if(l&&l.length>0){l.val(k)}}},onPaste:function(j){if(f.ing){alert("有文件正在上传，请稍后~~")}else{f.parseIamge(j,h)}}}};if(i){b.placeholder=i}if(d){b.width=d+"px"}if(!a){a=300}b.height=a+"px";h.summernote(b)},initEditor:function(d){var c=this;var b=d.attr("id");if(!b){alert("请设置编辑器的id属性");return false}var a=d.data("editor");if(a=="summernote"){c.initSummernoteEditor(d)}else{if(a=="neditor"){c.initNEditor(d)}else{LayerMsgBox.alert("data-editor类型错误",2)}}},parseIamge:function(k,f){var j=this;j.ing=true;var a=f.data("maxsize");if(!a){a=200}var d=k.originalEvent;var h=d.clipboardData.files;if(!h||h.length==0){j.ing=false;return false}d.stopPropagation();d.preventDefault();for(var c in h){var b=h[c];if(j.ing==false||!(b.type.match(/^image/))){return false}if(b.size/1024>a){j.ing=false;LayerMsgBox.alert("剪贴板中图片文件不能大于"+a+"k",2);
return false}j.sendSummernoteFile(f,b)}},sendSummernoteFile:function(e,d){var f=this;f.ing=true;var b=e.data("imguploadurl");if(!b){b=summernote_img_uploadurl}else{b=actionUrl(b)}var a=e.data("fileinputname");if(!a){a="file"}var h=e.data("imghost");var c=new FormData();c.append(a,d);$.ajax({type:"post",url:b,data:c,timeout:60000,cache:false,async:true,processData:false,contentType:false,success:function(i){if(i.state=="ok"){if(i.data){if(i.data.indexOf("http://")!=-1||i.data.indexOf("https://")!=-1||i.data.indexOf("://")!=-1){e.summernote("insertImage",i.data)}else{var j=actionUrl(i.data);if(h){if(h.charAt(h.length-1)!="/"){h=h+"/"}j=h+j}e.summernote("insertImage",j)}LayerMsgBox.success("上传成功",1000)}else{LayerMsgBox.success("上传异常",1000)}}else{LayerMsgBox.error(i.msg,1000)}f.ing=false},error:function(i){f.ing=false;LayerMsgBox.error("网络异常",1000)}})}};var RadioUtil={initRadioEvent:function(r,name,handler){if(handler){var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){r.find("input[type='radio'][name='"+name+"']").unbind("click").on("click",function(e){var r=$(this);var val=r.val();exe_handler(r,val)})}}},initRadios:function(c){if(!isOk(c)){return false}var a=c.length;for(var b=0;b<a;b++){this.initRadio(c.eq(b))}},initRadio:function(a){var d=this,i=a.data("value")+"",f=a.data("default")+"",b=a.data("name"),j=a.data("handler"),c=a.data("url"),h=a.data("label");if(c){d.insertDatas(a,c,b,h,function(){d.initRadioEvent(a,b,j);d.setChecked(b,i,f);d.processDisabled(a)})}else{var e=a.find(".radio-inline");if(e){d.processRadioAlignAndWidth(a)}d.initRadioEvent(a,b,j);d.setChecked(b,i,f);d.processDisabled(a)}},processDisabled:function(e){var a=e[0].hasAttribute("data-disabled");if(a){var d=e.data("disabled");if(d==undefined||d==""||d=="undefined"||(typeof(d)=="boolean"&&d==true)){var c=e.data("name");var b=$("input[type='radio'][name='"+c+"']");b.attr("disabled","disabled")}}},init:function(b){var a=getRealJqueryObject(b);if(!isOk(a)){return false}var c=a.find("[data-radio]");if(!isOk(c)){return false}this.initRadios(c)},insertDatas:function(a,c,d,o,p){var j=this;a.empty();var e=a.data("width");var m="";var l="";if(e){var i=e.split(",");m=i[0];l=i[1]}else{m="100px";l="col"}var h="";if(o){if(m.indexOf("px")!=-1){h='<label class="col-auto col-form-label" style="width:'+m+'">'+o+"</label>"}else{h='<label class="'+m+' col-form-label">'+o+"</label>"}}var k="";var f=a.data("inline");if(f){k="radio-inline"}var b=a.data("text-attr");if(!b){b="text"}var n=a.data("value-attr");if(!n){n="value"}Ajax.get(c,function(u){h+='<div class="'+l+'"  style="padding-top: 1px;">';var t=u.data;var y=d.replace("\\.","_");if(t&&t.length>0){var x,w,v,q;for(var r in t){x=t[r];w=processOptionText(x,b);v=processOptionValue(x,n);q=y+"_"+r;var s='<div class="radio radio-primary '+k+'">'+'<input  id="'+q+'" type="radio" name="'+d+'" value="'+v+'"/>'+'<label for="'+q+'">'+w+"</label>"+"</div>";h+=s}h+="</div>";a.html(h);if(f){j.processRadioAlignAndWidth(a)}if(p){p()}}})},processRadioAlignAndWidth:function(e){var d=e.data("align-left");if(d){var c=e.find(".radio.radio-inline");if(isOk(c)){var a=0,b;c.each(function(){b=$(this).outerWidth();if(b>a){a=b}});c.css({"width":a+"px","max-width":a+"px"})}}},setChecked:function(b,c,a){if(c!=undefined&&c!="undefined"&&c!=""){c=c+""}if(a!=undefined&&a!="undefined"&&a!=""){a=a+""}if(c){jboltBody.find("input[type='radio'][name='"+b+"'][value='"+c+"']").click()}else{if(a){if(a=="all"){jboltBody.find("input[type='radio'][name='"+b+"'][data-all]").click()}else{if(a=="options_first"){jboltBody.find("input[type='radio'][name='"+b+"']:first").click()}else{if(a=="options_last"){jboltBody.find("input[type='radio'][name='"+b+"']:last").click()}else{jboltBody.find("input[type='radio'][name='"+b+"'][value='"+a+"']").click()}}}}}},getCheckedRadio:function(b,d){var a,e;if(d){var c=getRealJqueryObject(d);if(isOk(c)){a=c.find("input[type='radio'][name='"+b+"']:checked")}}else{a=jboltBody.find("input[type='radio'][name='"+b+"']:checked")}return a},getCheckedValue:function(b,d){var c=this,e;var a=c.getCheckedRadio(b,d);if(isOk(a)){e=a.val()}return e},getCheckedText:function(d,f){var e=this,b;var a=e.getCheckedRadio(d,f);if(isOk(a)){var c=a.parent().find("label");if(isOk(c)){b=c.text()}}return b}};var LayerTipsUtil={initTip:function(c){var a=c.data("trigger");if(a&&a=="click"){var b=0;c.off("click").on("click",function(f){f.stopPropagation();f.preventDefault();var d=$(this).data("content");b=layer.tips(d,this,{tips:[4,"#3595CC"],time:30000});$("#layui-layer"+b).on("click",function(h){h.stopPropagation();h.preventDefault()});jboltBody.on("click",function(){layer.close(b)})})}else{var b=0;c.off("mouseenter").on("mouseenter",function(){var d=$(this).data("content");b=layer.tips(d,this,{tips:[4,"#3595CC"],time:30000})}).off("mouseleave").on("mouseleave",function(){layer.close(b)})}},initTips:function(b){if(!isOk(b)){return false}var d=this;var a=b.length;for(var c=0;c<a;c++){d.initTip(b.eq(c))}},init:function(c){var b=getRealJqueryObject(c);
if(!isOk(b)){return false}var a=b.find("[data-tipsbtn]");if(!isOk(a)){return false}this.initTips(a)}};var LayerPhotoUtil={init:function(){var a=this;jboltBody.on("click","[data-photobtn]",function(j){j.preventDefault();j.stopPropagation();var h=$(this);var d=null;var i=h.data("target");if(this.tagName.toLowerCase()=="a"){d=h.attr("href")}else{if(this.tagName.toLowerCase()=="img"){d=h.attr("src")}}if(!d){d=h.data("url")}if(d){var b=null;var c=h.data("ablum");if(c){b=a.getablum(c,d);if(!b){b=[{"src":d,}]}}else{b=[{"src":d,}]}var f={photos:{"title":"JBolt图片查看器","start":0,"data":b},anim:5};if(i&&i=="parent"){parent.layer.photos(f)}else{layer.photos(f)}}else{alert("页面存在未设置图片地址的 photobtn")}})},getablum:function(b,d){var c=jboltBody.find("[data-photobtn][data-ablum='"+b+"']");if(!isOk(c)){return null}var a=new Array();a.push({src:d});c.each(function(){var f=$(this);var e=null;if(this.tagName.toLowerCase()=="a"){e=f.attr("href")}else{if(this.tagName.toLowerCase()=="img"){e=f.attr("src")}}if(!e){e=f.data("url")}if(e!=d){a.push({src:e})}});return a}};(function(a){a.extend(a.fn,{ajaxPortal:function(c,b,d,e){return this.each(function(){var f=a(this);var h="";if(b){h=b}else{h=f.data("url")}if(h.indexOf("?")!=-1){h=h+"&t="+new Date().getTime()}else{h=h+"?t="+new Date().getTime()}var i=f.data("autoload");if(i==undefined){i=true}if((c==undefined&&i)||(c!=undefined)){if(c){f.html("<div class='m-2 p-2 text-center ajaxPortalLoading'><div class='spinner-grow text-secondary' style='width: 3rem; height: 3rem;' role='status'><span class='sr-only'>Loading...</span></div></div>")}else{f.append("<div class='m-2 p-2 text-center ajaxPortalLoading'><div class='spinner-grow text-secondary' style='width: 3rem; height: 3rem;' role='status'><span class='sr-only'>Loading...</span></div></div>")}h=actionUrl(h);a.ajax({type:"GET",url:h,beforeSend:function(j){j.setRequestHeader("AJAX-PORTAL","true")},dataType:"html",success:function(k){if(c){f.empty().html(k)}else{f.find(".ajaxPortalLoading").remove();f.append(k)}if(d&&b){f.data("url",b)}var j=f.attr("id");if(!j){j=randomId();f.attr("id",j)}afterAjaxPortal(f);if(e){e()}},error:function(){if(c){f.empty().html('<div class="jbolt_page"><div class="jbolt_page_content"><div style="margin: 20px auto;max-width: 500px"><div class="alert alert-danger">404,您访问的资源不存在!</div></div></div></div>')}else{f.find(".ajaxPortalLoading").remove();f.append('<div class="jbolt_page"><div class="jbolt_page_content"><div style="margin: 20px auto;max-width: 500px"><div class="alert alert-danger">404,您访问的资源不存在!</div></div></div></div>')}}})}})}})})(jQuery);function afterAjaxPortal(a){portalLoadRequirePluginAndInit(a);$(".tooltip.show").remove();SelectUtil.initAutoSetValue(a);JAtomFileUploadUtil.init(a);JAtomImgUploader.init(a);SwitchBtnUtil.init(a);FormDate.init(a);LayerTipsUtil.init(a);HtmlEditorUtil.init(a);ImageViewerUtil.init(a);RadioUtil.init(a);CheckboxUtil.init(a);AutocompleteUtil.init(a);Select2Util.init(a);SelectUtil.init({parent:a});MasterSlaveUtil.init(a);MultipleFileInputUtil.init(a);initAjaxPortal(a);JSTreeUtil.init(a);JBoltInputUtil.init(a);initToolTip(a);initPopover(a);JBoltTableUtil.init(a);JBoltTreeTableUtil.init(a);LayerMsgBox.closeLoadNow();processAutoRefreshTabContent(a);findRequiredAndStarIt(a)}function processAutoRefreshTabContent(a){var c=isWithtabs();if(!c){return false}if(!(a.hasClass("jbolt_tabcontent")&&a.hasClass("active"))){return false}var d=a.find(".jbolt_page");if(!isOk(d)){return false}var b=d.data("auto-refresh");if(b){b=b*1000;setTimeout(function(){a.ajaxPortal(true)},b)}}function validateFileMaxSize(d,e){var b=(d.files[0].size/1024).toFixed(1);var c=(b>e);var a=b+"KB";if(b>1024){a=((b/1024).toFixed(1))+"M"}if(c){LayerMsgBox.alert("您选择的文件["+a+"],上传限制不能超过 "+e+"KB",2)}return c}function validateExcel(a,c){var b=a.value;if(!/.(xls|xlsx)$/.test(b.toLowerCase())){LayerMsgBox.alert("文件类型必须是xls,xlsx中的一种",2);return false}if(validateFileMaxSize(a,c)){return false}return true}function validateNormal(a,c){var b=a.value;if(!/.(txt|xls|xlsx|jpg|jpeg|png|gif|bmp|rar|zip|pdf|mp4|wmv|flv|rmvb|mpg|mkv|mov|mp3|wav|ogg|midi|mac|acc|doc|docx|ppt|pptx|ppts)$/.test(b.toLowerCase())){LayerMsgBox.alert("此文件类型不允许上传",2);return false}if(validateFileMaxSize(a,c)){return false}return true}function validateAudio(a,c){var b=a.value;if(!/.(mp3|wav|ogg|midi|mac|acc)$/.test(b.toLowerCase())){LayerMsgBox.alert("此文件类型不允许上传，只允许mp3|wav|ogg|midi|mac|acc",2);return false}if(validateFileMaxSize(a,c)){return false}return true}function validateVideo(a,c){var b=a.value;if(!/.(mp4|wmv|flv|rmvb|mpg|mkv|mov)$/.test(b.toLowerCase())){LayerMsgBox.alert("此文件类型不允许上传,只允许mp4|wmv|flv|rmvb|mpg|mkv|mov",2);return false}if(validateFileMaxSize(a,c)){return false}return true}function validateSelfFileAccept(file,maxSize,accept){var fileName=file.value;var tt=eval("/.("+accept+")$/");if(!tt.test(fileName.toLowerCase())){LayerMsgBox.alert("此文件类型不允许上传,只允许"+accept,2);return false}if(validateFileMaxSize(file,maxSize)){return false}return true}function isImg(a){return(/.(jpg|jpeg|png|gif|bmp|webp)$/.test(a.toLowerCase()))
}function validateImg(a,c){var b=a.value;if(isImg(b)==false){LayerMsgBox.alert("图片类型必须是jpg|jpeg|png|gif|bmp|webp中的一种",2);return false}if(validateFileMaxSize(a,c)){return false}return true}function getRealAccept(b){var a;switch(b){case"img":a="image/*";break;case"excel":a="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel";break;case"word":a="application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document";break;case"ppt":a="application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/vnd.openxmlformats-officedocument.presentationml.slideshow";break;case"video":a="video/*";break;case"audio":a="audio/*";break;case"pdf":a="application/pdf";break;case"mp4":a="video/mp4";break;default:a=b;break}return a}function validateFile(b,a,e){var d=b[0];if(!e){e=1024*1024*1024*2}var c=true;if(a){switch(a){case"img":c=validateImg(d,e);break;case"excel":c=validateExcel(d,e);break;case"file":c=validateNormal(d,e);break;case"video":c=validateVideo(d,e);break;case"audio":c=validateAudio(d,e);break;default:c=validateSelfFileAccept(d,e,a);break}}else{c=validateNormal(d,e)}return c}function getObjectURL(c){var b=c.files[0];var a=null;if(window.createObjectURL!=undefined){a=window.createObjectURL(b)}else{if(window.URL!=undefined){a=window.URL.createObjectURL(b)}else{if(window.webkitURL!=undefined){a=window.webkitURL.createObjectURL(b)}}}return a}var JAtomImgUploader={tpl:'<input type="file"   {@if rule}data-rule="${rule}"{@/if}  {@if tips}data-tips="${tips}"{@/if} ><p class="j_img_uploder_msg"><span class="j_file_name"></span><i class="fa fa-remove j_text_danger j_remove_file"></i></p>',init:function(f){var e=this;var d=getRealJqueryObject(f);if(!isOk(d)){return false}var b=d.find(".j_img_uploder");if(!isOk(b)){return false}var a=b.length;for(var c=0;c<a;c++){JAtomImgUploader.initSingle(b.eq(c))}},initSingle:function(f){var e=this;var i=f.data("rule");var b=f.data("tips");var d=f.data("area");if(d){var a=d.split(",");f.css({"width":a[0],"height":a[1]})}f.html(juicer(e.tpl,{rule:i,tips:b}));var h=f.data("value");if(h&&h!="assets/img/uploadimg.png"){var c="#999 url("+h+") center center no-repeat";f.css({"background":c,"background-size":"100%"});f.find("p.j_img_uploder_msg").show()}f.find("input[type='file']").on("change",function(l){var j=$(this);var k=l.target.files;e.changeFile(j)});f.find(".j_remove_file").on("click",function(){var j=$(this);e.removeFile(j)})},removeFile:function(removeBtn){var uploder=removeBtn.closest(".j_img_uploder");var removehandler=uploder.data("removehandler");uploder.find("input[type='file']").val("");uploder.find("span.j_file_name").text("");uploder.find("p.j_img_uploder_msg").hide();uploder.css({"background":"url('assets/img/uploadimg.png') center center no-repeat","background-size":"80%"});var hiddeninput=uploder.data("hiddeninput");if(hiddeninput){$("#"+hiddeninput).val("")}if(removehandler){var exe=eval(removehandler);if(exe){exe(uploder)}}},changeFile:function(file){var uploder=file.closest(".j_img_uploder");var maxSize=uploder.data("maxsize");var fileValue=file.val();var hiddeninput=uploder.data("hiddeninput");var handler=uploder.data("handler");if(hiddeninput&&handler&&handler!="uploadMultipleFile"){$("#"+hiddeninput).val("")}if(fileValue){if(validateFile(file,"img",maxSize)){var arr=fileValue.split("\\");var fileName=arr[arr.length-1];if(handler&&handler!="uploadMultipleFile"){uploder.find("span.j_file_name").text(fileName).attr("title",fileName);uploder.find("p.j_img_uploder_msg").show();var fileData=getObjectURL(file[0]);if(fileData){uploder.css({"background":"#999 url('"+fileData+"') center center no-repeat","background-size":"100%"})}}uploder.closest(".form-group").removeClass("has-error")}else{file.val("");uploder.find("span.j_file_name").text("");uploder.find("p.j_img_uploder_msg").hide();uploder.css({"background":"url('assets/img/uploadimg.png') center center no-repeat","background-size":"80%"});return false}}else{uploder.find("input[type='file']").val("");uploder.find("span.j_file_name").text("");uploder.find("p.j_img_uploder_msg").hide();uploder.css({"background":"url('assets/img/uploadimg.png') center center no-repeat","background-size":"80%"})}if(handler){var isMultiple=(handler=="uploadMultipleFile");if(handler=="uploadFile"||isMultiple){var url=uploder.data("url");if(!url){LayerMsgBox.alert("未设置文件上传地址 data-url",2)}else{LayerMsgBox.loading("处理中",1000);var hiddeninput=uploder.data("hiddeninput");var imgbox=uploder.data("imgbox");var limit=uploder.data("limit");var imgs=$("#"+imgbox+" img");if(imgs&&imgs.length>=limit){LayerMsgBox.alert("最多上传["+limit+"]张",5);uploder.find("input[type='file']").val("");uploder.find("span.j_file_name").text("");uploder.find("p.j_img_uploder_msg").hide();uploder.css({"background":"url('assets/img/uploadimg.png') center center no-repeat","background-size":"80%"});return false}var fileName=uploder.data("filename");if(!fileName){fileName="file"
}uploadFile("img",url,fileName,file[0].files[0],hiddeninput,null,null,isMultiple,imgbox,function(){if(isMultiple){uploder.find("input[type='file']").val("")}})}}else{var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler(file.val(),file)}}}}};function processImagesHiddenInputValue(h,f){var a=$("#"+h);var b=$("#"+f);var e="";var i=a.find("img");var c=i.length;var d=c-1;if(c>0){i.each(function(k,l){var j=$(this);e=e+j.attr("src");if(k<d){e=e+","}})}b.val(e)}function removeUploadImgBoxLi(d){var b=$(d);var a=b.closest("li");var c=a.data("hiddeninput");var e=a.data("imgbox");a.remove();processImagesHiddenInputValue(e,c)}function imgGotoLeft(c){var f=$(c);var a=f.closest("li");var d=a.prev();if(d){var b=a.clone();d.before(b);var e=a.data("hiddeninput");var h=a.data("imgbox");a.remove();processImagesHiddenInputValue(h,e)}else{layer.msg("已经是第一个",{time:1000})}}function imgGotoRight(c){var f=$(c);var a=f.closest("li");var d=a.next();if(d){var b=a.clone();d.after(b);var e=a.data("hiddeninput");var h=a.data("imgbox");a.remove();processImagesHiddenInputValue(h,e)}else{layer.msg("已经是最后一个",{time:1000})}}function uploadFile(type,url,name,file,hiddeninput,filenameInput,sizeinput,isMultiple,imgbox,callback){LayerMsgBox.loading("上传中",10000);var fileSize=parseInt((file.size/1024).toFixed(0));var fd=new FormData();fd.append(name,file);url=actionUrl(url);$.ajax({type:"POST",url:url,data:fd,timeout:60000,cache:false,async:true,processData:false,contentType:false,success:function(res){if(res.state=="ok"){if(sizeinput){$("#"+sizeinput).val(fileSize)}if((type=="img")&&hiddeninput&&res.data){var datas=res.data;var hinput=$("#"+hiddeninput);var hvalue=$.trim(hinput.val());if(isMultiple&&imgbox){$("#"+imgbox).append("<li data-imgbox='"+imgbox+"' data-hiddeninput='"+hiddeninput+"'><img src='"+datas+"'/><div class='optbox' ><i title='删除' onclick='removeUploadImgBoxLi(this)' class='fa fa-trash'></i><i onclick='imgGotoLeft(this)' class='fa fa-arrow-left' title='左移'></i><i title='右移' onclick='imgGotoRight(this)' class='fa fa-arrow-right'></i></div></li>");if(!hvalue){hvalue=datas}else{hvalue=hvalue+","+datas}}else{hvalue=datas}hinput.val(hvalue)}else{if((type=="file")&&hiddeninput&&res.data){$("#"+hiddeninput).val(res.data.fileUrl);if(filenameInput){$("#"+filenameInput).val(res.data.fileName)}}}if(callback){var exe_callback=eval(callback);if(exe_callback&&typeof(exe_callback)=="function"){exe_callback(type,file)}}LayerMsgBox.success("上传成功",1000)}else{LayerMsgBox.alert(res.msg,2)}},error:function(err){LayerMsgBox.error("网络异常",1000)}})}function getBase64Image(b){var c=document.createElement("canvas");c.width=b.width;c.height=b.height;var a=c.getContext("2d");a.drawImage(b,0,0,b.width,b.height);var d=c.toDataURL("image/png");return d}function dataURItoBlob(b){var f=atob(b.split(",")[1]);var a=b.split(",")[0].split(":")[1].split(";")[0];var e=new ArrayBuffer(f.length);var c=new Uint8Array(e);for(var d=0;d<f.length;d++){c[d]=f.charCodeAt(d)}return new Blob([e],{type:a})}var JAtomFileUploadUtil={tpl:'<button class="j_upload_file ${btnClass}" style="{@if width}width:${width}px;{@/if}{@if height}height:${height}px;{@/if}{@if fontSize}font-size:${fontSize}px;{@/if}"><div class="placeholder"><i class="fa fa-upload mr-2"></i>${placeholder}</div><input type="file" {@if accept}accept="${accept}"{@/if} {@if rule}data-rule="${rule}"{@/if} {@if tips}data-tips="${tips}"{@/if}  /></button><br/><p class="j_upload_file_box_msg"><span class="j_file_name"></span><i class="fa fa-remove text-danger j_remove_file"></i></p>',initFileBoxUI:function(b){if(!isOk(b)){return false}var h=b.length;var f,j,c,k,d,a;for(var e=0;e<h;e++){j="选择文件";a="";c=0;k="100%";f=b.eq(e);d=f.data("accept");if(d){a=getRealAccept(d)}c=f.data("width")||c;k=f.data("height")||k;j=f.data("placeholder")||j;f.html(juicer(this.tpl,{rule:f.data("rule"),tips:f.data("tips"),width:c,height:k,placeholder:j,fontSize:f.data("font-size"),accept:a,btnClass:(f.data("btn-class")||"btn btn-outline-primary")}))}},oneFileBoxProcess:function(box,file){var that=this;var fileValue=file.val();var arr=fileValue.split("\\");var fileName=arr[arr.length-1];box.find("span.j_file_name").text(fileName);box.find("p.j_upload_file_box_msg").addClass("show");box.find(".j_upload_file").addClass("j_reupload");box.closest(".form-group").removeClass("has-error");var imgpreview=box.data("imgpreview");if(imgpreview){if(isImg(fileName)){var imgpreviewBox=$(imgpreview);if(imgpreviewBox&&imgpreviewBox.length){var url=getObjectURL(file[0]);if(url){imgpreviewBox.html("<img src='"+url+"'/>")}}}}var handler=box.data("handler");if(handler){if(handler=="uploadFile"){var url=box.data("url");if(!url){LayerMsgBox.alert("未设置文件上传地址 data-url",2)}else{var hiddeninput=box.data("hiddeninput");var sizeinput=box.data("sizeinput");var fileNameInput=box.data("filenameinput");var fileName=box.data("filename");if(!fileName){fileName="file"}var ucallback=box.data("upload-success-handler")||box.data("upload-success-callback");
uploadFile("file",url,fileName,file[0].files[0],hiddeninput,fileNameInput,sizeinput,null,null,ucallback)}}else{var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler(fileValue,file)}}}},initFileBoxEvent:function(b){if(!isOk(b)){return false}var a=this;b.find("input[type='file']").on("change",function(){var e=$(this);var f=e.closest(".j_upload_file_box");var d=f.data("accept");var i=f.data("maxsize");var c=e.val();if(c){if(validateFile(e,d,i)){var h=f.data("confirm");if(h){LayerMsgBox.confirm(h,function(){a.oneFileBoxProcess(f,e)},function(){a.clearIt(f)})}else{a.oneFileBoxProcess(f,e)}}else{a.clearIt(f);return false}}else{a.clearIt(f)}});b.find(".j_remove_file").on("click",function(){var d=$(this);var c=d.closest(".j_upload_file_box");a.clearIt(c)})},init:function(c){var b=this;var a=getRealJqueryObject(c);if(!isOk(a)){return false}var d=a.find(".j_upload_file_box");if(isOk(d)){b.initFileBoxUI(d);b.initFileBoxEvent(d)}},clearIt:function(b){b.find("input[type='file']").val("");b.find("span.j_file_name").text("");b.find("p.j_upload_file_box_msg").removeClass("show");b.find(".j_upload_file").removeClass("j_reupload");var a=b.data("imgpreview");if(a){$(a).empty()}}};var LayerMsgBox={alert:function(c,b,a){if(b){layer.alert(c,{icon:b},function(d){if(a){a()}layer.close(d)})}else{layer.alert(c,function(d){if(a){a()}layer.close(d)})}},confirm:function(c,a,b){layer.confirm(c,{icon:3,title:"请选择"},function(d){if(a){a()}layer.close(d)},function(d){if(b){b()}layer.close(d)})},success:function(d,c,b){if(!d){d="操作成功"}if(!c){c=1000}var a=layer.msg(d,{time:c,icon:1},function(){if(b){b()}});return a},error:function(d,c,b){if(!d){d="错误"}if(!c){c=1500}var a=layer.msg(d,{time:c,icon:2},function(){if(b){b()}});return a},prompt:function(d,e,c,b){if(b==undefined){b=2}var a=layer.prompt({title:d,value:(e?e:""),formType:b},function(h,f){if(c){c(f,h)}});return a},loading:function(d,c,b){if(!d){d="执行中..."}var a=null;c=(c?c:10000);if(c){a=layer.msg(d,{time:c,icon:16,shade:0.3},function(){if(b){b()}})}else{a=layer.msg(d,{icon:16})}return a},close:function(a){layer.close(a)},closeAll:function(a){if(a){layer.closeAll(a)}else{layer.closeAll()}},closeLoading:function(){setTimeout(function(){layer.closeAll("dialog")},500)},closeLoadingNow:function(){layer.closeAll("dialog")},load:function(b,c){var a=null;if(c){a=layer.load(b,{time:c})}else{a=layer.load(b)}return a},closeLoad:function(){setTimeout(function(){layer.closeAll("loading")},200)},closeLoadNow:function(){layer.closeAll("loading")}};var jboltAjaxTimeout=60000;var Ajax={uploadBase64File:function(d,b,h,f,c,e){var a=dataURItoBlob(b);this.uploadBlob(d,a,h,f,c,e)},uploadBlob:function(c,a,h,f,b,d){var e=new FormData();e.append("file",a,h);this.uploadFormData(c,e,f,b,d)},uploadFormData:function(b,e,f,a,d){var c=true;if(d){c=false}b=actionUrl(b);$.ajax({url:b,type:"post",processData:false,contentType:false,timeout:jboltAjaxTimeout,async:c,data:e,success:function(h){if(h.state=="ok"){if(f){f(h)}}else{if(h.msg&&h.msg=="jbolt_system_locked"){showJboltLockSystem()}else{if(h.msg&&h.msg=="jbolt_nologin"){showReloginDialog()}else{LayerMsgBox.alert(h.msg,2);if(a){a()}}}}},error:function(){LayerMsgBox.alert("网络通讯异常",2);if(a){a()}}});jboltAjaxTimeout=60000},post:function(b,e,f,a,d){var c=true;if(d){c=false}b=actionUrl(b);$.ajax({url:b,type:"post",dataType:"json",timeout:jboltAjaxTimeout,async:c,data:e,success:function(h){if(h.state=="ok"){if(f){f(h)}}else{if(h.msg&&h.msg=="jbolt_system_locked"){showJboltLockSystem()}else{if(h.msg&&h.msg=="jbolt_nologin"){showReloginDialog()}else{LayerMsgBox.alert(h.msg,2);if(a){a()}}}}},error:function(){LayerMsgBox.alert("网络通讯异常",2);if(a){a()}}});jboltAjaxTimeout=60000},getWithForm:function(a,c,h,b,f){var e=getRealJqueryObject(a);if(!isOk(e)){LayerMsgBox.alert("请指定正确的formEle参数",2);return false}var d=e.serialize();if(c.indexOf("?")!=-1){c=c+"&"+d}else{c=c+"?"+d}this.get(c,h,b,f)},get:function(b,e,a,d){var c=true;if(d){c=false}b=actionUrl(b);$.ajax({url:b,type:"get",dataType:"json",timeout:jboltAjaxTimeout,async:c,success:function(f){if(f.state=="ok"){if(e){e(f)}}else{if(f.msg&&f.msg=="jbolt_system_locked"){showJboltLockSystem()}else{if(f.msg&&f.msg=="jbolt_nologin"){showReloginDialog()}else{LayerMsgBox.alert(f.msg,2);if(a){a()}}}}},error:function(){LayerMsgBox.alert("网络通讯异常",2);if(a){a()}}});jboltAjaxTimeout=60000}};function processOptionValue(b,c){var a=b[c];if(!a&&(a=="undefined"||a==undefined)){if(c!="value"){a=b["value"];if(!a&&(a=="undefined"||a==undefined)){a=b["id"]}}else{a=b["id"]}}return a}function processOptionText(h,f,b){var j="";if(f.indexOf(",")==-1){j=h[f];if(!j&&(j=="undefined"||j==undefined)){if(f!="text"){j=h["text"];if(!j&&(j=="undefined"||j==undefined)){j=h["name"];if(!j&&(j=="undefined"||j==undefined)){j=h["title"]}}}else{if(!j&&(j=="undefined"||j==undefined)){j=h["name"];if(!j&&(j=="undefined"||j==undefined)){j=h["title"]}}}}return j}var c=f.split(",");var e,a=c.length;for(var d=0;d<a;d++){e=h[c[d]];if(!b){j=j+"["+(e?e:"-")+"]"
}else{j=j+(e?e:"*")+((d<a-1)?b:"")}}return j}var formInputValueControls=["input","textarea","select"];function isFormInputValueControl(c){var b=c,a;if(!isDOM(c)){b=c[0]}a=b.tagName.toLowerCase();return formInputValueControls.indexOf(a)!=-1}var SelectUtil={setValueToOther:function(a){var b=a.data("setvalueto");if(b){var h=$("#"+b);if(isOk(h)){var d=a.data("select-type");var c=a.val();if(d&&d=="select2"){var f=a.data("text");if(f){var e=a.find("option").first();if(e.is(":selected")){if(c&&c.length>0){c.shift()}}}}if(isFormInputValueControl(h)){h.val(c?c:"")}else{h.text(c?c:"")}if(d&&d=="select2"){var f=a.data("text");setTimeout(function(){var i=new RegExp("&nbsp;","g");a.next().find("li.select2-selection__choice").each(function(){var j=$(this);if(f&&j.attr("title")==f){j.remove()}else{var k=j.html();k=k.replace(i,"");k=k.replace("├","");j.html(k)}})},60)}}}else{LayerMsgBox.alert("请配置data-setvalueto属性",2)}},setTextToOther:function(h){var c=h.data("settextto");if(c){var j=$("#"+c);if(isOk(j)){var f=h.data("select-type");var b=h.find("option:selected");var a=new RegExp("&nbsp;","g");var m=h.data("text");if(f&&f=="select2"){setTimeout(function(){h.next().find("li.select2-selection__choice").each(function(){var n=$(this);if(m&&n.attr("title")==m){n.remove()}else{var o=n.html();o=o.replace(a,"");o=o.replace("├","");n.html($.trim(o))}})},60)}if(isOk(b)){var k=isFormInputValueControl(j);var d=b.length;if(m&&d==1&&m==b.text()){if(k){j.val("")}else{j.text("")}return}var l=new Array(),e;b.each(function(){e=$(this).text();if(m&&m==e){return}e=e.replace(a,"");e=e.replace("├","");e=$.trim(e);l.push(e)});if(isOk(l)){var i=l;if(l.length==1){i=l[0]}else{i=l.join(",")}if(k){j.val(i)}else{j.text(i)}}}else{if(k){j.val("")}else{j.text("")}}}}else{LayerMsgBox.alert("请配置data-settextto属性",2)}},processItems:function(d,p,m,k,r,q,e,a){var c=this;var j,l,h,t;var s="&nbsp;&nbsp;&nbsp;&nbsp;";var o="&nbsp;&nbsp;&nbsp;";if(a>2){for(var n=0;n<(a-2);n++){s=s+o}}s=s+"├";for(var n in p){h=p[n];t=h.items;var b=t&&t.length>0;j=s+processOptionText(h,k,q);l=processOptionValue(h,r);var f='<option value="'+l+'">'+j+"</option>";if(b&&e){f='<optgroup data-value="'+l+'" label="'+j+'">'}else{f='<option value="'+l+'">'+j+"</option>"}if(m){f=m(f,h)}d+=f;if(b){d=c.processItems(d,t,m,k,r,q,e,(a+1));if(e){d+="</optgroup>"}}}return d},processChangeEventHandler:function(_thisSelect,setting){var that=this;if(setting&&setting.handler){if(setting.handler=="setValueToOther"){that.setValueToOther(_thisSelect);return true}if(setting.handler=="setTextToOther"){that.setTextToOther(_thisSelect);return true}that.processSetValueOrTextToOther(_thisSelect);setting.handler(_thisSelect);return true}var handler=_thisSelect.data("handler");if(handler){if(handler=="setValueToOther"){that.setValueToOther(_thisSelect);return true}if(handler=="setTextToOther"){that.setTextToOther(_thisSelect);return true}that.processSetValueOrTextToOther(_thisSelect);var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler(_thisSelect)}}else{that.processSetValueOrTextToOther(_thisSelect)}},processSetValueOrTextToOther:function(d){var c=this,b=d.data("setvalueto"),a=d.data("settextto");if(b){c.setValueToOther(d)}if(a){c.setTextToOther(d)}},readAndInsertItems:function(_thisSelect,setting,refreshing){var that=this;var selectedValue=_thisSelect.data("select");if(refreshing){selectedValue=_thisSelect.val()}var text_attr=_thisSelect.data("text-attr");if(!text_attr){text_attr="text"}var value_attr=_thisSelect.data("value-attr");if(!value_attr){value_attr="value"}var delimiter=_thisSelect.data("delimiter");var appendHandler=_thisSelect.data("append-handler");if(appendHandler){appendHandler=eval(appendHandler)}_thisSelect.empty();if(_thisSelect.data("text")){_thisSelect.append('<option value="'+_thisSelect.data("value")+'">'+_thisSelect.data("text")+"</option>")}var url=null;if(setting&&setting.url){url=setting.url}else{url=_thisSelect.data("url")}var onlyleaf=_thisSelect.data("onlyleaf");if(url!=null){url=actionUrl(url);$.ajax({type:"GET",url:url,dataType:"json",timeout:10000,context:_thisSelect,success:function(result){if(refreshing){LayerMsgBox.closeLoading()}if(result.state=="ok"){var html="";var list=result.data;var text,value,optionItem,option_items;for(var i in list){optionItem=list[i];option_items=optionItem.items;var hasItems=option_items&&option_items.length>0;text=processOptionText(optionItem,text_attr,delimiter);value=processOptionValue(optionItem,value_attr);var option='<option value="'+value+'">'+text+"</option>";if(hasItems&&onlyleaf){option='<optgroup data-value="'+value+'" label="'+text+'">'}else{option='<option value="'+value+'">'+text+"</option>"}if(appendHandler){option=appendHandler(option,optionItem)}html+=option;if(hasItems){html=that.processItems(html,option_items,appendHandler,text_attr,value_attr,delimiter,onlyleaf,2);if(onlyleaf){html+="</optgroup>"}}}_thisSelect.append(html);if(selectedValue||(typeof(selectedValue)=="boolean")){selectedValue=selectedValue.toString();
if(selectedValue.indexOf(",")!=-1){var arr=selectedValue.split(",");_thisSelect.val(arr)}else{_thisSelect.val(selectedValue)}if(!_thisSelect.val()){var selectOptions=_thisSelect.find("option");if(isOk(selectOptions)){_thisSelect.val(selectOptions.eq(0).val())}}}else{if(selectedValue==0||selectedValue=="0"){var selectOptions=_thisSelect.find("option[value='0']");if(isOk(selectOptions)){_thisSelect.val(selectedValue)}}}_thisSelect.change()}Select2Util.initAutoLoadSelect(_thisSelect);that.processRefresh(_thisSelect,setting)}})}},processRefresh:function(i,e){var f=this;if(i.data("refresh")){var d=i.parent().find(".fa-refresh");if(isOk(d)){return false}var c=i.data("select-type");var b;if(c&&c=="select2"){$(".tooltip.show").remove();var a=i.parent().find(".select2");a.addClass("hasRefresh");var h=a.find(".select2-selection__arrow");b=$('<span class="refresh"><i class="fa fa-refresh"></i></span>');a.append(b)}else{i.closest(".form-group").removeClass("form-group").addClass("input-group mb-3");b=$('<div class="input-group-append hand"><span class="input-group-text"><i class="fa fa-refresh"></i></span></div>');i.after(b)}b.click(function(j){j.preventDefault();j.stopPropagation();LayerMsgBox.loading("正在刷新数据...",10000);$(".tooltip.show").remove();f.readAndInsertItems(i,e,true);return false})}},findSelect:function(b){var a=null;if(b){if(b.selectId){if(b.parent){if(typeof b.parent=="object"){if(isDOM(b.parent)){a=$(b.parent).find("#"+b.selectId)}else{a=b.parent.find("#"+b.selectId)}}else{if(b.parent.indexOf("#")!=-1){a=$(b.parent).find("#"+b.selectId)}else{a=$("#"+b.parent).find("#"+b.selectId)}}}else{a=$("#"+b.selectId)}}else{if(b.parent){if(typeof b.parent=="object"){if(isDOM(b.parent)){a=$(b.parent).find("select[data-autoload]")}else{a=b.parent.find("select[data-autoload]")}}else{if(b.parent.indexOf("#")!=-1){a=$(b.parent).find("select[data-autoload]")}else{a=$("#"+b.parent).find("select[data-autoload]")}}}else{a=$("select[data-autoload]")}}}else{a=$("select[data-autoload]")}return a},init:function(d){var e=this;var c=e.findSelect(d);if(c&&c.length>0){var a=c.length;for(var b=0;b<a;b++){e.processOneSelect(c.eq(b),d)}}},processOneSelect:function(d,b){var c=this;c.processLinkAge(d,b);if((d.data("url")||(b&&b.url))){c.readAndInsertItems(d,b,false)}else{var a=d.data("select");if(a){d.val(a)}}},processLinkAge:function(_thisSelect,setting){var that=this;var islinkage=_thisSelect.data("linkage");if(islinkage){_thisSelect.unbind("change")}_thisSelect.on("change",function(){var beforechange=_thisSelect.data("beforechange");if(beforechange){var exe=eval(beforechange);if(exe){exe(_thisSelect)}}that.processChangeEventHandler(_thisSelect,setting);var sonIds=_thisSelect.data("sonid"),sonId,sonSelect,sonIdArr,srcUrl,url,sonLen;if(islinkage&&sonIds){sonIdArr=sonIds.split(",");sonLen=sonIdArr.length;for(var i=0;i<sonLen;i++){sonId=sonIdArr[i];sonSelect=$("#"+sonId);srcUrl=sonSelect.data("srcurl");if(srcUrl){if(srcUrl[srcUrl.length-1]=="="){url=srcUrl+_thisSelect.val()}else{url=srcUrl+"/"+_thisSelect.val()}}else{url=sonSelect.data("url")+"/"+_thisSelect.val()}SelectUtil.init({parent:_thisSelect.closest("form"),selectId:sonId,url:url})}}})},setValue:function(c,b,a){if(b!=undefined&&b!="undefined"&&b!=""){b=b+""}if(a!=undefined&&a!="undefined"&&a!=""){a=a+""}if(b){$("#"+c).val(b)}else{if(a){$("#"+c).val(a)}}},initAutoSetValue:function(b){var a=getRealJqueryObject(b);if(isOk(a)){a.find("select[data-autosetvalue]").each(function(){var c=$(this);var d=c.data("autosetvalue");c.val(""+d)})}}};function removeTableRow(h,f){var c=h.index();if(!f){f=h.closest("table")}var d=f.closest(".jbolt_table_view");if(isOk(d)&&!f.hasClass("jbolt_main_table")){f=d.find(".jbolt_table_box>.jbolt_table_body>table[data-jbolttable].jbolt_main_table")}var b=f[0].hasAttribute("data-jbolttable");var a=f[0].hasAttribute("data-jbolttreetable");if(b&&!a){var e=f.jboltTable("inst");e.me.deleteRow(e,c)}else{if(b&&a){var e=f.jboltTable("inst");e.me.deleteTreeTableRow(e,c)}else{if(a&&!b){deleteTreeTableRow(f,h)}else{h.remove()}}}}function removeTr(b){var a=$(b).closest("tr");if(isOk(a)){removeTableRow(a)}else{LayerMsgBox.alert("removeTr-找不到所在TR",2)}}function refreshJBoltLayer(){var a=$(".jbolt_layer");if(isOk(a)){a.find("[data-ajaxportal]").ajaxPortal(true)}}function removeByKey(b){var a=$(b).data("removekey");$("[data-removekey='"+a+"']").remove()}function removeTrCascade(f){var e=f.closest("tr");if(!e){return false}var h=e.data("id");if(!h){return false}var d=e.closest("table");removeTableRow(e,d);var b=d.find("tbody>tr[data-pid='"+h+"']");if(isOk(b)){var a=b.length;for(var c=0;c<a;c++){removeTrCascade(b.eq(c))}}}function trChangeToUp(a,e){var b=isArray(a);if(b){var j=a.length;var k;var h=new Array();for(var d=0;d<j;d++){k=a[d];k.insertBefore(e);if(!k.is(":hidden")){k.find("td").css({"background-color":"rgba(243, 99, 99, 0.4)"});h.push(k)}}if(isOk(h)){var f=h.length;var k;setTimeout(function(){for(var l=0;l<f;l++){k=h[l];k.find("td").css({"background-color":"transparent"})
}},1000)}}else{if(a.index()>0){a.insertBefore(e);var c=a.find("td");c.css({"background-color":"rgba(243, 99, 99, 0.4)"});setTimeout(function(){c.css({"background-color":"transparent"})},1000)}}}function processToChangeUpByPrevPage(e){var c=e.closest("table");var a=c.data("page");var h;if(a){h=jboltBody.find("#"+a)}else{h=jboltBody.find(".pages>.mainPagination")}if(h){var d=h.find(".pagination>a.current:not(.prev):not(.next)");if(isOk(d)){var f=parseInt(d.text());if(f>1){var b=h.find(".pagination>a.prev");if(isOk(b)){b.click()}}}}}function processToChangeDownByNextPage(a){var j=a.closest("table");var b=j.data("page");var c;if(b){c=jboltBody.find("#"+b)}else{c=jboltBody.find(".pages>.mainPagination")}if(c){var f=c.find(".pagination>a.current:not(.prev):not(.next)");var i=c.find(".pagination>a:not(.prev):not(.next):last");if(isOk(f)&&isOk(i)){var h=parseInt(f.text());var e=parseInt(i.text());if(h<e){var d=c.find(".pagination>a.next");if(isOk(d)){d.click()}}}}}function trMoveUp(h){var f=h.closest("table");var a=f.closest(".jbolt_table_fixed");var d=h.index();if(isOk(a)){f=f.closest(".jbolt_table_box").find(".jbolt_table_body>table");h=f.find("tbody>tr:eq("+d+")")}if(d==0){processToChangeUpByPrevPage(h);return false}var c=f[0].hasAttribute("data-jbolttable")&&f.hasClass("jbolt_table");var b=f[0].hasAttribute("data-jbolttreetable");if(c&&!b){var e=f.jboltTable("inst");e.me.moveUpRow(e,d)}else{if(c&&b){var e=f.jboltTable("inst");e.me.moveUpTreeTableRow(e,d)}else{if(b&&!c){moveUpTreeTableRow(f,h)}else{trChangeToUp(h,h.prev())}}}}function trChangeToDown(a,h){var b=isArray(a);if(b){var k=a.length;var l;var j=new Array();var e=k-1;for(var d=e;d>=0;d--){l=a[d];l.insertAfter(h);if(!l.is(":hidden")){l.find("td").css({"background-color":"rgba(243, 99, 99, 0.4)"});j.push(l)}}if(isOk(j)){var f=j.length;setTimeout(function(){for(var m=0;m<f;m++){j[m].find("td").css({"background-color":"transparent"})}},1000)}}else{if(a.index()>=0){a.insertAfter(h);var c=a.find("td");c.css({"background-color":"rgba(243, 99, 99, 0.4)"});setTimeout(function(){c.css({"background-color":"transparent"})},1000)}}}function trMoveDown(h){var f=h.closest("table");var a=f.closest(".jbolt_table_fixed");var d=h.index();var i=h.closest("tbody").find("tr:last").index();if(isOk(a)){f=f.closest(".jbolt_table_box").find(".jbolt_table_body>table");h=f.find("tbody>tr:eq("+d+")")}if(d==i){processToChangeDownByNextPage(h);return false}var c=f[0].hasAttribute("data-jbolttable")&&f.hasClass("jbolt_table");var b=f[0].hasAttribute("data-jbolttreetable");if(c&&!b){var e=f.jboltTable("inst");e.me.moveDownRow(e,d)}else{if(c&&b){var e=f.jboltTable("inst");e.me.moveDownTreeTableRow(e,d)}else{if(b&&!c){moveDownTreeTableRow(f,h)}else{trChangeToDown(h,h.next())}}}}var PageOptUtil={init:function(){var a=this;a.initDialogOptEvent();a.initAjaxLinkEvent();a.initPortalLink();a.initAjaxCheckInput()},initAjaxCheckInput:function(){jboltBody.on("blur","input[data-ajax-check-url]",function(c){c.preventDefault();c.stopPropagation();var a=$(this),d=$.trim(a.val()),b=a.data("ajax-check-url");if(d&&b){LayerMsgBox.loading("校验中...",10000);b=actionUrl(b);$.ajax({url:b,type:"post",dataType:"json",timeout:10000,data:{"data":d},success:function(e){if(e.state=="ok"){showItCheckSuccessResult(a);LayerMsgBox.closeLoading()}else{if(e.msg){if(e.msg=="jbolt_system_locked"){showJboltLockSystem()}else{if(e.msg=="jbolt_nologin"){showReloginDialog()}else{showItCheckFailResult(a,e.msg);LayerMsgBox.error(e.msg,1500)}}}else{LayerMsgBox.error("校验异常",1500)}}},error:function(){showItCheckFailResult(a);LayerMsgBox.error("网络通讯异常",1500)}})}return false})},initDialogOptEvent:function(){jboltBody.on("click","[data-dialogbtn]",function(b){b.preventDefault();b.stopPropagation();var a=$(this).data("target");if(a=="parent"){parent.DialogUtil.openBy(this)}else{if(a=="outparent"){parent.parent.DialogUtil.openBy(this)}else{DialogUtil.openBy(this)}}return false})},initAjaxLinkEvent:function(){jboltBody.on("click","[data-ajaxbtn]",function(e){e.preventDefault();e.stopPropagation();if(this.hasAttribute("disabled")||this.hasAttribute("data-disabled")){return false}var action=$(this);var url=action.attr("href");if(!url){url=action.data("url")}if(!url){alert("请设置URL地址");return false}var okhandler=action.attr("handler");if(!okhandler){okhandler=action.data("handler")}var checkHandler=action.data("check-handler");if(checkHandler){var checkResult;var exeCheck_handler=eval(checkHandler);if(exeCheck_handler&&typeof(exeCheck_handler)=="function"){checkResult=exeCheck_handler(action);if(!checkResult){return false}if(isArray(checkResult)){url=url+checkResult.join(",")}else{url=url+checkResult}}}var dataconfirm=action.data("confirm");var dataloading=action.data("loading");var ajaxFun=function(){var timeout=action.data("timeout");if(timeout){jboltAjaxTimeout=timeout}LayerMsgBox.loading(dataloading,jboltAjaxTimeout);Ajax.get(url,function(data){if(okhandler){LayerMsgBox.closeLoadingNow();if(okhandler=="removeTr"){removeTr(action)}else{if(okhandler=="removeTrCascade"){removeTrCascade(action)
}else{if(okhandler=="removeByKey"){removeByKey(action)}else{if(okhandler=="jboltTablePageToFirst"){jboltTablePageToFirst(action)}else{if(okhandler=="jboltTablePageToLast"){jboltTablePageToLast(action)}else{if(okhandler=="refreshJBoltTable"){refreshJBoltTable(action)}else{if(okhandler=="removeJBoltTableCheckedTr"){removeJBoltTableCheckedTr(action)}else{if(okhandler=="moveUp"){trMoveUp(action.closest("tr"))}else{if(okhandler=="moveDown"){trMoveDown(action.closest("tr"))}else{if(okhandler=="refreshPortal"){var portalId=action.data("portal");if(portalId){LayerMsgBox.success("操作成功",500,function(){$("#"+portalId).ajaxPortal(true)})}}else{var exe_handler=eval(okhandler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler(data)}}}}}}}}}}}}else{LayerMsgBox.success("操作成功",600)}})};if(dataconfirm){LayerMsgBox.confirm(dataconfirm,ajaxFun)}else{ajaxFun()}return false})},initPortalLink:function(){jboltBody.on("click","[data-portalbtn]",function(f){f.preventDefault();f.stopPropagation();var d=$(this);var b=d.data("portalid");if(!b){alert("请设置data-portalid");return false}var c=d.attr("href");if(!c){c=d.data("url")}if(!c){alert("请设置URL地址");return false}var a=$("#"+b);if(!a||a.length==0){alert("data-portalid不正确");return false}LayerMsgBox.loading("正在匹配...",30000);a.ajaxPortal(true,c,true,function(){LayerMsgBox.success("匹配完成",500)})})}};var TableUtil={init:function(){var a=this;a.initDelOptEvent();a.initEditOptEvent();a.initAddOptEvent()},initDelOptEvent:function(){jboltBody.on("click",".jbolt_table_delbtn",function(e){e.preventDefault();e.stopPropagation();var action=$(this);var url=action.attr("href");var okhandler=action.attr("handler");if(!okhandler){okhandler=action.data("handler")}var confirm=action.data("confirm");LayerMsgBox.confirm(confirm?confirm:"确定删除此项？",function(){LayerMsgBox.loading("删除中",10000);Ajax.get(url,function(ret){LayerMsgBox.closeLoading();LayerMsgBox.success(ret.msg?ret.msg:"操作成功");if(okhandler){if(okhandler=="removeTr"){removeTr(action)}else{if(okhandler=="removeTrCascade"){removeTrCascade(action)}else{if(okhandler=="refreshJBoltTable"){refreshJBoltTable(action)}else{if(okhandler=="jboltTablePageToLast"){jboltTablePageToLast(action)}else{if(okhandler=="jboltTablePageToFirst"){jboltTablePageToFirst(action)}else{if(okhandler=="removeByKey"){removeByKey(action)}else{if(okhandler=="refreshPortal"){var portalId=action.data("portal");if(portalId){LayerMsgBox.success("操作成功",500,function(){$("#"+portalId).ajaxPortal(true)})}}else{var exe_handler=eval(okhandler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler()}}}}}}}}}})});return false})},initEditOptEvent:function(){jboltBody.on("click",".jbolt_table_editbtn",function(b){b.preventDefault();b.stopPropagation();var a=$(this).data("target");if(a=="parent"){parent.DialogUtil.openBy(this)}else{if(a=="outparent"){parent.parent.DialogUtil.openBy(this)}else{DialogUtil.openBy(this)}}return false})},initAddOptEvent:function(){jboltBody.on("click",".jbolt_table_addbtn",function(b){b.preventDefault();b.stopPropagation();var a=$(this).data("target");if(a=="parent"){parent.DialogUtil.openBy(this)}else{if(a=="outparent"){parent.parent.DialogUtil.openBy(this)}else{DialogUtil.openBy(this)}}return false})}};var FormDate={hide:function(b){var a=getRealJqueryObject(b);if(!isOk(a)){return false}a.find("input[data-date][lay-key]").removeAttr("lay-key");jboltBody.find(".layui-laydate").remove()},initDate:function(dateEle){var dateType=dateEle.data("type");if(!dateType){dateType="date"}var datefmt=dateEle.data("fmt");if(!datefmt){switch(dateType){case"date":datefmt="yyyy-MM-dd";break;case"time":datefmt="HH:mm";break;case"datetime":datefmt="yyyy-MM-dd HH:mm";break;default:datefmt="yyyy-MM-dd";break}}var id=dateEle.attr("id");if(!id){id=dateEle.attr("name");id=id.replace(".","_")+"_"+randomId();dateEle.attr("id",id)}var minutes=dateEle.data("minutes");var changeHandler=dateEle.data("change-handler");var doneHandler=dateEle.data("done-handler");var small=dateEle.data("small");dateEle.removeAttr("lay-key","");var theme=dateEle.data("theme");var dateOptions={elem:"#"+id,type:dateType,format:datefmt,trigger:"click",theme:theme,ready:function(date){var layDate=$(".layui-laydate");if(small){layDate.addClass("small")}if(datefmt.indexOf("ss")==-1&&dateType!="month"&&dateType!="year"){layDate.addClass("noseconds");layDate.find(".laydate-time-list>li:eq(2)").remove()}if(minutes&&datefmt.indexOf("HH:mm")!=-1){var minutesArr=minutes.split(",");var box=layDate.find(".laydate-time-list li ol").eq(1);box.find("li").each(function(){var value=this.innerText;var inArr=$.inArray(value,minutesArr);if(inArr==-1){$(this).remove()}})}if(small){var eleTop=dateEle.offset().top;layDate.css({"top":(eleTop-265)+"px"})}},change:function(value,date,endDate){if(changeHandler){if(typeof(changeHandler)&&changeHandler=="checkme"){FormChecker.checkIt(dateEle)}else{var change_handler=eval(changeHandler);if(change_handler&&typeof(change_handler)=="function"){change_handler(dateEle,value)}}}},done:function(value,date,endDate){if(doneHandler){if(typeof(doneHandler)&&doneHandler=="checkme"){FormChecker.checkIt(dateEle)
}else{var done_handler=eval(doneHandler);if(done_handler&&typeof(done_handler)=="function"){done_handler(dateEle,value)}}}},};laydate.render(dateOptions)},initDates:function(c){if(!isOk(c)){return false}c.attr("readonly","readonly");var a=c.length;for(var b=0;b<a;b++){this.initDate(c.eq(b))}},init:function(b){var a=getRealJqueryObject(b);if(!isOk(a)){return false}var c=a.find("[data-date]");if(!isOk(c)){return false}this.initDates(c)}};function jsonObjectToUrlParam(d){var b=[];for(var a in d){var c=d[a];if(c.constructor==Array){c.forEach(function(e){b.push(a+"="+e)})}else{b.push(a+"="+c)}}return b.join("&")}var DialogUtil={openBy:function(ele){var action=$(ele);var url=action.data("url");if(!url){url=action.attr("href");if(url=="javascript:void(0)"){url=null}}var contentid=action.data("contentid");var content=action.data("content");if(!url&&!contentid&&!content){LayerMsgBox.alert("没有设置dialog的加载URL或者内容",2);return false}var checkHandler=action.data("check-handler");if(checkHandler){var checkResult;var exeCheck_handler=eval(checkHandler);if(exeCheck_handler&&typeof(exeCheck_handler)=="function"){checkResult=exeCheck_handler(action);if(!checkResult){return false}if(isArray(checkResult)){url=url+checkResult.join(",")}else{url=url+checkResult}}}var title=action.data("title");var handler=action.attr("handler");if(!handler){handler=action.data("handler")}var dialog_area=action.data("area");var w="800px";var h="500px";if(dialog_area){var area=dialog_area.split(",");var ww=area[0];var hh=area[1];if(ww.indexOf("px")!=-1||ww.indexOf("%")!=-1){w=ww}else{w=ww+"px"}if(hh.indexOf("px")!=-1||hh.indexOf("%")!=-1){h=hh}else{h=hh+"px"}}if(w.indexOf("%")==-1&&w.indexOf("px")!=-1){var pw=Number(w.replace("px",""));if(pw>jboltWindowWidth){w=(jboltWindowWidth-10)+"px"}}if(h.indexOf("%")==-1&&h.indexOf("px")!=-1){var ph=Number(h.replace("px",""));if(ph>jboltWindowHeight){h=(jboltWindowHeight-10)+"px"}}var dialog_scroll=action.data("scroll");if(dialog_scroll==undefined||dialog_scroll=="undefined"||(typeof(dialog_scroll)=="string"&&dialog_scroll!="no")||(typeof(dialog_scroll)=="boolean"&&dialog_scroll==true)){dialog_scroll="yes"}else{dialog_scroll="no"}var fs=action.data("fs");if(fs&&(fs=="true"||fs==true)){dialog_scroll="yes"}var cdrfp=action.data("cdrfp");if(cdrfp==undefined||cdrfp=="undefined"||cdrfp==""){cdrfp=false}var portalId=action.data("portalid");if(!portalId){portalId=action.data("portal")}var btn=action.data("btn");this.openNewDialog({ele:action,title:title,width:w,height:h,url:url,scroll:dialog_scroll,btn:btn,handler:handler,cdrfp:cdrfp,fs:fs,portalId:portalId,contentId:contentid,content:content})},openNewDialog:function(options){if(options.width.indexOf("%")==-1&&options.width.indexOf("px")==-1){options.width=options.width+"px"}if(options.height.indexOf("%")==-1&&options.height.indexOf("px")==-1){options.height=options.height+"px"}var btn=[];var dbtn=options.btn;if(!dbtn||dbtn=="yes"||dbtn=="true"){btn=["确定","关闭"]}else{if(dbtn&&dbtn=="no"){btn=[]}else{if(dbtn&&dbtn=="close"){btn=["确定","关闭"]}}}var type=2;if(!(options.url)&&(options.contentId||options.content)){type=1}var content="";if(type==1){if(options.contentId){content=$("#"+options.contentId).html()}else{if(options.content){if(options.content=="this"){content=options.ele.html();content='<div class="p-3 text-break">'+content+"</div>"}else{content='<div class="p-3 text-break">'+options.content+"</div>"}}}}else{var url=actionUrl(options.url);if(isOk(options.ele)){var params=options.ele.data("link-para-ele"),paras;if(params){var peles=$(params);if(isOk(peles)){var vv,nn,paras={};peles.each(function(i){nn=$(this).data("para-name")||this.name;vv=this.value;if(isOk(vv)){paras={};paras[nn]=vv}})}}else{paras=options.ele.data("paras")}if(paras){var purl=jsonObjectToUrlParam(paras);if(isOk(purl)){if(url.indexOf("?")==-1){url=url+"?"+purl}else{url=url+"&"+purl}}}}content=[url,options.scroll]}var lindex=layer.open({type:type,title:options.title,shadeClose:false,shade:0.5,maxmin:true,area:[options.width,options.height],content:content,btn:btn,success:function(obj,index){},yes:function(index){if(type==2){var iframeWin=window[$(".layui-layer-iframe").find("iframe")[0]["name"]];iframeWin.submitThisForm(function(){LayerMsgBox.close(index);if(options.handler){if(options.handler=="refreshPortal"){if(options.portalId){LayerMsgBox.success("操作成功",500,function(){$("#"+options.portalId).ajaxPortal(true)})}else{LayerMsgBox.alert("没有配置data-portalid",2)}}else{if(options.handler=="jboltTablePageToFirst"){jboltTablePageToFirst(options.ele)}else{if(options.handler=="jboltTablePageToLast"){jboltTablePageToLast(options.ele)}else{if(options.handler=="refreshJBoltTable"){refreshJBoltTable(options.ele)}else{if(options.handler=="refreshCurrentAjaxPortal"){refreshCurrentAjaxPortal(options.ele)}else{var exe_handler=eval(options.handler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler()}}}}}}}})}},end:function(){var type=typeof(options.cdrfp);var value=options.cdrfp;if(type=="boolean"&&value==true){refreshPjaxContainer()
}else{if(type=="string"&&value=="handler"&&options.handler){var exe_handler=eval(options.handler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler()}}}}});if(options.fs){layer.full(lindex)}if(dbtn&&dbtn=="close"){$("#layui-layer"+lindex).find("a.layui-layer-btn0").hide()}if(dbtn&&dbtn=="no"){$("#layui-layer"+lindex).find(".layui-layer-btn").remove()}}};String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};Date.prototype.Format=function(a){var c={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()};if(/(y+)/.test(a)){a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var b in c){if(new RegExp("("+b+")").test(a)){a=a.replace(RegExp.$1,(RegExp.$1.length==1)?(c[b]):(("00"+c[b]).substr((""+c[b]).length)))}}return a};function isArray(a){return(typeof a=="object")&&a.constructor==Array}function isEmpty(a){return(a=="undefined"||a==null||a==""||a==false)}function isNotEmpty(a){return((a!=null&&a!="undefined"&&a!="")||a==true)}function showFormEleErrorStyle(d,f,b){if(f&&(d.is(":hidden")||(d.is("input")&&d.attr("type")=="hidden"))){LayerMsgBox.error("<span class='j_text_danger'>"+f+"</span>",1000);return false}var e=d;var a=false;if(d.is("select")){var c=d.data("select-type");if(c&&c=="select2"){e=d.next().find(".select2-selection");a=true}}if(f){e.tooltip({boundary:"window",container:"body",title:f}).tooltip("show");$("#"+e.attr("aria-describedby")).addClass("error")}if(a){e.removeClass("border-success").addClass("border-danger")}else{e.removeClass("is-valid").addClass("is-invalid")}if(!b){d.focus();e.shake(1,5,300)}}function removeFormEleErrorStyle(c){var d=c;var a=false;if(c.is("select")){var b=c.data("select-type");if(b&&b=="select2"){d=c.next().find(".select2-selection");a=true}}if(a){d.removeClass("border-danger").addClass("border-success")}else{d.removeClass("is-invalid").addClass("is-valid")}d.tooltip("dispose")}jQuery.fn.shake=function(a,c,b,d){this.each(function(){var f=$(this);if(f.data("noshake")){return true}f.css({position:"relative"});for(var e=1;e<=a;e++){f.animate({left:(c*-1)},(((b/a)/4))).animate({left:c},((b/a)/2)).animate({left:0},(((b/a)/4)))}});if(d){d()}return this};function processCheckTab(a){var b=a.closest("div[role='tabpanel']");if(isOk(b)){var c=b.attr("id");$(".nav.nav-tabs .nav-item.nav-link[href='#"+c+"']").tab("show")}}function showItCheckFailResult(a,b){if(a.is("input")&&a.attr("type")=="hidden"){return}showFormEleErrorStyle(a,b,true)}function showItCheckSuccessResult(a){if(a.is("input")&&a.attr("type")=="hidden"){return}removeFormEleErrorStyle(a)}function TestRgexp(b,a){return b.test(a)}var vcity={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"};var IdCardNoCheckUtil={isCardNo:function(a){var b=/(^\d{15}$)|(^\d{17}(\d|X)$)/;if(!b.test(a)){return false}return true},checkProvince:function(b){var a=b.substr(0,2);if(vcity[a]==undefined){return false}return true},checkBirthday:function(a){var b=a.length;if(b=="15"){var j=/^(\d{6})(\d{2})(\d{2})(\d{2})(\d{3})$/;var d=a.match(j);var e=d[2];var c=d[3];var f=d[4];var h=new Date("19"+e+"/"+c+"/"+f);return this.verifyBirthday("19"+e,c,f,h)}if(b=="18"){var i=/^(\d{6})(\d{4})(\d{2})(\d{2})(\d{3})([0-9]|X)$/;var d=a.match(i);var e=d[2];var c=d[3];var f=d[4];var h=new Date(e+"/"+c+"/"+f);return this.verifyBirthday(e,c,f,h)}return false},verifyBirthday:function(d,h,a,e){var b=new Date();var c=b.getFullYear();if(e.getFullYear()==d&&(e.getMonth()+1)==h&&e.getDate()==a){var f=c-d;if(f>=3&&f<=100){return true}return false}return false},checkParity:function(e){e=this.changeFivteenToEighteen(e);var b=e.length;if(b=="18"){var d=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2);var a=new Array("1","0","X","9","8","7","6","5","4","3","2");var h=0,f,c;for(f=0;f<17;f++){h+=e.substr(f,1)*d[f]}c=a[h%11];if(c==e.substr(17,1)){return true}return false}return false},changeFivteenToEighteen:function(c){if(c.length=="15"){var b=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2);var a=new Array("1","0","X","9","8","7","6","5","4","3","2");var e=0,d;c=c.substr(0,6)+"19"+c.substr(6,c.length-6);for(d=0;d<17;d++){e+=c.substr(d,1)*b[d]}c+=a[e%11];return c}return c}};function checkIdCardNo(a){if(a===""){LayerMsgBox.alert("请输入身份证号，身份证号不能为空",2);return false}if(IdCardNoCheckUtil.isCardNo(a)===false){LayerMsgBox.alert("您输入的身份证号码不正确，请重新输入",2);return false}if(IdCardNoCheckUtil.checkProvince(a)===false){LayerMsgBox.alert("您输入的身份证号码不正确,请重新输入",2);return false}if(IdCardNoCheckUtil.checkBirthday(a)===false){LayerMsgBox.alert("您输入的身份证号码生日不正确,请重新输入",2);return false}if(IdCardNoCheckUtil.checkParity(a)===false){LayerMsgBox.alert("您的身份证校验位不正确,请重新输入",2);return false}return true}var jboltFormCheckRuleMap=[{type:"number",method:function(a){return(!isNaN(a))
}},{type:"pznumber",method:function(a){return(!isNaN(a)&&a*1>=0)}},{type:"pzint",method:function(a){return((TestRgexp(/^-?[0-9]\d*$/,a))&&(a*1>=0))}},{type:"pnumber",method:function(a){return(!isNaN(a)&&a*1>0)}},{type:"int",method:function(a){return TestRgexp(/^-?[0-9]\d*$/,a)}},{type:"pint",method:function(a){return TestRgexp(/^[0-9]*[1-9][0-9]*$/,a)}},{type:"email",method:function(a){return TestRgexp(/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/,a)}},{type:"filepath",method:function(a){return TestRgexp(/^([a-zA-Z]){1}:(\\[^\/\\:\*\?\"<>]+)*(\\)?$/,a)}},{type:"url",method:function(a){return TestRgexp(/^([hH][tT]{2}[pP]:\/\/|[hH][tT]{2}[pP][sS]:\/\/)(([A-Za-z0-9-~]+)\.)+([A-Za-z0-9-~\/])+$/,a)}},{type:"url_nohttp",method:function(a){return TestRgexp(/^((https|http|ftp|rtsp|mms){0,1}(:\/\/){0,1})(([A-Za-z0-9-~]+)\.)+([A-Za-z0-9-~\/])+$/,a)}},{type:"date",method:function(a){return TestRgexp(/^[1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/,a)}},{type:"time",method:function(a){return TestRgexp(/^(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d$/,a)}},{type:"time_hm",method:function(a){return TestRgexp(/^(20|21|22|23|[0-1]\d):[0-5]\d$/,a)}},{type:"datetime",method:function(a){return TestRgexp(/^[1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])\s+(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d$/,a)}},{type:"datetime_hm",method:function(a){return TestRgexp(/^[1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])\s+(20|21|22|23|[0-1]\d):[0-5]\d$/,a)}},{type:"money",method:function(a){return TestRgexp(/(^[1-9]\d*(\.\d{1,2})?$)|(^0(\.\d{1,2})?$)/,a)}},{type:"money_4",method:function(a){return TestRgexp(/(^[1-9]\d*(\.\d{1,4})?$)|(^0(\.\d{1,4})?$)/,a)}},{type:"phone",method:function(a){return TestRgexp(/0?(13|14|15|18)[0-9]{9}/,a)}},{type:"tel",method:function(a){return TestRgexp(/[0-9-()（）]{7,18}/,a)}},{type:"zh_cn",method:function(a){return TestRgexp(/[\u4e00-\u9fa5]/,a)}},{type:"ip",method:function(a){return TestRgexp(/(25[0-5]|2[0-4]\d|[0-1]\d{2}|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d{2}|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d{2}|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d{2}|[1-9]?\d)/,a)}},{type:"postalcode",method:function(a){return TestRgexp(/\d{6}/,a)}},{type:"idcardno",method:function(a){return checkIdCardNo(a)}},{type:"letter_num",method:function(a){return TestRgexp(/^\w+$/,a)}},{type:"letter",method:function(a){return TestRgexp(/^[A-Za-z]+$/,a)}},{type:"password",method:function(b){if(!b){return false}var a=b.length;return a>=6&&a<=16}}];function isDOM(b){var c=false;try{b.is(":hidden")}catch(a){c=true}return c}var FormChecker={init:function(){var a=this;if(window.initMineRuleMap){var b=initMineRuleMap();if(isOk(b)){jboltFormCheckRuleMap.push.apply(jboltFormCheckRuleMap,b)}}jboltBody.on("input","[data-rule]:not(select)",function(){var c=$(this);if(!c.data("ajax-check-url")){c.data("noshake",true);a.checkIt(c);c.data("noshake",false)}});jboltBody.on("change","select[data-rule]",function(){var c=$(this),e;var d=c.data("select-type");if(d&&d=="select2"){e=c.next().find(".select2-selection")}if(c.data("firstchanged")){c.data("noshake",true);if(isOk(e)){e.data("noshake",true)}a.checktype(c);c.data("noshake",false);if(isOk(e)){e.data("noshake",false)}}else{c.data("firstchanged",true);if(isOk(e)){e.data("firstchanged",true)}}})},checkIt:function(e,a){var j=this;var i=getRealJqueryObject(e);var h=true;if(i.is(":disabled")){return true}if(i.data("rule")){var f=j.checktype(i);var d=i.next().hasClass("input-group-append");var b=i.prev().hasClass("input-group-prepend");var c=i.is("textarea");if(!f){h=false;if(i.is("input")&&i.attr("type")=="hidden"){return}i.removeClass("is-valid").addClass("is-invalid");processCheckTab(i);i.shake(2,10,400);if(a){i.focus()}if(i.is("input")&&i.attr("type")=="file"){return}}else{h=true;if(i.is("input")&&i.attr("type")=="hidden"){return}i.removeClass("is-invalid").addClass("is-valid");if(i.is("input")&&i.attr("type")=="file"){return}}}return h},check:function(d){var a=getRealJqueryObject(d);var b=this;var c=true;a.find("input,textarea,select,[data-rule='checkbox'],[data-rule='radio']").each(function(){if(!c){return c}var f=$(this);if(f.is(":disabled")){return true}if(typeof(f.data("rule"))!="undefined"){var e=b.checktype(f);if(!e){c=false}else{c=true}}});return c},checkCheckboxRequired:function(d,f,b){var c=this;var e=d.data("name");if(!e){removeFormEleErrorStyle(d);return false}var h=$("input[type='checkbox'][name='"+e+"']:checked");if(h&&h.length>0){d.removeClass("bdc-danger").addClass("bdc-success");removeFormEleErrorStyle(d);return true}d.removeClass("bdc-success").addClass("bdc-danger");var a=d.data("tips");if(!a){a="必须选择至少一个选项"}c.showMyTipsIfNeed(d,a,b);return false},checkSelectRequired:function(b,e,c){var d=this;var h=b.val();var f=(h&&h!=""&&h!="0"&&h!="-1"&&h.length>0);if(f){removeFormEleErrorStyle(b);return true}var a=b.data("tips");if(!a){a="必须选择一个选项"}d.showMyTipsIfNeed(b,a,c);return false},checkRadioRequired:function(d,f,b){var c=this;var e=d.data("name");if(!e){removeFormEleErrorStyle(d);return false
}var h=$("input[type='radio'][name='"+e+"']:checked");if(h&&h.length>0){d.removeClass("bdc-danger").addClass("bdc-success");removeFormEleErrorStyle(d);return true}d.removeClass("bdc-success").addClass("bdc-danger");var a=d.data("tips");if(!a){a="必须选择至少一个选项"}c.showMyTipsIfNeed(d,a,b);return false},checktype:function(c){var b=this;var f=c.data("rule");if(!f){return true}var d=c.data("tips"),a=c.data("show"),e=c.data("notnull");var h=null;if(f=="checkbox"){if(e==null||e==true||e=="true"){return b.checkCheckboxRequired(c,d,a)}else{return true}}else{if(f=="radio"){if(e==null||e==true||e=="true"){return b.checkRadioRequired(c,d,a)}else{return true}}else{if(f=="select"){if(e==null||e==true||e=="true"){return b.checkSelectRequired(c,d,a)}else{return true}}else{h=c.val()}}}if(a!=null){g(a).innerHTML=""}if(typeof h=="string"){h=h.trim()}if(!h){if(e==null||e==true||e=="true"){if(!d){if(c.attr("type")=="file"){d="此文件必须上传"}else{d="必填项"}}showFormEleErrorStyle(c,d);if(a==null){}else{g(a).innerHTML=d}return false}else{return true}}return b.checkTypes(c,f,h,d,a,e)},checkTypes:function(k,j,l,e,m,c){var o=this;var f=j.split(";");var a=true;var h=1;var n=2;var b=3;for(var d=0;d<f.length;d++){var j=f[d];var p=o.checkSelf(k,j,l,e,m,c);if(p!=b){if(p==n){continue}else{a=false;break}}p=o.checkCompare(k,j,l,e,m,c);if(p!=b){if(p==n){continue}else{a=false;break}}}if(a){removeFormEleErrorStyle(k)}return a},checkCompare:function(h,e,i,d,j,c){var m=this;var f=1;var k=2;var b=3;var a=m.getRealTypeValue(i);var l=m.getCompareValue(e);if(e.indexOf("len=")!=-1){if(i.length==l){return k}if(!d){d="长度必须等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("len>=")!=-1){if(i.length>=l){return k}if(!d){d="长度必须大于等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("len>")!=-1){if(i.length>l){return k}if(!d){d="长度必须大于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf(">=")!=-1){if(a>=l){return k}if(!d){d="必须大于等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("len<=")!=-1){if(i.length<=l){return k}if(!d){d="长度必须小于等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("len<")!=-1){if(i.length<l){return k}if(!d){d="长度必须小于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("<=")!=-1){if(a<=l){return k}if(!d){d="必须小于等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf(">")!=-1){if(a>l){return k}if(!d){d="必须大于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("<")!=-1){if(a<l){return k}if(!d){d="必须小于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("!=")!=-1){if(a!=l){return k}if(!d){d="不能等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("==")!=-1){if(a==l){removeFormEleErrorStyle(h);return k}if(!d){if(e.indexOf("#")!=-1){d="必须等于id为["+e.substring(e.indexOf("#")+1)+"]元素的值"}else{d="必须等于"+l}}m.showMyTipsIfNeed(h,d,j);return f}}}}}}}}}}}return b},getRealTypeValue:function(a){if(!isNaN(a)){return Number(a)}return a},getCompareValue:function(b){var a=this;if(b.indexOf("#")!=-1){var c=b.substring(b.indexOf("#"));return a.getRealTypeValue($(c).val())}else{if(b.indexOf("len=")!=-1){return a.getRealTypeValue(b.substring(4))}if(b.indexOf("len")!=-1){b=b.substring(3)}if(b.indexOf("=")!=-1){return a.getRealTypeValue(b.substring(2))}else{return a.getRealTypeValue(b.substring(1))}}},showMyTipsIfNeed:function(b,c,a){if(c!=null){showFormEleErrorStyle(b,c);if(a==null){}else{g(a).innerHTML=c}}else{removeFormEleErrorStyle(b)}},checkSelf:function(j,f,k,e,l,c){var n=this;var h=1;var m=2;var b=3;if(f=="string"){return m}var a=false;for(var d=0;d<jboltFormCheckRuleMap.length;d++){if(f==jboltFormCheckRuleMap[d].type){a=true;var o=jboltFormCheckRuleMap[d].method.call(this,k);if(!o){if(!e){switch(f){case"email":e="Email格式不正确";break;case"phone":e="手机号格式不正确";break;case"tel":e="电话号码格式不正确";break;case"money":e="必须为金额(价格)格式 默认最多小数点后保留2位";break;case"money_4":e="必须为金额(价格)格式 最多小数点后保留4位";break;case"number":e="必须为数字";break;case"pnumber":e="必须为正数";break;case"pznumber":e="不能为负数";break;case"pzint":e="必须为0或正整数";break;case"int":e="必须为整数";break;case"pint":e="必须为正整数";break;case"date":e="必须为日期格式 例：2019-01-01";break;case"time":e="必须为时间格式 例：12:59:59";case"time_hm":e="必须为时间格式 例：12:59";break;case"datetime":e="必须为完整日期时间格式 例：2019-01-01 12:59:59";break;case"datetime_hm":e="必须为日期时间格式 例：2019-01-01 12:59";break;case"idnum":e="必须为18位身份证号 例：370523198901033922";break;case"postalcode":e="必须为6位邮政编码 例：6473098";break;case"zh_cn":e="必须为中文";break;case"letter_num":e="只能输入英文字母、数字和下划线";break;case"letter":e="只能输入英文字母";break;case"ip":e="必须为IP地址正确格式 例：127.0.0.1";break;case"password":e="密码长度必须为6~16个字符";break;case"select":e="必须选择一项";break}}n.showMyTipsIfNeed(j,e,l);return h}}}return a?m:b}};function initAdminLeftNav(){var a=localStorage.getItem("jbolt_hideMenu");if(a=="true"){jboltBody.find(".jbolt_admin_nav.expansion").removeClass("expansion");jboltAdmin.addClass("hideMenu");jboltBody.find(".jbolt_toggle_Left_nav_btn").addClass("hidden")}else{jboltAdmin.addClass("normalMenu")}jboltBody.on("click",".jbolt_admin_left_navs li.has_items",function(){if(jboltAdmin.hasClass("hideMenu")){return false
}var k=$(this);var j=k.find("a");var b=k.next("nav");var c=k.data("level");var e,h;var i=jboltBody.find(".jbolt_admin_left_navs li.has_items[data-level='"+c+"'].expansion");if(isOk(i)){e=i.find("a");h=e.data("key")}var f=j.data("key");var d=j.find("i.jbicon.title_arrow");d.toggleClass("haschanged");if(isOk(i)&&f!=h){i.removeClass("expansion");e.find("i.jbicon.title_arrow").removeClass("haschanged")}k.toggleClass("expansion");setTimeout(function(){changeLeftNavScroll()},400);return false});jboltBody.on("click",".jbolt_admin_left_navs>a[data-hasurl][data-open-type='1']",function(c){var b=jboltAdminLeftNavs.find(".jbolt_admin_nav.expansion");if(isOk(b)){b.removeClass("expansion");b.find(".jbolt_menu_group i.jbicon.jb-arrowdown").removeClass("haschanged")}});jboltBody.on("click",".jbolt_admin_left_navs .jbolt_menu_group",function(h){var c=$(this);var j=c.closest("nav");var b=jboltAdminLeftNavs.find(".jbolt_admin_nav.expansion");if(!c.hasClass("l1link")){var i=b.data("key");var d=j.data("key");if(i!=d){b.removeClass("expansion");b.find(".jbolt_menu_group i.jbicon.jb-arrowdown").removeClass("haschanged")}var f=c.find("i.jbicon.title_arrow");if(f.hasClass("haschanged")){j.removeClass("expansion")}else{j.addClass("expansion")}f.toggleClass("haschanged")}else{b.removeClass("expansion");b.find(".jbolt_menu_group i.jbicon.jb-arrowdown").removeClass("haschanged");j.addClass("expansion");j.find(".jbolt_menu_group i.jbicon.jb-arrowdown").addClass("haschanged")}setTimeout(function(){changeLeftNavScroll()},400)});jboltBody.on("mouseenter",".jbolt_admin.hideMenu  nav.jbolt_admin_nav .jbolt_menu_group",function(i){var b=$(this).closest("nav.jbolt_admin_nav");var f=b.find("ul.jbolt_admin_menus").first(),m=parseInt(f.outerHeight()),j=parseInt(b.offset().top),d=b.width();var k=m;if(m-10>jboltWindowHeight-j){j=jboltWindowHeight-m;if(j<120){j=120}k=jboltWindowHeight-j+60}else{j=j+60}f.css({"left":d+"px","top":j+"px","max-height":k+"px"});var l=(jboltWindowHeight-(jboltWindowHeight-j+60-f.outerHeight()));var h=b.offset().top;var c=(h+60);if(l<c){if(h<jboltWindowHeight&&c>jboltWindowHeight){j=j+(c-l)-(c-jboltWindowHeight)}else{j=j+(c-l)}}f.css("top",j+"px")}).on("mouseleave",".jbolt_admin.hideMenu  nav.jbolt_admin_nav",function(c){var b=$(this).find("ul.jbolt_admin_menus").first();b.css({"max-height":"none","height":"auto"})});initLeftNavScroll()}function changeLeftNavScroll(){initLeftNavScroll()}function initLeftNavScroll(){if(isOk(jboltAdminLeftNavs)){jboltAdminLeftNavs.getNiceScroll().remove();var a="rgba(255,255,255,1)";if(jboltAdmin.hasClass("jbolt_style_4")){a="rgba(0,0,0,0.1)"}jboltAdminLeftNavs.niceScroll({zIndex:1200,cursorcolor:a,cursoropacitymax:1,touchbehavior:false,cursorwidth:"4px",cursorborder:"1px",cursorborderradius:"4px",autohidemode:true}).resize()}}function sendPjax(b,a,c){b=actionUrl(b);$.pjax({url:b,container:a?a:mainPjaxContainerId,extData:c})}function pjaxErrorProcess(a){sendPjax("admin/pjaxerror",mainPjaxContainerId,{errorCode:a})}function pjaxSubmitForm(b){var d=$(b);var c=b.action;var a=d.serialize();if(c.indexOf("?")!=-1){c=c+"&"+a}else{c=c+"?"+a}$.pjax({url:c,container:mainPjaxContainerId});return false}var pjaxErrorTpl='<div class="jbolt_page" data-dontchangeleftnav="true">'+'<div class="jbolt_page_content"><div style="margin: 20px auto;max-width: 500px">'+'<div class="alert alert-danger">404,您访问的资源不存在!</div></div></div></div>';function initAdminPjax(){$.pjax.defaults.timeout=5000;jboltBody.on("pjax:start",function(){LayerMsgBox.load(3,5000)}).on("pjax:success",function(){afterPjax()}).on("pjax:end",function(){LayerMsgBox.closeLoadNow();LayerMsgBox.closeAll()}).on("pjax:error",function(h,b,d,c){if(!isWithtabs()){h.preventDefault();mainPjaxContainer.empty().html(pjaxErrorTpl);var f=$(h.relatedTarget).data("key");if(f){activeLeftNavByKey(f)}return false}}).on("pjax:timeout",function(b){LayerMsgBox.closeAll();b.preventDefault()}).on("pjax:popstate",function(b){if(b.direction=="back"){var c=jboltBody.data("ispjax");if(!c){refreshPjaxContainer()}}});jboltBody.on("submit","form[data-pjaxsubmit]",function(b){var c=$(this).data("needcheck");if(c){if(FormChecker.check(this)){$.pjax.submit(b,mainPjaxContainerId)}}else{$.pjax.submit(b,mainPjaxContainerId)}return false});jboltBody.on("click",'a[data-pjax]:not([target]),.jbolt_admin_left_navs a[data-open-type="1"]:not([target])',function(d){d.preventDefault();d.stopPropagation();var f=$(this),b=f.attr("href"),c=f.data("key");if(c){activeLeftNavByKey(c)}sendPjax(b,mainPjaxContainerId);return false});jboltBody.on("click",".jbolt_admin_left_navs a[data-open-type='2']",function(d){d.preventDefault();d.stopPropagation();var f=$(this),h=f.data("open-option"),b=f.attr("href"),c=f.data("key");activeLeftNavByKey(c);pjaxAdminLeftNavWithIframe(b);return false});jboltBody.on("click",".jbolt_admin_left_navs a[data-open-type='3']",function(d){d.preventDefault();d.stopPropagation();var h=$(this),i=h.data("open-option"),f=$.trim(h.text().replace("├","")),b=h.attr("href"),c=h.data("key");
activeLeftNavByKey(c);adminLeftNavshowInDialog(f,b,i);return false});jboltBody.on("click",".jbolt_admin_left_navs a[data-open-type='4']",function(d){d.preventDefault();d.stopPropagation();var f=$(this),h=f.data("open-option"),b=f.attr("href"),c=f.data("key");activeLeftNavByKey(c);JBoltLayerUtil.openByNav(b,h);return false});var a=jboltBody.data("ispjax");if(!a){afterPjax()}}function refreshCurrentTabContent(){var b=JBoltTabUtil.getCurrentTabContent();if(b&&b.length==1){LayerMsgBox.load(3);var a=b.find("iframe.jbolt_main_iframe");if(isOk(a)){a.attr("src",a.attr("src"))}else{b.ajaxPortal(true,null,true,function(){LayerMsgBox.closeLoadNow()})}}}function isIE(){if(!!window.ActiveXObject||"ActiveXObject" in window){return true}else{return false}}function refreshPjaxContainer(){if(self!=top){reloadCurrentPage()}else{var a=isWithtabs();if(a){refreshCurrentTabContent()}else{var b=mainPjaxContainer.find("iframe.jbolt_main_iframe");if(isOk(b)){b.attr("src",b.attr("src"))}else{if(isIE()){reloadCurrentPage()}else{$.pjax.reload(mainPjaxContainerId)}}}}}function initOpenLeftNav(){var c=isWithtabs();var e=null;if(c){var d=JBoltTabUtil.getCurrentTabContent();if(d&&d.length==1){e=d.find("div.jbolt_page[data-key]:first")}}else{e=$("div.jbolt_page[data-key]:first")}if(e&&e.length==1){var b=e.data("key");var a=e.data("dontchangeleftnav");if(!a){openLeftNav(b)}}}function activeLeftNavByKey(c){var f=jboltAdminLeftNavs.find("nav.jbolt_admin_nav a.active");if(f.data("key")==c){return false}f.removeClass("active");var b=$(".jbolt_admin_nav.expansion");b.removeClass("expansion");b.find(".jbolt_menu_group i.jbicon.jb-arrowdown").removeClass("hasChanged");var d=jboltAdminLeftNavs.find("nav.jbolt_admin_nav a[data-key='"+c+"']").first();if(isOk(d)){d.addClass("active");var e=d.closest("nav");if(isOk(e)){e.addClass("expansion");e.find(".jbolt_menu_group i.jbicon.jb-arrowdown:not(.haschanged)").addClass("haschanged");var a=d.closest("li");processParentUlAndHasItemsLiExp(a,e)}}}function actionUrl(a){if(a&&a.charAt(0)=="/"&&a.charAt(1)!="/"){a=a.substring(1)}return a}function openLeftNav(b){b=actionUrl(b);var f=jboltAdminLeftNavs.find("nav.jbolt_admin_nav a.active");if(f.attr("href")==b){return false}f.removeClass("active");var c=$(".jbolt_admin_nav.expansion");c.removeClass("expansion");c.find(".jbolt_menu_group i.jbicon.jb-arrowdown.haschanged").removeClass("haschanged");jboltAdminLeftNavs.find("li.has_items").removeClass("expansion").find("i.jbicon.jb-arrowdown.haschanged").removeClass("haschanged");var d=jboltAdminLeftNavs.find("nav.jbolt_admin_nav a[href='"+b+"']").first();if(isOk(d)){d.addClass("active");var e=d.closest("nav");if(isOk(e)){e.addClass("expansion");e.find(".jbolt_menu_group i.jbicon.jb-arrowdown:not(.haschanged)").addClass("haschanged");var a=d.closest("li");processParentUlAndHasItemsLiExp(a,e)}}}function processParentUlAndHasItemsLiExp(a,d){var e=a.data("level");if(e<=2){return false}var b=a.closest("ul.jbolt_admin_menus");if(isOk(b)){var c=b.prev("li.has_items");if(isOk(c)){c.addClass("expansion").find("i.jbicon.jb-arrowdown:not(.haschanged)").addClass("haschanged");processParentUlAndHasItemsLiExp(c,d)}}}function pjaxLoadRequirePluginAndInit(){var a=mainPjaxContainer.find(".jbolt_page[data-require-plugin]");if(a&&a.length==1){jboltPageLoadRequirePluginAndInit(a)}}function processLoadedPlugins(a){var c=new Array();for(var b in a){if(!loadedPlugins[a[b]]){c.push(a[b])}}return c}function loadJBoltPlugin(plugins,callback){if(plugins&&plugins.length>0&&callback){if(typeof(plugins)=="string"){if(plugins.indexOf(",")!=-1){plugins=plugins.split(",")}else{plugins=[plugins]}}plugins=processLoadedPlugins(plugins);if(!plugins||plugins.length==0){var exe_handler=eval(callback);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler()}return false}var plugin,pluginName;var cssArr,jsArr;for(var i in plugins){pluginName=plugins[i];plugin=jboltPlugins[pluginName];if(plugin){cssArr=plugin["css"];jsArr=plugin["js"];if(cssArr&&cssArr.length>0){AssetsLazyLoad.css(cssArr,function(){if(jsArr&&jsArr.length>0){AssetsLazyLoad.js(jsArr,function(){loadedPlugins[pluginName]=plugin;var exe_handler=eval(callback);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler()}})}else{loadedPlugins[pluginName]=plugin}})}else{if(jsArr&&jsArr.length>0){AssetsLazyLoad.js(jsArr,function(){loadedPlugins[pluginName]=plugin;var exe_handler=eval(callback);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler()}})}}}}}}function jboltPageLoadRequirePluginAndInit(d){var b=d.data("require-plugin");var a=b.split(",");var c=d.data("init-handler");loadJBoltPlugin(a,c)}function portalLoadRequirePluginAndInit(c){var a=getRealJqueryObject(c);if(!isOk(a)){return false}var b=a.find(".jbolt_page[data-require-plugin]");if(b&&b.length==1){jboltPageLoadRequirePluginAndInit(b)}}function afterPjax(){pjaxLoadRequirePluginAndInit();$(".tooltip.show").remove();initOpenLeftNav();SelectUtil.initAutoSetValue(mainPjaxContainer);JAtomFileUploadUtil.init(mainPjaxContainer);JAtomImgUploader.init(mainPjaxContainer);
SwitchBtnUtil.init(mainPjaxContainer);FormDate.init(mainPjaxContainer);LayerTipsUtil.init(mainPjaxContainer);HtmlEditorUtil.init(mainPjaxContainer);MasterSlaveUtil.init(mainPjaxContainer);ImageViewerUtil.init(mainPjaxContainer);RadioUtil.init(mainPjaxContainer);CheckboxUtil.init(mainPjaxContainer);AutocompleteUtil.init(mainPjaxContainer);Select2Util.init(mainPjaxContainer);SelectUtil.init({parent:mainPjaxContainer});MultipleFileInputUtil.init(mainPjaxContainer);initAjaxPortal(mainPjaxContainer);JSTreeUtil.init(mainPjaxContainer);JBoltInputUtil.init(mainPjaxContainer);initToolTip(mainPjaxContainer);initPopover(mainPjaxContainer);JBoltTableUtil.init(mainPjaxContainer);JBoltTreeTableUtil.init(mainPjaxContainer);findRequiredAndStarIt(mainPjaxContainer)}function jboltPageSubmitForm(b,d,f,h){var a=d.closest(".pages");if(!h){var e=a.find("#gonu");if(e&&e.length>0){h=e.val()}else{h=1}}var c=a.find("#pageSize").val();f.append('<input type="hidden" name="page" value="'+h+'"/>');f.append('<input type="hidden" name="pageSize" value="'+c+'"/>');f.submit()}function initPage(b,h,m,n){var c=isWithtabs();var e=null;var d=$("#"+b);var l=d.closest(".pages");var f=d.closest("[data-ajaxportal]");if(f&&f.length==1){e=f}else{if(c){e=JBoltTabUtil.getCurrentTabContent()}else{e=mainPjaxContainer;var j=!(e&&e.length==1);if(j){e=$("body .jbolt_page");var i=!(e&&e.length==1);if(i){e=jboltBody}}}}if(!e){return false}var a=e.find("#"+n);var k=a.attr("action");d.pagination(h,{num_edge_entries:1,current_page:(m-1),callback:function(o,p){if(isNaN(o)==false){var q=o+1;jboltPageSubmitForm(e,d,a,q);return false}}});l.find("#gonu").one("keydown",function(o){if(o.keyCode==109||o.keyCode==189){return false}});l.find(".page-btn").one("click",function(){jboltPageSubmitForm(e,d,a)});l.find("#pageSize").one("change",function(){jboltPageSubmitForm(e,d,a,1)})}function toggleMenuEvent(){jboltBody.on("click",".jbolt_toggle_Left_nav_btn",function(){$(this).toggleClass("hidden");$(".jbolt_admin_nav.expansion").removeClass("expansion");jboltAdmin.toggleClass("hideMenu").toggleClass("normalMenu");jboltAdminLeftNavs.find("nav.jbolt_admin_nav a.active").removeClass("active");var a=jboltAdmin.hasClass("hideMenu");if(!a){initOpenLeftNav()}localStorage.setItem("jbolt_hideMenu",a);setTimeout(function(){changeLeftNavScroll()},400)})}function goback(){history.go(-1)}function reloadCurrentPage(){var a=self.location.href;history.go(0)}function hideParentLayerDialogBtn(a){if(a==0||a==1){parent.$(".layui-layer-btn .layui-layer-btn"+a).hide()}else{hideAllParentLayerDialogBtn()}}function hideAllParentLayerDialogBtn(){parent.$(".layui-layer-btn").hide()}function bindKeycodeForDialogOkBtn(a){if(self!=top){parent.bindKeycodeForDialogOkBtn(a)}jboltBody.on("keyup",function(b){if(b.keyCode==a){if(self!=top){parent.$(".layui-layer-btn .layui-layer-btn0").click()}else{$(".layui-layer-btn .layui-layer-btn0").click()}}})}function bindEnterForDialogOkBtn(a){bindKeycodeForDialogOkBtn(13)}function bindKeycodeForDialogCloseBtn(a){if(self!=top){parent.bindKeycodeForDialogCloseBtn(a)}jboltWindow.on("keyup",function(b){if(b.keyCode==a){if(self!=top){parent.$(".layui-layer-btn .layui-layer-btn1").click()}else{$(".layui-layer-btn .layui-layer-btn1").click()}}})}function bindEscForDialogCloseBtn(){bindKeycodeForDialogCloseBtn(27)}function bindKeycodeForDialogBtnByBtnId(b){var a=b.length;if(self!=top){parent.bindKeycodeForDialogBtnByBtnId(b)}jboltWindow.on("keyup",function(f){var d;for(var c=0;c<a;c++){d=b[c];if(d.key==f.keyCode){if(self!=top){parent.$(".layui-layer-btn").find("a#"+d.id).click()}else{$(".layui-layer-btn").find("a#"+d.id).click()}}}})}function clickLayerBtnById(a){parent.$(".layui-layer-btn").find("a#"+a).click()}function clickLayerOkBtn(){parent.$(".layui-layer-btn .layui-layer-btn0").click()}function clickLayerCloseBtn(){parent.$(".layui-layer-btn .layui-layer-btn1").click()}function changeParentLayerDialogBtnTitle(a,b){parent.$(".layui-layer-btn .layui-layer-btn"+a).text(b)}function changeParentLayerDialogOkBtnTitle(a){changeParentLayerDialogBtnTitle(0,a)}function changeParentLayerDialogCancelBtnTitle(a){changeParentLayerDialogBtnTitle(1,a)}function getParentLayerDialogBtn(a){return parent.$(".layui-layer-btn .layui-layer-btn"+a)}function showParentLayerDialogBtn(a){if(a){parent.$(".layui-layer-btn .layui-layer-btn"+a).show()}else{parent.$(".layui-layer-btn").show()}}function checkExistLayerDialogBtnById(a){return parent.$(".layui-layer-btn").find("a#"+a)}function checkExistLayerDialogBtn(c,a){var d=parent.$(".layui-layer-btn").find("a."+a);var b=null;if(d&&d.length>0){d.each(function(){var e=$(this);if($.trim(e.text())==$.trim(c)){b=e;return false}})}return b}function addParentLayerDialogBtn(d,b,a){var f=checkExistLayerDialogBtn(d,b);var e;if(f){f.remove()}e="lay_btn_"+randomId();var c="<a id='"+e+"' class='"+b+"'>"+d+"</a>";parent.$(".layui-layer-btn").find("a.layui-layer-btn1").before(c);parent.$("#"+e).on("click",function(h){h.preventDefault();h.stopPropagation();if(a){a()
}});return e}function ajaxSubmitForm(a,d){var c=getRealJqueryObject(a);if(isOk(c)){if(FormChecker.check(c)){var b=c.action;c.ajaxSubmit({type:"post",url:b,success:function(e){if(e.state=="ok"){if(d){LayerMsgBox.success(e.msg,500,d)}else{LayerMsgBox.success(e.msg,500)}}else{LayerMsgBox.alert(e.msg,2)}}})}}return false}function getRealJqueryObject(b){if(!b){return jboltBody}var a=typeof(b);var c=null;if(a=="string"){if(b.indexOf("#")!=-1){c=$(b)}else{c=$("#"+b)}}else{if(a=="object"){if(isDOM(b)){c=$(b)}else{c=b}}}return c}function ajaxSubmitFormAndGoBack(a,b,c){ajaxSubmitForm(a,function(){var d=isWithtabs();if(d){closeCurrentAndReloadTiggerTab()}else{sendPjax(b,mainPjaxContainerId,c)}})}function closeCurrentAndReloadTiggerTab(a){var d=isWithtabs();if(d){var c=JBoltTabUtil.getCurrentTab();if(c&&c.length>0){if(a){JBoltTabUtil.showJboltTab(a,false,function(){JBoltTabUtil.close(c);refreshPjaxContainer()})}else{var b=c.data("trigger-tab-key");if(b&&JBoltTabUtil.isJboltTabExist(b)){JBoltTabUtil.showJboltTab(b,false,function(){JBoltTabUtil.close(c);refreshPjaxContainer()})}else{JBoltTabUtil.close(c)}}}}else{refreshPjaxContainer()}}function pageFormSubmit(a){var b=getRealJqueryObject(a);if(isOk(b)){if(FormChecker.check(b)){b.attr("onsubmit","return true;");b.submit()}}return false}function submitFormInCurrentTab(a,i){var d=getRealJqueryObject(a);if(isOk(d)){if(FormChecker.check(d)){var h=isWithtabs();if(h){var c=JBoltTabUtil.getCurrentTabContent();if(c&&c.length==1){var f=d.serialize();var e=d.attr("action");var b=e;if(b.indexOf("?")!=-1){b=b+"&"+f}else{b=b+"?"+f}LayerMsgBox.load(3);c.ajaxPortal(true,b,true,function(){LayerMsgBox.closeLoadNow();if(i){i()}})}}else{ajaxSubmitForm(d,i)}}}return false}function initJboltAdminTopStyleChange(){var a=$(".jbolt_admin_main_top");initToolTip(a)}function isWithtabs(){var a=$(".jbolt_admin.withtabs");return a&&a.length==1}function tabContentFormSubmitWithAjaxPortal(b){var a=JBoltTabUtil.getCurrentTabContent();if(isOk(a)){formSubmitToAjaxPortal(b,a)}}function formSubmitToAjaxPortal(c,a){var e=c.serialize();var d=c.attr("action");var b=d;if(b.indexOf("?")!=-1){b=b+"&"+e}else{b=b+"?"+e}LayerMsgBox.load(3);a.ajaxPortal(true,b,true,function(){LayerMsgBox.closeLoadNow()})}function currentTabContentRedirectWithAjaxPortal(a){var b=JBoltTabUtil.getCurrentTabContent();if(b&&b.length==1){LayerMsgBox.load(3);b.ajaxPortal(true,a,true,function(){LayerMsgBox.closeLoadNow()})}}function initAdminAjaxPortalFormSubmitEvent(){jboltBody.on("submit",".jbolt_page_title form,form[data-submittabportal]",function(b){b.preventDefault();b.stopPropagation();var a=$(this);var c=a.data("needcheck");if(c==undefined||c==null||c=="undefined"||c==""){c=true}if(c){if(FormChecker.check(this)){tabContentFormSubmitWithAjaxPortal(a)}}else{tabContentFormSubmitWithAjaxPortal(a)}return false})}function toggleInputHidden(c){if(c.indexOf(",")!=-1){var b=c.split(",");for(var a in b){toggleOneInputHidden(b[a])}}else{toggleOneInputHidden(c)}}function toggleOneInputHidden(b){var a=g(b);if(a.type=="hidden"){a.type="text"}else{a.type="hidden"}}(function(a){a.fn.extend({autocomplete:function(b,c){var d=typeof b=="string";c=a.extend({},a.Autocompleter.defaults,{url:d?b:null,data:d?null:b,delay:d?a.Autocompleter.defaults.delay:10,max:c&&!c.scroll?10:150,noRecord:"No Records."},c);c.highlight=c.highlight||function(e){return e};c.formatMatch=c.formatMatch||c.formatItem;return this.each(function(){new a.Autocompleter(this,c)})},result:function(b){return this.bind("result",b)},search:function(b){return this.trigger("search",[b])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(b){return this.trigger("setOptions",[b])},unautocomplete:function(){return this.trigger("unautocomplete")}});a.Autocompleter=function(n,h){var c={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8};var j=null;if(h.failure!=null&&typeof h.failure=="function"){j=h.failure}var b=a(n).attr("autocomplete","off").addClass(h.inputClass);var l;var s="";var o=a.Autocompleter.Cache(h);var e=0;var w;var z={mouseDownOnSelect:false};var t=a.Autocompleter.Select(h,n,d,z);var y;navigator.userAgent.indexOf("Opera")!=-1&&a(n.form).bind("submit.autocomplete",function(){if(y){y=false;return false}});b.bind((navigator.userAgent.indexOf("Opera")!=-1&&!"KeyboardEvent" in window?"keypress":"keydown")+".autocomplete",function(A){e=1;w=A.keyCode;switch(A.keyCode){case c.UP:if(t.visible()){A.preventDefault();t.prev()}else{v(0,true)}break;case c.DOWN:if(t.visible()){A.preventDefault();t.next()}else{v(0,true)}break;case c.PAGEUP:if(t.visible()){A.preventDefault();t.pageUp()}else{v(0,true)}break;case c.PAGEDOWN:if(t.visible()){A.preventDefault();t.pageDown()}else{v(0,true)}break;case h.multiple&&a.trim(h.multipleSeparator)==","&&c.COMMA:case c.TAB:case c.RETURN:if(d()){A.preventDefault();y=true;return false}break;case c.ESC:t.hide();break;default:clearTimeout(l);l=setTimeout(v,h.delay);break}}).focus(function(){e++}).blur(function(){e=0;
if(!z.mouseDownOnSelect){u()}}).click(function(){if(h.clickFire){if(!t.visible()){v(0,true)}}else{if(e++>1&&!t.visible()){v(0,true)}}}).bind("search",function(){var A=(arguments.length>1)?arguments[1]:null;function B(F,E){var C;if(E&&E.length){for(var D=0;D<E.length;D++){if(E[D].result.toLowerCase()==F.toLowerCase()){C=E[D];break}}}if(typeof A=="function"){A(C)}else{b.trigger("result",C&&[C.data,C.value])}}a.each(i(b.val()),function(C,D){f(D,B,B)})}).bind("flushCache",function(){o.flush()}).bind("setOptions",function(){a.extend(true,h,arguments[1]);if("data" in arguments[1]){o.populate()}}).bind("unautocomplete",function(){t.unbind();b.unbind();a(n.form).unbind(".autocomplete")});function d(){var D=t.selected();if(!D){return false}var A=D.result;s=A;if(h.multiple){var G=i(b.val());if(G.length>1){var C=h.multipleSeparator.length;var F=a(n).selection().start;var E,B=0;a.each(G,function(H,I){B+=I.length;if(F<=B){E=H;return false}B+=C});G[E]=A;A=G.join(h.multipleSeparator)}A+=h.multipleSeparator}b.val(A);x();b.trigger("result",[D.data,D.value]);return true}function v(C,B){if(w==c.DEL){t.hide();return}var A=b.val();if(!B&&A==s){return}s=A;A=k(A);if(A.length>=h.minChars){b.addClass(h.loadingClass);if(!h.matchCase){A=A.toLowerCase()}f(A,m,x)}else{p();t.hide()}}function i(A){if(!A){return[""]}if(!h.multiple){return[a.trim(A)]}return a.map(A.split(h.multipleSeparator),function(B){return a.trim(A).length?a.trim(B):null})}function k(A){if(!h.multiple){return A}var C=i(A);if(C.length==1){return C[0]}var B=a(n).selection().start;if(B==A.length){C=i(A)}else{C=i(A.replace(A.substring(B),""))}return C[C.length-1]}function r(A,B){if(h.autoFill&&(k(b.val()).toLowerCase()==A.toLowerCase())&&w!=c.BACKSPACE){b.val(b.val()+B.substring(k(s).length));a(n).selection(s.length,s.length+B.length)}}function u(){clearTimeout(l);l=setTimeout(x,200)}function x(){var A=t.visible();t.hide();clearTimeout(l);p();if(h.mustMatch){b.search(function(B){if(!B){if(h.multiple){var C=i(b.val()).slice(0,-1);b.val(C.join(h.multipleSeparator)+(C.length?h.multipleSeparator:""))}else{b.val("");b.trigger("result",null)}}})}}function m(B,A){if(A&&A.length&&e){p();t.display(A,B);r(B,A[0].value);t.show()}else{x()}}function f(C,E,B){if(!h.matchCase){C=C.toLowerCase()}var D=o.load(C);if(D){if(D.length){E(C,D)}else{var A=h.parse&&h.parse(h.noRecord)||q(h.noRecord);E(C,A)}}else{if((typeof h.url=="string")&&(h.url.length>0)){var F={timestamp:+new Date()};a.each(h.extraParams,function(G,H){F[G]=typeof H=="function"?H():H});a.ajax({mode:"abort",port:"autocomplete"+n.name,dataType:h.dataType,url:h.url,data:a.extend({q:k(C),limit:h.max},F),success:function(H){var G=h.parse&&h.parse(H)||q(H);o.add(C,G);E(C,G)}})}else{t.emptyList();if(j!=null){j()}else{B(C)}}}}function q(D){var A=[];var C=D.split("\n");for(var B=0;B<C.length;B++){var E=a.trim(C[B]);if(E){E=E.split("|");A[A.length]={data:E,value:E[0],result:h.formatResult&&h.formatResult(E,E[0])||E[0]}}}return A}function p(){b.removeClass(h.loadingClass)}};a.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:false,matchSubset:true,matchContains:false,cacheLength:100,max:1000,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(b){return b[0]},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:" ",inputFocus:true,clickFire:false,highlight:function(c,b){return c.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+b.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:true,scrollHeight:300,scrollJumpPosition:true};a.Autocompleter.Cache=function(c){var f={};var d=0;function i(l,k){if(!c.matchCase){l=l.toLowerCase()}var j=l.indexOf(k);if(c.matchContains=="word"){j=l.toLowerCase().search("\\b"+k.toLowerCase())}if(j==-1){return false}return j==0||c.matchContains}function h(k,j){if(d>c.cacheLength){b()}if(!f[k]){d++}f[k]=j}function e(){if(!c.data){return false}var k={},j=0;if(!c.url){c.cacheLength=1}k[""]=[];for(var m=0,l=c.data.length;m<l;m++){var p=c.data[m];p=(typeof p=="string")?[p]:p;var o=c.formatMatch(p,m+1,c.data.length);if(typeof(o)==="undefined"||o===false){continue}var n=o.charAt(0).toLowerCase();if(!k[n]){k[n]=[]}var q={value:o,data:p,result:c.formatResult&&c.formatResult(p)||o};k[n].push(q);if(j++<c.max){k[""].push(q)}}a.each(k,function(r,s){c.cacheLength++;h(r,s)})}setTimeout(e,25);function b(){f={};d=0}return{flush:b,add:h,populate:e,load:function(n){if(!c.cacheLength||!d){return null}if(!c.url&&c.matchContains){var m=[];for(var j in f){if(j.length>0){var o=f[j];a.each(o,function(p,k){if(i(k.value,n)){m.push(k)}})}}return m}else{if(f[n]){return f[n]}else{if(c.matchSubset){for(var l=n.length-1;l>=c.minChars;l--){var o=f[n.substr(0,l)];if(o){var m=[];a.each(o,function(p,k){if(i(k.value,n)){m[m.length]=k}});return m}}}}}return null}}};a.Autocompleter.Select=function(e,k,m,q){var j={ACTIVE:"ac_over"};var l,f=-1,s,n="",t=true,c,p;function o(){if(!t){return
}c=a("<div/>").hide().addClass(e.resultsClass).css("position","absolute").appendTo(document.body).hover(function(u){if(a(this).is(":visible")){k.focus()}q.mouseDownOnSelect=false});p=a("<ul/>").appendTo(c).mouseover(function(u){if(r(u).nodeName&&r(u).nodeName.toUpperCase()=="LI"){f=a("li",p).removeClass(j.ACTIVE).index(r(u));a(r(u)).addClass(j.ACTIVE)}}).click(function(u){a(r(u)).addClass(j.ACTIVE);m();if(e.inputFocus){k.focus()}return false}).mousedown(function(){q.mouseDownOnSelect=true}).mouseup(function(){q.mouseDownOnSelect=false});if(e.width>0){c.css("width",e.width)}t=false}function r(v){var u=v.target;while(u&&u.tagName!="LI"){u=u.parentNode}if(!u){return[]}return u}function i(u){l.slice(f,f+1).removeClass(j.ACTIVE);h(u);var w=l.slice(f,f+1).addClass(j.ACTIVE);if(e.scroll){var v=0;l.slice(0,f).each(function(){v+=this.offsetHeight});if((v+w[0].offsetHeight-p.scrollTop())>p[0].clientHeight){p.scrollTop(v+w[0].offsetHeight-p.innerHeight())}else{if(v<p.scrollTop()){p.scrollTop(v)}}}}function h(u){if(e.scrollJumpPosition||(!e.scrollJumpPosition&&!((u<0&&f==0)||(u>0&&f==l.size()-1)))){f+=u;if(f<0){f=l.size()-1}else{if(f>=l.size()){f=0}}}}function b(u){return e.max&&e.max<u?e.max:u}function d(){p.empty();var v=b(s.length);for(var w=0;w<v;w++){if(!s[w]){continue}var x=e.formatItem(s[w].data,w+1,v,s[w].value,n);if(x===false){continue}var u=a("<li/>").html(e.highlight(x,n)).addClass(w%2==0?"ac_even":"ac_odd").appendTo(p)[0];a.data(u,"ac_data",s[w])}l=p.find("li");if(e.selectFirst){l.slice(0,1).addClass(j.ACTIVE);f=0}if(a.fn.bgiframe){p.bgiframe()}}return{display:function(v,u){o();s=v;n=u;d()},next:function(){i(1)},prev:function(){i(-1)},pageUp:function(){if(f!=0&&f-8<0){i(-f)}else{i(-8)}},pageDown:function(){if(f!=l.size()-1&&f+8>l.size()){i(l.size()-1-f)}else{i(8)}},hide:function(){c&&c.hide();l&&l.removeClass(j.ACTIVE);f=-1},visible:function(){return c&&c.is(":visible")},current:function(){return this.visible()&&(l.filter("."+j.ACTIVE)[0]||e.selectFirst&&l[0])},show:function(){var w=a(k).offset();c.css({width:typeof e.width=="string"||e.width>0?e.width:a(k).width(),top:w.top+k.offsetHeight,left:w.left}).show();if(e.scroll){p.scrollTop(0);p.css({maxHeight:e.scrollHeight,overflow:"auto"});if(navigator.userAgent.indexOf("MSIE")!=-1&&typeof document.body.style.maxHeight==="undefined"){var u=0;l.each(function(){u+=this.offsetHeight});var v=u>e.scrollHeight;p.css("height",v?e.scrollHeight:u);if(!v){l.width(p.width()-parseInt(l.css("padding-left"))-parseInt(l.css("padding-right")))}}}},selected:function(){var u=l&&l.filter("."+j.ACTIVE).removeClass(j.ACTIVE);return u&&u.length&&a.data(u[0],"ac_data")},emptyList:function(){p&&p.empty()},unbind:function(){c&&c.remove()}}};a.fn.selection=function(j,b){if(j!==undefined){return this.each(function(){if(this.createTextRange){var k=this.createTextRange();if(b===undefined||j==b){k.move("character",j);k.select()}else{k.collapse(true);k.moveStart("character",j);k.moveEnd("character",b);k.select()}}else{if(this.setSelectionRange){this.setSelectionRange(j,b)}else{if(this.selectionStart){this.selectionStart=j;this.selectionEnd=b}}}})}var h=this[0];if(h.createTextRange){var c=document.selection.createRange(),i=h.value,f="<->",d=c.text.length;c.text=f;var e=h.value.indexOf(f);h.value=i;this.selection(e,e+d);return{start:e,end:e+d}}else{if(h.selectionStart!==undefined){return{start:h.selectionStart,end:h.selectionEnd}}}}})(jQuery);(function(a){a.PaginationCalculator=function(b,c){this.maxentries=b;this.opts=c};a.extend(a.PaginationCalculator.prototype,{numPages:function(){return Math.ceil(this.maxentries/this.opts.items_per_page)},getInterval:function(f){var d=Math.floor(this.opts.num_display_entries/2);var e=this.numPages();var c=e-this.opts.num_display_entries;var h=f>d?Math.max(Math.min(f-d,c),0):0;var b=f>d?Math.min(f+d+(this.opts.num_display_entries%2),e):Math.min(this.opts.num_display_entries,e);return{start:h,end:b}}});a.PaginationRenderers={};a.PaginationRenderers.defaultRenderer=function(b,c){this.maxentries=b;this.opts=c;this.pc=new a.PaginationCalculator(b,c)};a.extend(a.PaginationRenderers.defaultRenderer.prototype,{createLink:function(b,e,d){var f,c=this.pc.numPages();b=b<0?0:(b<c?b:c-1);d=a.extend({text:b+1,classes:""},d||{});if(b==e){f=a("<a class='current'>"+d.text+"</a>")}else{f=a("<a>"+d.text+"</a>").attr("href",this.opts.link_to.replace(/__id__/,b+1))}if(d.classes){f.addClass(d.classes)}f.data("page_id",b);return f},appendRange:function(c,f,h,b,e){var d;for(d=h;d<b;d++){this.createLink(d,f,e).appendTo(c)}},getLinks:function(i,e){var f,b,c=this.pc.getInterval(i),h=this.pc.numPages(),d=a("<div class='pagination'></div>");if(this.opts.prev_text&&(i>0||this.opts.prev_show_always)){d.append(this.createLink(i-1,i,{text:this.opts.prev_text,classes:"prev"}))}if(c.start>0&&this.opts.num_edge_entries>0){b=Math.min(this.opts.num_edge_entries,c.start);this.appendRange(d,i,0,b,{classes:"sp"});if(this.opts.num_edge_entries<c.start&&this.opts.ellipse_text){a("<span class='pagination-break'>"+this.opts.ellipse_text+"</span>").appendTo(d)
}}this.appendRange(d,i,c.start,c.end);if(c.end<h&&this.opts.num_edge_entries>0){if(h-this.opts.num_edge_entries>c.end&&this.opts.ellipse_text){a("<span class='pagination-break'>"+this.opts.ellipse_text+"</span>").appendTo(d)}f=Math.max(h-this.opts.num_edge_entries,c.end);this.appendRange(d,i,f,h,{classes:"ep"})}if(this.opts.next_text&&(i<h-1||this.opts.next_show_always)){d.append(this.createLink(i+1,i,{text:this.opts.next_text,classes:"next"}))}a("a",d).click(e);return d}});a.fn.pagination=function(j,b){b=a.extend({items_per_page:1,num_display_entries:4,current_page:0,num_edge_entries:1,link_to:"javascript:void(0)",prev_text:"<i></i>上一页",next_text:"下一页 <i></i>",ellipse_text:"...",prev_show_always:true,next_show_always:true,renderer:"defaultRenderer",show_if_single_page:false,load_first_page:false,callback:function(){return false}},b||{});var c=this,f,l,e;function d(n){var o,m=a(n.target).data("page_id"),p=h(m);if(!p){n.stopPropagation()}return p}function h(m){c.data("current_page",m);l=f.getLinks(m,d);c.empty();l.appendTo(c);var n=b.callback(m,c);return n}e=parseInt(b.current_page);c.data("current_page",e);j=(!j||j<0)?1:j;b.items_per_page=(!b.items_per_page||b.items_per_page<0)?1:b.items_per_page;if(!a.PaginationRenderers[b.renderer]){throw new ReferenceError("Pagination renderer '"+b.renderer+"' was not found in jQuery.PaginationRenderers object.")}f=new a.PaginationRenderers[b.renderer](j,b);var i=new a.PaginationCalculator(j,b);var k=i.numPages();c.bind("setPage",{numPages:k},function(n,m){if(m>=0&&m<n.data.numPages){h(m);return false}});c.bind("prevPage",function(m){var n=a(this).data("current_page");if(n>0){h(n-1)}return false});c.bind("nextPage",{numPages:k},function(m){var n=a(this).data("current_page");if(n<m.data.numPages-1){h(n+1)}return false});l=f.getLinks(e,d);c.empty();if(k>1||b.show_if_single_page){l.appendTo(c)}if(b.load_first_page){b.callback(e,c)}}})(jQuery);var JBoltTablinkBoxUtil={init:function(){jboltBody.on("click",".jbolt_tab_view .jbolt_tab_link",function(f){f.preventDefault();var c=$(this);var a=c.attr("href");if(!a){LayerMsgBox.alert("请设置选项卡href绑定内容区域ID",2);return false}var b=c.closest(".jbolt_tab_view");var h=b.find(".jbolt_tab_link.active");if(isOk(h)){var d=h.attr("href");if(d==a){return false}h.removeClass("active");b.find(d).removeClass("active")}c.addClass("active");b.find(a).addClass("active")})}};var MasterSlaveUtil={init:function(f){var d=getRealJqueryObject(f);if(!isOk(d)){return false}var e=this;var b=d.find(".jbolt_master_slave_box");if(!isOk(b)){return false}var a=b.length;for(var c=0;c<a;c++){e.initHeight(b.eq(c))}},initMasterTableEvent:function(){var a=this;jboltBody.on("click",".jbolt_page .jbolt_master_slave_box .jbolt_master_container table.table>tbody>tr",function(){var d=$(this);d.parent().find("tr.active").removeClass("active");d.addClass("active");var e=d.data("id");if(!e){LayerMsgBox.alert("数据TR绑定data-id为空",2)}else{LayerMsgBox.load(3);var b=d.closest(".jbolt_master_slave_box").find(".jbolt_slave_container [data-ajaxportal]");var c=b.length;if(b&&c){b.each(function(k){var f=$(this);var j=f.data("orign-url")||f.data("srcurl");if(!j){LayerMsgBox.alert("AjaxPortal组件需要设置data-orign-url属性",2);LayerMsgBox.closeLoadNow();return false}else{var h=j+e;f.ajaxPortal(true,h,true,function(){if(k==c-1){LayerMsgBox.closeLoadNow()}a.initPortalHeight(f)})}})}}})},initPortalHeight:function(b){var a=b.closest(".jbolt_slave_container");if(a&&a.length>0){var c=a.outerHeight()-45;a.find(".jbolt_slave_body").each(function(){var d=$(this);var f=d.parent().find(".jbolt_slave_top");if(f&&f.length>0){var e=f.outerHeight();d.height(c-e)}else{d.height(c)}})}},initHeight:function(c){var a=mainPjaxContainer.height()-60;var b=mainPjaxContainer.find(".jbolt_page_title");if(b&&b.length>0){a=a-Math.ceil(b.height())}var d=mainPjaxContainer.find(".jbolt_page_content");if(d&&d.length>0){c.height(Math.floor(a))}}};function resizeJBoltLayer(){var b=jboltBody.find(".jbolt_layer_portal");if(b&&b.length==1){var i=b.closest("#jbolt_layer");if(i&&i.length==1){var h=i.data("triggerid");if(h){var d=$("#"+h);if(d&&d.length==1){var a=d.data("height");if(a){var c=jboltWindowHeight-a;if(c<0){c=0}var f=c+"px";b.css({"top":f});var e=i.find(".jbolt_layer_close");if(e&&e.length==1){e.css({"top":f})}}}}}}}var resizingJboltTableWidth=false;function resizeJboltTableWidth(){}function resizeFillHeightJboltTable(){var a=jboltBody.find(".jbolt_table_view table.jbolt_table.jbolt_main_table[data-height='fill']");if(isOk(a)){a.each(function(){var c=$(this);var b=c.jboltTable("inst");b.me.resize(b)})}}function resizeFillBoxHeightJboltTable(){var a=jboltBody.find(".jbolt_table_view table.jbolt_table.jbolt_main_table[data-height='fill_box']");if(isOk(a)){a.each(function(){var c=$(this);var b=c.jboltTable("inst");b.me.processTableFillBox(b)})}}function onwindowReisze(){jboltWindow.bind("resize",function(){jboltWindowWidth=jboltWindow.width();jboltWindowHeight=jboltWindow.height();resizeJBoltLayer();JBoltInputUtil.hideJBoltInputLayer();
resizeJboltTableWidth();resizeFillHeightJboltTable();resizeFillBoxHeightJboltTable();MasterSlaveUtil.init(mainPjaxContainer)})}function toggleVisiable(b,e){if(e){var h=getRealJqueryObject(e);var f,c;if(isOk(h)){var c=h.closest("[data-ajaxportal]");if(!isOk(c)){c=h.closest(".jbolt_page");if(!isOk(c)){c=jboltBody}}}if(isOk(c)){f=c.find(b)}else{f=$(b)}if(isOk(f)){f.toggle()}}else{var a=isWithtabs();if(a){var d=JBoltTabUtil.getCurrentTabContent();if(d&&d.length==1){d.find(b).toggle()}}else{if(isOk(mainPjaxContainer)){$(mainPjaxContainer).find(b).toggle()}else{jboltBody.find(b).toggle()}}}}var lockHtmlTpl='<div oncontextmenu="doNothing()" class="j_locksystem noselect" id="j_locksystem">'+'<div class="j_lockmain"><h1>屏幕已锁</h1><div class="j_lockpassword">'+'<input onkeyup="unlockSystem(event)" maxlength="40" type="password" id="unlockpwd" placeholder="请在此处，输入登录密码" name="password"  autocomplete="off" /></div></div></div>';var lockSystemTimer;function checkLockSystem(){var a=$("#j_locksystem");if(a&&a.length==1){a.removeClass("__web-inspector-hide-shortcut__");a.show()}else{showJBoltLockSystemEle()}}function showJboltLockSystem(){showJBoltLockSystemEle();lockSystemTimer=setInterval(checkLockSystem,600)}function showJBoltLockSystemEle(){if(self!=top){parent.showJboltLockSystem()}else{var a=$("#j_locksystem");if(!(a&&a.length==1)){jboltBody.append(lockHtmlTpl);a=$("#j_locksystem")}$("#unlockpwd").val("");a.removeClass("__web-inspector-hide-shortcut__");a.fadeIn(300)}}function unlockSystem(a){var c=a.keyCode?a.keyCode:a.which?a.which:a.charCode;if(c==13){var b=$("#unlockpwd").val();if(!($.trim(b))){LayerMsgBox.alert("请输入登录密码",2)}else{LayerMsgBox.loading("解锁中...",10000);Ajax.post("/admin/unLockSystem",{"password":b},function(d){LayerMsgBox.success("解锁成功",500,closeJboltLockSystem)})}}}function closeJboltLockSystem(){if(self!=top){parent.closeJboltLockSystem()}else{clearInterval(lockSystemTimer);if(isOk(jboltAdmin)){$("#unlockpwd").val("");$("#j_locksystem").fadeOut(300)}else{reloadCurrentPage()}}}function doNothing(){window.event.returnValue=false;return false}function initToolTip(c){var a;if(c){var b=getRealJqueryObject(c);if(isOk(b)){a=b.find("[tooltip],[data-toggle='tooltip']")}}else{a=jboltBody.find("[tooltip],[data-toggle='tooltip']")}if(isOk(a)){a.tooltip({boundary:"window",container:"body"})}}function initPopover(b){var c;if(b){var a=getRealJqueryObject(b);if(isOk(a)){c=a.find("[popover],[data-toggle='popover']")}}else{c=jboltBody.find("[popover],[data-toggle='popover']")}if(isOk(c)){c.popover({boundary:"window",container:"body"})}}function destroyToolTip(b){if(b){var a=getRealJqueryObject(b);if(isOk(a)){a.find("[tooltip],[data-toggle='tooltip']").tooltip("destroy")}}else{jboltBody.find("[tooltip],[data-toggle='tooltip']").tooltip("destroy")}}function resetToolTip(a){destroyToolTip(a);initToolTip(a)}function changeUserJboltStyle(c){var h=$("#jbolt_user_config_style_box");h.find(".jbolt_config_style.active").removeClass("active");h.find("#jbs_"+c).addClass("active");var d=jboltAdmin[0].className;var f=d.split(" ");var a="";var e="";for(var b in f){e=f[b];if(e!="default"&&e.indexOf("jbolt_style_")==-1){a=a+e+" "}}jboltAdmin[0].className=a+c;changeLeftNavScroll()}function initLoginStyle(){var b=$.cookie("jbolt_login_glassStyle");var a=$.cookie("jbolt_login_bgimgBlur");if(b&&b=="true"){$(".jbolt_loginform").addClass("jbolt_bg_glass")}else{$(".jbolt_loginform").removeClass("jbolt_bg_glass")}if(a&&a=="true"){$(".bodybgmask").addClass("blur")}else{$(".bodybgmask").removeClass("blur")}setTimeout(function(){$(".jbolt_formbox").addClass("show");$(".jbolt_title").addClass("show")},300)}var Select2Util={init:function(a){this.initNotAutoLoadSelect(a)},initNotAutoLoadSelect:function(c){if(hasImportSelect2){var b=getRealJqueryObject(c);if(!isOk(b)){return false}var a=b.find("select[data-select2]:not([data-autoload]):not([data-linkage])");if(!isOk(a)){return false}a.select2()}},initAutoLoadSelect:function(a){if(hasImportSelect2){var b=a.data("select-type");if(b&&b=="select2"){var c=a.data("placeholder");if(!c){c=a.attr("placeholder");if(!c){c=a.data("text");if(!c){c="请选择"}}}a.select2({theme:"bootstrap",allowClear:true,placeholder:c})}}}};function checkImportSelect2(){var a=$("script[src*='select2']");return(a&&a.length==1)}function processGlobalSelect2(){hasImportSelect2=checkImportSelect2();if(hasImportSelect2){$.fn.modal.Constructor.prototype.enforceFocus=function(){};$.fn.select2.defaults.set("width","100%");$.fn.select2.defaults.set("theme","bootstrap")}}function initAjaxPortal(c){var a;if(c){var b=getRealJqueryObject(c);if(isOk(b)){a=b.find("[data-ajaxportal]")}}else{a=jboltBody.find("[data-ajaxportal]")}if(a&&a.length>0){a.ajaxPortal(true)}}function processImgviewerEvent(){jboltBody.on("click",".viewer-canvas",function(a){if($(a.target).hasClass("viewer-canvas")){$(".viewer-close").trigger("click")}})}$.getMultiScripts=function(a,c){var b=$.map(a,function(d){return $.ajax({async:false,dataType:"script",url:((c||"")+d)})});b.push($.Deferred(function(d){$(d.resolve)
}));return $.when.apply($,b)};function initJboltAdmin(){initAdminLeftNav();processGlobalSelect2();TableUtil.init();PageOptUtil.init();toggleMenuEvent();JBoltLayerUtil.init();MasterSlaveUtil.initMasterTableEvent();processImgviewerEvent();initJboltAdminTopStyleChange();LayerPhotoUtil.init();initBootstrapTab();initAjaxPortalContextMenu();initJuicer();initImgError();initJboltBodyClick();FormChecker.init();DownloadUtil.init();JBoltTablinkBoxUtil.init()}function initAjaxPortalContextMenu(){jboltBody.on("contextmenu","[data-ajaxportal][data-refresh]",function(c){c.preventDefault();c.stopPropagation();var a=$(this);var d=getMousePos(c);var b=a.find(".jbolt_ajaxportal_menu");if(!isOk(b)){b=$('<div class="dropdown-menu jbolt_ajaxportal_menu"><a class="dropdown-item" data-func="refresh" href="javascript:void(0)"><i class="fa fa-refresh mr-1"></i>刷新此区域</a></div>');a.append(b)}b.css({top:d.y,left:d.x});b.show();return false}).on("click",function(){$(".jbolt_ajaxportal_menu").hide()})}function initJboltBodyClick(){jboltBody.on("click",function(){JBoltInputUtil.hideJBoltInputLayer()})}function initImgError(){}var date_ymdhm=function(a){return new Date(a).Format("yyyy-MM-dd hh:mm")};var date_ymdhms=function(a){return new Date(a).Format("yyyy-MM-dd hh:mm:ss")};var date_ymd=function(a){return new Date(a).Format("yyyy-MM-dd")};var date_ym=function(a){return new Date(a).Format("yyyy-MM")};var date=function(b,a){return new Date(b).Format(a)};var jbolt_default_img_url="assets/img/uploadimg.png";var real_image=function(a){if(!a){return jbolt_default_img_url}if(JBOLT_BASE_UPLOAD_PATH_PRE&&a.indexOf(JBOLT_BASE_UPLOAD_PATH_PRE)!=-1){a=a.replace(JBOLT_BASE_UPLOAD_PATH_PRE,"")}return actionUrl(a)};function initJuicer(){juicer.register("date",date);juicer.register("date_ym",date_ym);juicer.register("date_ymd",date_ymd);juicer.register("date_ymdhm",date_ymdhm);juicer.register("date_ymdhms",date_ymdhms);juicer.register("real_image",real_image);juicer.register("real_url",real_image);if(window.initMineJuicer){initMineJuicer()}}function initBootstrapTab(){jboltBody.on("click",".nav-tabs a.nav-link",function(a){a.preventDefault();a.stopPropagation();$(this).tab("show");return false})}function isHasPjax(){var a=$("#pjaxScript");return a&&a.length==1}var MultipleFileInputUtil={init:function(c){var b=getRealJqueryObject(c);if(!isOk(b)){return false}var a=b.find("[data-multiplefileinput]");if(!isOk(a)){return false}this.initInputs(a)},initInputs:function(a){if(!isOk(a)){return false}var b=this;loadJBoltPlugin(["fileinput"],function(){var c=a.length;for(var d=0;d<c;d++){b.initInput(a.eq(d),false)}})},processHandler:function(input,handler,res){var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler(input,res)}},changeSyncInputFiles:function(d,c){var f;for(var e in multipleUploadFiles){if(multipleUploadFiles[e]["key"]==d){for(var b in c){multipleUploadFiles[e]["value"].push(c[b])}f=multipleUploadFiles[e]["value"];break}}if(f){return f}var a=new Array();var h={"key":d,"value":c};multipleUploadFiles.push(h);return h["value"]},clearInputFiles:function(a){for(var b in multipleUploadFiles){if(multipleUploadFiles[b]["key"]==a){multipleUploadFiles[b]["value"]=[];break}}},findInputFiles:function(b){if(multipleUploadFiles.length==0){var a=new Array();var e={"key":b,"value":a};multipleUploadFiles.push(e);return e["value"]}else{var d;for(var c in multipleUploadFiles){if(multipleUploadFiles[c]["key"]==b){d=multipleUploadFiles[c]["value"];break}}if(d){return d}var a=new Array();var e={"key":b,"value":a};multipleUploadFiles.push(e);return e["value"]}},setValueTo:function(h,c){var b=this;var e=h.data("setvalueto");if(!e){return false}var k=h.attr("id");var f=h.data("sync");var l=null;if(f){l=b.changeSyncInputFiles(k,c.data)}else{l=b.findInputFiles(k);l.push(c.data)}if(l&&l.length>0){var d=new Array();for(var a in l){d.push(l[a].url)}var j=d.join(",");$("#"+e).val(j)}},processRemoveSetValueTo:function(j,a){var c=this;var f=j.data("setvalueto");if(!f){return false}var k=j.attr("id");var h=j.data("sync");var l=c.findInputFiles(k);if(l&&l.length>0){var d=0;for(var b in l){d=a.indexOf((h?"_":"-")+l[b].fileId);if(d!=-1){l.splice(b,1)}}if(l.length>0){var e=new Array();for(var b in l){e.push(l[b].url)}$("#"+f).val(e.join(","))}else{$("#"+f).val("")}}},processFileclearedSetValueTo:function(c){var d=this;var a=c.data("setvalueto");if(!a){return false}var b=c.attr("id");$("#"+a).val("");d.clearInputFiles(b)},initEvent:function(a){var e=this;var c=a.data("handler");if(c){var d=a.data("sync");if(d){a.on("filebatchuploadsuccess",function(i,j,f,h){if(c=="setValueTo"){e.setValueTo(a,j.response)}else{e.processHandler(a,c,j.response)}})}else{a.on("fileuploaded",function(i,j,f,h){if(c=="setValueTo"){e.setValueTo(a,j.response)}else{e.processHandler(a,c,j.response)}})}}a.on("filesuccessremove",function(h,i){if(c&&c=="setValueTo"){e.processRemoveSetValueTo(a,i)}var f=a.data("filesuccessremove");if(f){e.processHandler(a,f,i)}});a.on("fileremoved",function(h,i){if(c&&c=="setValueTo"){e.processRemoveSetValueTo(a,i)
}var f=a.data("fileremoved");if(f){e.processHandler(a,f,i)}});a.on("filecleared",function(h){if(c&&c=="setValueTo"){e.processFileclearedSetValueTo(a)}var f=a.data("filecleared");if(f){e.processHandler(a,f)}});var b=a.data("extrahandler");if(b){e.processHandler(a,b)}},_initInput:function(a,d,c){if(d&&d.length==1){var b=a.clone();d.before(b);d.remove();b.fileinput(c);this.initEvent(b)}else{a.fileinput(c);this.initEvent(a)}},initInput:function(l,a){var h=this;var c=l.data("choosebtntext");if(!c){c="请选择"}var i=l.data("max-filecount");if(!i){i=9}var d=l.data("max-filesize");if(!d){d=200}var e=l.data("theme");if(!e){e="fa"}var k=l.data("sync");var f=true;if(k){f=false}var j=l.data("uploadurl");if(!j){LayerMsgBox.alert("请设置多文件组件上传地址：data-uploadurl",2)}var n={enctype:"multipart/form-data",previewFileType:"image",theme:e,uploadAsync:f,allowedPreviewTypes:["image"],uploadUrl:j,maxFileCount:i,maxFileSize:d,showSort:true,showCaption:false,showCancel:false,language:"zh",browseClass:"btn btn-success",browseLabel:c,removeClass:"btn btn-danger",removeLabel:"清空",uploadClass:"btn btn-info",uploadLabel:"全部上传",fileActionSettings:{showRemove:true,showUpload:false,showDownload:false,showZoom:true,showDrag:true,}};var m=l.attr("id");var b=l.closest(".file-input");if(a){loadJBoltPlugin(["fileinput"],function(){h._initInput(l,b,n)})}else{this._initInput(l,b,n)}}};var JBoltTreeTableUtil={init:function(c){var b=getRealJqueryObject(c);if(!isOk(b)){return false}var a=b.find("[data-jbolttreetable]");if(!isOk(a)){return false}this.initTables(a)},initTables:function(a){if(!isOk(a)){return false}var b=this;loadJBoltPlugin("jbolttable",function(){var c=a.length;for(var d=0;d<c;d++){b.initTable(a.eq(d),false)}})},initTable:function(b,c){var a=this;if(c){loadJBoltPlugin("jbolttable",function(){a._initTable(b)})}else{this._initTable(b)}},_initTable:function(a){a.jboltTreeTable()}};var JBoltTableUtil={init:function(c){var b=getRealJqueryObject(c);if(!isOk(b)){return false}var a=b.find("[data-jbolttable]:not([data-jbolttreetable])");if(!isOk(a)){return false}this.initTables(a)},initTables:function(a){if(!isOk(a)){return false}var b=this;loadJBoltPlugin("jbolttable",function(){var c=a.length;for(var d=0;d<c;d++){b.initTable(a.eq(d),false)}})},initTable:function(b,c){var a=this;if(c){loadJBoltPlugin("jbolttable",function(){a._initTable(b)})}else{this._initTable(b)}},_initTable:function(a){a.jboltTable()}};$(function(){var a=isHasPjax();var c=isWithtabs();initJboltAdmin();if(needPjax&&a){if(c){JBoltTabUtil.init();JBoltTabUtil.addJboltTabWithoutContentUrl();var b=JBoltTabUtil.getCurrentTabContent();if(b&&b.length==1){afterAjaxPortal(b)}initAdminAjaxPortalFormSubmitEvent()}else{initAdminPjax()}}else{if(c){JBoltTabUtil.init();initAdminAjaxPortalFormSubmitEvent()}SelectUtil.initAutoSetValue();JAtomFileUploadUtil.init();JAtomImgUploader.init();SwitchBtnUtil.init();FormDate.init();LayerTipsUtil.init();HtmlEditorUtil.init();ImageViewerUtil.init();AutocompleteUtil.init();RadioUtil.init();CheckboxUtil.init();Select2Util.init();SelectUtil.init();MultipleFileInputUtil.init();initAjaxPortal();JSTreeUtil.init();JBoltInputUtil.init();initToolTip();initPopover();JBoltTableUtil.init();JBoltTreeTableUtil.init();findRequiredAndStarIt()}onwindowReisze()});function findRequiredAndStarIt(k){if(!autoShowRequiredLabelStar){return false}var j=getRealJqueryObject(k);if(!isOk(j)){return false}var d="[data-rule]:not([data-notnull='false']):not([type='hidden']):not([data-radio])";var e=j.find(d);if(isOk(e)){var i,b,h,c,f,a;e.each(function(l){i=e.eq(l);if(i[0].hasAttribute("data-checkbox")){c=i.find("label:first");if(c.parent().hasClass("checkbox")==false){c.addClass("is_required")}}else{b=i.closest(".form-group");if(isOk(b)){h=b.find("label");if(isOk(h)){a=i.prev();if(isOk(a)){if(a[0].tagName=="LABEL"){c=a}}else{f=i.parent();if(f[0].tagName=="DIV"){if(f.hasClass("input-group")){c=b.find("label:first")}else{var m=f.prev();if(m[0].tagName=="LABEL"){c=m}}}}if(isOk(c)){c.addClass("is_required")}}}}})}}function refreshCurrentAjaxPortal(b){var a=b.closest("[data-ajaxportal]");if(isOk(a)){a.ajaxPortal(true)}}function showReloginDialog(){if(self!=top){parent.showReloginDialog()}else{layer.closeAll();DialogUtil.openNewDialog({title:"请重新登录",width:"500",height:"400",url:"admin/relogin",handler:refreshPjaxContainer});LayerMsgBox.error("当前登录已经失效，请重新登录系统!",2000)}}(function(n,p,u){var w=n([]),s=n.resize=n.extend(n.resize,{}),o,l="setTimeout",m="resize",t=m+"-special-event",v="delay",r="throttleWindow";s[v]=350;s[r]=true;n.event.special[m]={setup:function(){if(!s[r]&&this[l]){return false}var a=n(this);w=w.add(a);n.data(this,t,{w:a.width(),h:a.height()});if(w.length===1){q()}},teardown:function(){if(!s[r]&&this[l]){return false}var a=n(this);w=w.not(a);a.removeData(t);if(!w.length){clearTimeout(o)}},add:function(b){if(!s[r]&&this[l]){return false}var c;function a(d,i,h){var f=n(this),e=n.data(this,t);e.w=i!==u?i:f.width();e.h=h!==u?h:f.height();c.apply(this,arguments)}if(n.isFunction(b)){c=b;
return a}else{c=b.handler;b.handler=a}}};function q(){o=p[l](function(){w.each(function(){var d=n(this),a=d.width(),b=d.height(),c=n.data(this,t);if(a!==c.w||b!==c.h){d.trigger(m,[c.w=a,c.h=b])}});q()},s[v])}})(jQuery,this);