var jbolt_table_js_version="0.5.4";function checkTableBodyHasScrolled(a,b){if(b=="v"){return parseInt(a.outerHeight()-a.thead.height)>parseInt(a.table_body.outerHeight())}else{if(b=="h"){return parseInt(a.outerWidth())>parseInt(a.table_body.outerWidth())}}}function jboltTableIsCheckedAll(c){var b=getRealJboltTableByEle(c);if(isOk(b)){var a=b.jboltTable("inst");return a.me.isCheckboxCheckedAll(a)}return false}function removeJBoltTableCheckedTr(c){var b=getRealJboltTableByEle(c);if(isOk(b)){var a=b.jboltTable("inst");a.me.removeJBoltTableCheckedTr(a)}}function jboltTableGetCheckedId(c){var b=getRealJboltTableByEle(c);if(isOk(b)){var a=b.jboltTable("inst");return a.me.getCheckedId(a)}LayerMsgBox.alert("表格组件配置异常",2);return false}function jboltTableGetCheckedIds(c){var b=getRealJboltTableByEle(c);if(isOk(b)){var a=b.jboltTable("inst");return a.me.getCheckedIds(a)}LayerMsgBox.alert("表格组件配置异常",2);return false}function getJboltTableCheckedIds(c){var b;if(c){b=$("#"+c)}else{b=jboltBody.find(".jbolt_table_view>.jbolt_table_box>.jbolt_table_body>table[data-jbolttable].jbolt_main_table")}if(isOk(b)){var a=b.jboltTable("inst");return a.me.getCheckedIds(a,true)}return false}function jboltTableIsCheckedNone(c){var b=getRealJboltTableByEle(c);if(isOk(b)){var a=b.jboltTable("inst");return a.me.isCheckedNone(a)}return false}function getRealJboltTableByEle(d){var c=getRealJqueryObject(d);var b;if(isOk(c)){var a=c.data("jbolt-table-id");if(a){b=$("#"+a)}else{b=c.closest(".jbolt_table_view").find(".jbolt_table_box>.jbolt_table_body>table[data-jbolttable].jbolt_main_table")}}return b}function jboltTableGetCheckedCount(c){var b=getRealJboltTableByEle(c);if(isOk(b)){var a=b.jboltTable("inst");return a.me.getCheckedCount(a)}return 0}function resetJBolttableSlaveBox(o){var i=o.closest(".jbolttable_master_slave_box");if(!isOk(i)){return false}var c=o.closest(".split.master");if(!isOk(c)){return false}var b=0;var j=i.find(".split.slave");if(!isOk(j)){return false}var p=j.find(".jbolt_main_table");LayerMsgBox.load(3);if(isOk(p)){var k,f,e;p.each(function(){k=$(this).jboltTable("inst");f=k.data("orign-url")||k.data("srcurl");e=f.replace("[masterId]",b);k.data("url",e).data("data-url",e);k.me.readByPage(k,1)})}var h=j.find("[data-ajaxportal]");if(isOk(h)){var m,n,a;h.each(function(){n=$(this);m=n.data("orign-url")||n.data("srcurl");a=m.replace("[masterId]",b);n.ajaxPortal(true,a,true)})}var l,d;j.find("[data-url][data-orign-url],[href][data-orign-url],[data-url][data-srcurl],[href][data-srcurl]").each(function(){l=$(this);d=l.data("orign-url")||l.data("srcurl");if(d.indexOf("[masterId]")!=-1){d=d.replace("[masterId]",b);if(l.data("url")){l.data("url",d).attr("data-url",d)}if(l.attr("href")){l.attr("href",d)}}})}function masterTableTrTriggerShowSlave(q,b){var m=$(q);var h=m.closest(".jbolttable_master_slave_box");if(!isOk(h)){return false}var o=m.closest(".jbolt_main_table");o.find("tbody>tr.active").removeClass("active");m.addClass("active");var i=h.find(".split.slave");if(!isOk(i)){return false}var p=i.find(".jbolt_main_table");LayerMsgBox.load(3);if(isOk(p)){var j,e,d;p.each(function(){j=$(this).jboltTable("inst");e=j.data("orign-url")||j.data("srcurl");d=e.replace("[masterId]",b);j.data("url",d).data("data-url",d);j.me.readByPage(j,1)})}var f=i.find("[data-ajaxportal]");if(isOk(f)){var l,n,a;f.each(function(){n=$(this);l=n.data("orign-url")||n.data("srcurl");a=l.replace("[masterId]",b);n.ajaxPortal(true,a,true)})}var k,c;i.find("[data-url][data-orign-url],[href][data-orign-url],[data-url][data-srcurl],[href][data-srcurl]").each(function(){k=$(this);c=k.data("orign-url")||k.data("srcurl");if(c.indexOf("[masterId]")!=-1){c=c.replace("[masterId]",b);if(k.data("url")){k.data("url",c).attr("data-url",c)}if(k.attr("href")){k.attr("href",c)}}})}function moveDownTreeTableRow(h,i){var c=i.next();if(!isOk(c)){return false}var d=i.closest("tbody");var b=new Array();processTreeTableTrAllNodes(b,d,i);var e=(b.length==1)?i:b[b.length-1];c=e.next();if(!isOk(c)){return false}var f=new Array();processTreeTableTrAllNodes(f,d,c);var a=(f.length==1)?c:f[f.length-1];trChangeToDown(b,a)}function moveUpTreeTableRow(h,i){var f=i.prev();if(!isOk(f)){return false}var e=f.data("id");var a=i.data("pid");if(e==a){return false}var b=i.prevAll("[data-pid='"+a+"']:first");if(isOk(b)){var c=i.closest("tbody");var d=new Array();processTreeTableTrAllNodes(d,c,i);trChangeToUp(d,b)}}function processTreeTableTrAllNodes(e,b,f){e.push(f);var a=f[0].hasAttribute("data-parent");if(a){var h=b.find("tr[data-pid='"+f.data("id")+"']");if(isOk(h)){var d=h.length;for(var c=0;c<d;c++){processTreeTableTrAllNodes(e,b,h.eq(c))}}}}function deleteTreeTableRow(l,h){var d=h[0].hasAttribute("data-parent");var f=h[0].hasAttribute("data-son");var c=h.closest("tbody");if(d){var k=c.find("tr[data-pid='"+h.data("id")+"']");if(isOk(k)){var m=k.length;for(var b=0;b<m;b++){deleteTreeTableRow(l,k.eq(b))}}}h.remove();if(f){var e=h.data("pid");if(e){var j=c.find("tr[data-pid='"+e+"']");if(!isOk(j)){var a=c.find("tr[data-id='"+e+"']");
if(isOk(a)){a.removeAttr("data-parent");a.find("td[data-parent-td='true']").removeAttr("data-parent-td").find("i.fa.parent_flag").remove()}}}}}function refreshJBoltTable(d){var c=d.data("jbolt-table-id");var b;if(c){b=$("#"+c)}else{b=d.closest(".jbolt_table_view").find(".jbolt_table_box>.jbolt_table_body>table[data-jbolttable].jbolt_main_table")}if(isOk(b)){var a=b.jboltTable("inst");a.me.refresh(a)}}function refreshJBoltTableById(c){var b=$("#"+c);if(isOk(b)){var a=b.jboltTable("inst");a.me.refresh(a)}}function jboltTablePageToFirst(d){var c=d.data("jbolt-table-id");var b;if(c){b=$("#"+c)}else{b=d.closest(".jbolt_table_view").find(".jbolt_table_box>.jbolt_table_body:first>table")}if(isOk(b)){var a=b.jboltTable("inst");a.me.jboltTablePageToFirst(a)}}function jboltTablePageToLast(d){var c=d.data("jbolt-table-id");var b;if(c){b=$("#"+c)}else{b=d.closest(".jbolt_table_view").find(".jbolt_table_box>.jbolt_table_body:first>table")}if(isOk(b)){var a=b.jboltTable("inst");a.me.jboltTablePageToLast(a)}}function getScrollBarWidth(a){return Math.abs(a.offsetWidth-a.clientWidth)}function getScrollBarHeight(a){return Math.abs(a.offsetHeight-a.clientHeight)}(function(f){var i={};var d="<!--JBoltTable 分页-->"+'<div class="jbolt_table_pages noselect">'+'<div class="pages">'+'<div class="mainPagination" id="${pageId}"></div>'+'<div class="searchPage">'+'<span class="page-go pl-3">到<input id="gonu" type="number" onblur="if(this.value&&this.value>=1){}else{this.value=1;}" min="1" max="1"  pattern="[0-9]*" class="current_page" value="1">页</span>'+'<a href="javascript:;" class="page-btn">GO</a>'+'<span class="page-sum">共&nbsp;<strong id="totalRow" class="allPage">1</strong>&nbsp;条&nbsp;<strong id="totalPage" class="allPage">1</strong>&nbsp;页</span>'+'<select id="pageSize" class="mx-2" style="width:80px;height: 32px;margin-top:-1px;border-color:#e6e6e6;">'+'<option value="5">5条/页</option>'+'<option value="10">10条/页</option>'+'<option value="15">15条/页</option>'+'<option value="20">20条/页</option>'+'<option value="25">25条/页</option>'+'<option value="30">30条/页</option>'+'<option value="35">35条/页</option>'+'<option value="40">40条/页</option>'+'<option value="45">45条/页</option>'+'<option value="50">50条/页</option>'+"</select>"+"</div>"+"</div>"+'<div class="clearfix"></div>'+"</div>";var c='<span class="jbolt_table_col_sort"><i class="sort sort_asc" title="升序"></i><i class="sort sort_desc" title="降序"></i><span>';var b='<span class="jbolt_table_col_sort"><i class="sort sort_asc active" title="升序"></i><i class="sort sort_desc" title="降序"></i><span>';var e='<span class="jbolt_table_col_sort"><i class="sort sort_asc" title="升序"></i><i class="sort sort_desc active" title="降序"></i><span>';var a={"th_checkbox":'<th data-width="50" style="min-width:50px;max-width:50px;width:50px;" data-column="checkbox"><div class="jbolt_table_checkbox"><input type="checkbox" name="jboltTableCheckbox" data-ptype="thead"><span><i class="fa fa-check"></i></span></div></th>',"td_checkbox":'<td style="min-width:50px;max-width:50px;width:50px;"><div class="jbolt_table_checkbox"><input type="checkbox" name="jboltTableCheckbox" data-ptype="tbody"><span><i class="fa fa-check"></i></span></div></td>',"th_radio":'<th data-width="50"  style="min-width:50px;max-width:50px;width:50px;" data-column="radio"><div class="jbolt_table_radio"><input type="radio" name="jboltTableRadio" data-ptype="thead"><span><i class="fa fa-check"></i></span></div></th>',"td_radio":'<td data-width="50"  style="min-width:50px;max-width:50px;width:50px;"><div class="jbolt_table_radio"><input type="radio" name="jboltTableRadio" data-ptype="tbody"><span><i class="fa fa-check"></i></span></div></td>'};var h={resize:function(j){this.setTableHeight(j)},removeJBoltTableCheckedTr:function(m){var l=this;var k=m.data("column-prepend");if(!k){k="checkbox"}if(k=="checkbox"||k.indexOf(":checkbox")){var n=m.tbody.find("input[type='checkbox'][name='jboltTableCheckbox']:checked");if(isOk(n)){n.each(function(o){l.deleteRow(m,n.eq(o).closest("tr").index())})}}else{if(k=="radio"||k.indexOf(":radio")){var j=m.tbody.find("tr>td>input[type='radio'][name='jboltTableRadio']:checked");if(isOk(j)){j.each(function(o){l.deleteRow(m,j.eq(o).closest("tr").index())})}}}},getCheckedCount:function(l){var k=this;var j=l.data("column-prepend");if(!j){j="checkbox"}if(j=="checkbox"||j.indexOf(":checkbox")){return k.getCheckboxCheckedCount(l)}if(j=="radio"||j.indexOf(":radio")){return k.getRadioCheckedCount(l)}},isCheckedNone:function(l){var k=this;var j=l.data("column-prepend");if(!j){j="checkbox"}if(j=="checkbox"||j.indexOf(":checkbox")){return k.isCheckboxCheckedNone(l)}if(j=="radio"||j.indexOf(":radio")){return k.isRadioCheckedNone(l)}},getCheckedIds:function(m,n){var k=m.data("column-prepend");if(!k){k="checkbox"}var l=new Array();if(k=="checkbox"||k.indexOf(":checkbox")){var o=m.tbody.find("input[type='checkbox'][name='jboltTableCheckbox']:checked");if(!isOk(o)||o.length==0){if(!n){LayerMsgBox.alert("请至少选择一行数据",2)}return false}o.each(function(p){l.push(o.eq(p).closest("tr").data("id"))
})}else{if(k=="radio"||k.indexOf(":radio")){var j=m.tbody.find("tr>td>input[type='radio'][name='jboltTableRadio']:checked");if(!isOk(j)||j.length==0){if(!n){LayerMsgBox.alert("请至少选择一行数据",2)}return false}j.each(function(p){l.push(j.eq(p).closest("tr").data("id"))})}}return isOk(l)?l:false},getCheckedId:function(l){var k=l.data("column-prepend");if(!k){k="checkbox"}var n;if(k=="checkbox"||k.indexOf(":checkbox")){var m=l.tbody.find("input[type='checkbox'][name='jboltTableCheckbox']:checked");if(!isOk(m)||m.length!=1){LayerMsgBox.alert("请选择一行数据",2);return false}n=m.eq(0).closest("tr").data("id")}else{if(k=="radio"||k.indexOf(":radio")){var j=l.tbody.find("tr>td>input[type='radio'][name='jboltTableRadio']:checked");if(!isOk(j)||j.length!=1){LayerMsgBox.alert("请选择一行数据",2);return false}n=j.eq(0).closest("tr").data("id")}}return n?n:false},deleteRow:function(l,j){var k=this;var m=l.data("ajax");if(m){l.find("tbody>tr:nth-child("+(j+1)+")").remove();if(l.left_fixed){l.left_fixed.body.table.find("tbody>tr:nth-child("+(j+1)+")").remove()}if(l.right_fixed){l.right_fixed.body.table.find("tbody>tr:nth-child("+(j+1)+")").remove()}k.refreshMainTableVScroll(l);k.refreshFixedColumnHScroll(l)}else{l.find("tbody>tr:nth-child("+(j+1)+")").remove();if(l.left_fixed){l.left_fixed.body.table.find("tbody>tr:nth-child("+(j+1)+")").remove()}if(l.right_fixed){l.right_fixed.body.table.find("tbody>tr:nth-child("+(j+1)+")").remove()}k.refreshMainTableVScroll(l);k.refreshFixedColumnHScroll(l)}k.processOneAutoThWidthByTrChange(l)},moveUpRow:function(n,m){var l=new Array();var o=n.find("tbody>tr:eq("+m+")");if(isOk(o)){trChangeToUp(o,o.prev());if(n.left_fixed){var j=n.left_fixed.body.table.find("tbody>tr:eq("+m+")");if(isOk(j)){trChangeToUp(j,j.prev())}}if(n.right_fixed){var k=n.right_fixed.body.table.find("tbody>tr:eq("+m+")");if(isOk(k)){trChangeToUp(k,k.prev())}}}},moveDownRow:function(n,m){var l=new Array();var o=n.find("tbody>tr:eq("+m+")");if(isOk(o)){trChangeToDown(o,o.next());if(n.left_fixed){var j=n.left_fixed.body.table.find("tbody>tr:eq("+m+")");if(isOk(j)){trChangeToDown(j,j.next())}}if(n.right_fixed){var k=n.right_fixed.body.table.find("tbody>tr:eq("+m+")");if(isOk(k)){trChangeToDown(k,k.next())}}}},inst:function(j){if(!j&&this.hasClass("jbolt_table")){j=this.attr("id")}return i[j]},put:function(k,j){i[k]=j},processBindEleTableId:function(k){var j=k.attr("id");var l=k.data("bind-elements");if(l){f(l).data("jbolt-table-id",j).attr("data-jbolt-table-id",j)}if(isOk(k.toolbar)){k.toolbar.find("button,a").data("jbolt-table-id",j).attr("data-jbolt-table-id",j)}},checkTableThead:function(l){var m=l.find("thead");if(!isOk(m)){return"Table表格不能缺少thead"}var j=m.find("tr");if(!isOk(j)){return"Table表格Thead中必须有tr"}var k=m.find("tr>th");if(!isOk(k)){LayerMsgBox.alert("Table表格Thead中必须有th",2);return false}},init:function(j){var k=this;LayerMsgBox.load(3,15000);return j.each(function(){var y=f(this);var o=y.attr("id");if(!o){o="jbolt_table_"+randomId();y.attr("id",o)}else{var p=k.inst(o);if(p){LayerMsgBox.closeLoadNow();return true}}var r=k.checkTableThead(y);if(r){LayerMsgBox.alert(r,2);return false}y.thead=y.find("thead");y.tbody=y.find("tbody");if(!isOk(y.tbody)){y.append("<tbody></tbody>");y.tbody=y.find("tbody")}y.tfoot=y.find("tfoot");y.thead.trs=y.thead.find("tr");y.thead.height=41*y.thead.trs.length;y.removeClass("table table-bordered table-hover table-striped table-dark table-borderless table-sm table-primary table-secondary table-success table-danger table-warning table-info table-light");y.addClass("jbolt_table text-nowrap novscroll jbolt_main_table");var q=y.parent();if(q.hasClass("table-responsive")){q.removeClass("table-responsive").addClass("jbolt_table_body")}var x=y.closest(".jbolt_table_body");if(!isOk(x)){y.wrap("<div class='jbolt_table_body'></div>");x=y.closest(".jbolt_table_body")}var l=x.closest(".jbolt_table_box");if(!isOk(l)){x.wrap("<div class='jbolt_table_box'></div>");l=x.closest(".jbolt_table_box")}var m=l.closest(".jbolt_table_view");if(!isOk(m)){l.wrap("<div class='jbolt_table_view'></div>");m=l.closest(".jbolt_table_view")}var w=m.find(".jbolt_table_toolbar");if(!isOk(w)){var u=y.data("toolbar");if(u){var n=m.closest("[data-ajaxportal]");if(!isOk(n)){if(isWithtabs()){n=JBoltTabUtil.getCurrentTabContent()}else{n=mainPjaxContainer;var t=!(n&&n.length==1);if(t){n=f("body .jbolt_page");var s=!(n&&n.length==1);if(s){n=jboltBody}}}}if(isOk(n)){w=n.find("#"+u)}else{w=f("#"+u)}}if(isOk(w)){w.insertBefore(l)}}if(y.hasClass("border-dark")){m.addClass("border-dark");l.addClass("border-dark");x.addClass("border-dark");if(isOk(w)){w.addClass("border-dark")}}else{if(y.hasClass("border-secondary")){m.addClass("border-secondary");l.addClass("border-secondary");x.addClass("border-secondary");if(isOk(w)){w.addClass("border-secondary")}}else{if(y.hasClass("border-gray")){m.addClass("border-gray");l.addClass("border-gray");x.addClass("border-gray");if(isOk(w)){w.addClass("border-gray")}}}}y.table_view=m;y.table_box=l;y.table_body=x;y.toolbar=w;
y.me=k;k.put(o,y);var v=y.data("ajax");if(v){k.processTableMainBeforeAjax(y);k.ajaxLoadTableData(y,function(){k.reProcessTableMain(y);y.data("inited",true)})}else{k.processTableMain(y);y.data("inited",true)}})},processPagesToJboltPage:function(o){var j=o.table_view.find(".pages"),p;if(isOk(j)){p=j.closest(".jbolt_table_pages");if(!isOk(p)){j.attr("class","pages").wrap('<div class="jbolt_table_pages noselect"></div>')}}else{var m=o.data("page");if(m){j=o.closest(".jbolt_page").find("#"+m).closest(".pages")}else{j=o.table_view.parent().find(".pages")}if(isOk(j)){p=j.closest(".jbolt_table_pages");if(!isOk(p)){j.attr("class","pages").wrap('<div class="jbolt_table_pages noselect"></div>');p=j.closest(".jbolt_table_pages")}p.insertAfter(o.table_box)}}if(isOk(p)){var l=p.find("#gonu");if(isOk(l)){pageNumber=Math.abs(parseInt(l.val()))}else{pageNumber=1}var k=Math.abs(parseInt(p.find("#pageSize").val()));var n=Math.abs(parseInt(p.find("#totalPage").text()));o.data("pagenumber",pageNumber);o.data("pagesize",k);o.data("totalpage",n)}},getColumnPrependElement:function(k,j){return a[j+"_"+k]},getTbodyColumnPrependElement:function(k){var j="";switch(k){case"checkbox":retult="<td><input type='checkbox' data-type='tbody_checkbox'/></td>";break;case"radio":retult="<td><input type='radio' data-type='tbody_radio'/></td>";break}return j},processTableColumnPrepend:function(j){this.processTableTheadColumnPrepend(j);this.processTableTbodyColumnPrepend(j)},processTableTbodyColumnPrepend:function(k){var j=k.data("column-prepend");if(!j||!k.prependColumnType){return false}var l=k.find("tbody>tr>td:nth-child("+(k.prependColumnIndex+1)+")");if(isOk(l)){l.before(this.getColumnPrependElement(k.prependColumnType,"td"))}},processTableTheadColumnPrepend:function(p){var k=p.data("column-prepend");if(!k){return false}var o=this,m=0,l;if(k.indexOf(":")!=-1){var j=k.split(":");m=parseInt(j[0])-1;l=j[1]}else{l=k}var n=p.find("thead>tr:first>th:eq("+m+")");if(isOk(n)){n.before(this.getColumnPrependElement(l,"th"));p.prependColumnIndex=m;p.prependColumnType=l}},processTableMain:function(k){var j=this;j.processPagesToJboltPage(k);j.processTableHeaderColSort(k);j.processTableColumnPrepend(k);j.processTableColIndex(k,true,true);j.processTableWidthAndHeight(k);j.processTableStyle(k);j.processConditionsForm(k);j.processOtherTableBindTableId(k);j.processBindEleTableId(k);j.afterFixedColumn(k);j.processTableEvent(k);LayerMsgBox.closeLoadNow()},reProcessTableHeaderColDefaultSort:function(r){var o=r.find("thead");var p=r.data("sortable-columns");if(!p){return false}var l=r.data("sort");var j,k,n,l=r.data("sort");if(l){var q=l.split(":");k=q[0];n=q[1]}r.table_view.find(".jbolt_table_header>table>thead>tr>th i.sort.active").removeClass("active");j=o.find("tr>th[data-column='"+k+"']");if(isOk(j)){var m=j.data("col-index");r.table_view.find(".jbolt_table_header>table>thead>tr>th[data-col-index='"+m+"']").find(".sort.sort_"+n).addClass("active");j.find(".sort.sort_"+n).addClass("active")}},processTableHeaderColSort:function(t){var q=t.find("thead");var r=t.data("sortable-columns");if(!r){return false}var m=r.split(",");if(!isOk(m)){return false}var p=m.length;var j,k,o,l=t.data("sort");if(l){var s=l.split(":");k=s[0];o=s[1]}for(var n=0;n<p;n++){j=q.find("tr>th[data-column='"+m[n]+"']");if(isOk(j)){j.addClass("sort_col");if(k==m[n]){if(o=="asc"){j.append(b)}else{if(o=="desc"){j.append(e)}}}else{j.append(c)}}}},processTheadColIndex:function(j){this.processTableColIndex(j,true,false)},processTableColIndex:function(y,r,u){var o=this,x=y.find("thead"),j=y.find("tbody"),s=x.find("tr"),n,t,A,m,p;if(!isOk(s)){LayerMsgBox.alert("尚未提供有效的Thead",2);return}t=s.length;n=s.eq(0);if(t==1){A=n.find("th");if(isOk(A)){m=A.length;for(var v=0;v<m;v++){if(r){A.eq(v).data("col-index",v).attr("data-col-index",v)}if(u){j.find("tr>td:nth-child("+(v+1)+")").data("col-index",v).attr("data-col-index",v)}}}return}A=n.find("th");if(isOk(A)){m=A.length;var w=0;var l=0;var q=1;for(var v=0;v<m;v++){p=A.eq(v);if(r){p.data("fixed-col-index",q).attr("data-fixed-col-index",q)}if(p[0].hasAttribute("colspan")){var k=parseInt(p.attr("colspan"));l=w+k-1;var z={trIndex:(n.index()+1),startColIndex:w,endColIndex:l,processBody:u,processHead:r,fixedIndex:q};o.processColSpanNextTrThColIndex(y,x,j,z);if(z.processBody){for(var v=z.startColIndex;v<=z.endColIndex;v++){j.find("tr>td:nth-child("+(v+1)+")").data("col-index",v).attr("data-col-index",v);j.find("tr>td:nth-child("+(v+1)+")").data("fixed-col-index",q).attr("data-fixed-col-index",q)}}w=l+1}else{if(r){p.data("col-index",w).attr("data-col-index",w)}if(u){j.find("tr>td:nth-child("+(w+1)+")").data("col-index",w).attr("data-col-index",w);j.find("tr>td:nth-child("+(w+1)+")").data("fixed-col-index",q).attr("data-fixed-col-index",q)}w=w+1;l=l+1}q++}}},processColSpanNextTrThColIndex:function(s,p,n,l){var o=this,q=p.find("tr:eq("+l.trIndex+")");if(!isOk(q)){return false}var j=q.find("th:not(.processed)");if(!isOk(j)){return false}var k=0,r;for(var m=l.startColIndex;
m<=l.endColIndex;m++){r=j.eq(k);if(r&&r.length==1){if(l.processHead){r.data("fixed-col-index",l.fixedIndex).attr("data-fixed-col-index",l.fixedIndex);r.addClass("processed")}if(r[0].hasAttribute("colspan")){l.trIndex=l.trIndex+1;l.startColIndex=m;o.processColSpanNextTrThColIndex(s,p,n,l);return false}else{if(l.processHead){r.data("col-index",m).attr("data-col-index",m)}k++}}}},processTbodyColIndex:function(j){this.processTableColIndex(j,false,true)},processTableMainBeforeAjax:function(k){var j=this;j.addJboltPageBox(k);j.processTableHeaderColSort(k);j.processTableTheadColumnPrepend(k);j.processTheadColIndex(k);j.processTableWidthAndHeight(k);j.processCellWidthAndHeight(k);j.processHeaderFixed(k);j.processConditionsForm(k);j.processOtherTableBindTableId(k);j.processBindEleTableId(k);j.processTableEvent(k);LayerMsgBox.closeLoadNow()},processOtherTableBindTableId:function(k){var j=k.attr("id");k.table_view.find("table:not(.jbolt_main_table)").data("jbolt-table-id",j)},processConditionsForm:function(k){var j=this;var m=k.data("conditions-form");if(m!=undefined&&m!=""&&m!="undefined"){var l=k.data("ajax");if(l){f("#"+m).on("submit",function(n){n.preventDefault();n.stopPropagation();k.data("sortColumn","").data("sortType","");j.reProcessTableHeaderColDefaultSort(k);j.readByPage(k,1);return false})}}},afterAjaxSetTableDataInitAutoEle:function(j){f(".tooltip.show").remove();SwitchBtnUtil.init(j);SelectUtil.initAutoSetValue(j);FormDate.init(j);LayerTipsUtil.init(j);ImageViewerUtil.init(j);RadioUtil.init(j);CheckboxUtil.init(j);AutocompleteUtil.init(j);Select2Util.init(j);SelectUtil.init({parent:j});initToolTip(j)},afterFixedColumn:function(j){var k=j.table_view.find(".jbolt_table_fixed");if(isOk(k)){SwitchBtnUtil.init(k);SelectUtil.initAutoSetValue(k);FormDate.init(k);LayerTipsUtil.init(k);ImageViewerUtil.init(k);RadioUtil.init(k);CheckboxUtil.init(k);AutocompleteUtil.init(k);Select2Util.init(k);SelectUtil.init({parent:k})}},processAllTableStyleReset:function(k){var l=k.table_body.scrollLeft();var j=k.table_body.scrollTop();k.table_view.find(".jbolt_table_header>table").css("margin-left","0px");k.table_view.find(".jbolt_table_body>table").css("margin-top",(0-k.thead.height)+"px");k.table_body.scrollLeft(l);k.fixed_header.find("table").css("margin-left",(0-l)+"px");if(k.table_body.sortRankAfter){k.table_body.scrollTop(0)}else{if(k.table_body.needKeepScrollTopAndLeft){if(k.table_body.scroll_left>0){k.table_body.scrollLeft(l)}if(k.table_body.scroll_top>0){k.table_body.scrollTop(j)}}else{if(l>0){k.table_body.scrollLeft(0)}if(j>0){k.table_body.scrollTop(0)}}}k.table_body.needKeepScrollTopAndLeft=false;k.table_body.sortRankAfter=false},reProcessTableMain:function(k){var j=this;j.processTbodyColIndex(k);j.processCellWidthAfterAjax(k);j.setTableHeight(k);j.processColumnFixedLeft(k);j.processColumnFixedRight(k);j.processAllTableStyleReset(k);j.processEmptyTableBody(k);j.refreshMainTableVScroll(k);j.refreshFixedColumnHScroll(k);j.afterAjaxSetTableDataInitAutoEle(k.table_view);j.processOtherTableBindTableId(k)},refresh:function(k){if(!k){var j=this.jboltTable("inst");var l=j.data("ajax");if(l){j.me.readByPage(j)}else{j.me.tableSubmitForm(j)}}else{var l=k.data("ajax");if(l){this.readByPage(k)}else{this.tableSubmitForm(k)}}},tableSubmitForm:function(v,t){resetJBolttableSlaveBox(v);var u=v.data("conditions-form");if(!u){f.error("表格data-conditions-form未绑定");return false}var n=null;var o=v.closest("[data-ajaxportal]");if(isOk(o)){n=o}else{var m=isWithtabs();if(m){n=v.closest(".jbolt_tabcontent")}else{n=f(mainPjaxContainer);var q=!(n&&n.length==1);if(q){n=f("body .jbolt_page");var r=!(n&&n.length==1);if(r){n=jboltBody}}}}if(!n){f.error("表格所在页面未规范使用布局");return false}var j=n.find("#"+u);if(isOk(j)){var l=v.table_view.find(".pages");if(isOk(l)){if(!t){t=v.data("pagenumber");if(!t){t=1}}var s=l.find("#pageSize").val();j.append('<input type="hidden" name="page" value="'+t+'"/>');j.append('<input type="hidden" name="pageSize" value="'+s+'"/>')}var k=v.data("sort-column");var p=v.data("sort-type");if(k&&p){j.append('<input type="hidden" name="sortColumn" value="'+k+'"/>');j.append('<input type="hidden" name="sortType" value="'+p+'"/>')}j.submit()}},jboltTablePageToFirst:function(k){if(!k){var j=this.jboltTable("inst");var l=j.data("ajax");if(l){j.me.readByPage(j,1)}else{j.me.tableSubmitForm(j,1)}}else{var l=k.data("ajax");if(l){this.readByPage(k,1)}else{this.tableSubmitForm(k,1)}}},jboltTablePageToLast:function(l){if(!l){var k=this.jboltTable("inst");var j=k.data("totalpage");if(!j){j=1}k.data("tolastpage",true);var m=k.data("ajax");if(m){k.me.readByPage(k,j)}else{k.me.tableSubmitForm(k,j)}}else{var j=l.data("totalpage");if(!j){j=1}l.data("tolastpage",true);var m=l.data("ajax");if(m){this.readByPage(l,j)}else{this.tableSubmitForm(l,j)}}},readByPage:function(u,s){resetJBolttableSlaveBox(u);var o=this;var k=u.table_view.find(".jbolt_table_pages");if(!s){var r=k.find("#gonu");if(isOk(r)){s=Math.abs(parseInt(r.val()))}else{s=1}}var q=Math.abs(parseInt(k.find("#pageSize").val()));
var m=Math.abs(parseInt(k.find("#totalPage").text()));var l=u.data("pagenumber");var p=u.data("page");if(!p||!l){l=1}u.data("pagenumber",s);u.data("pagesize",q);u.data("totalpage",m);var n=u.table_body.scrollLeft();var t=u.table_body.scrollTop();var j=u.data("sort-column");u.table_body.scroll_top=t;u.table_body.scroll_left=n;o.ajaxLoadTableData(u,function(){u.table_body.needKeepScrollTopAndLeft=false;u.table_body.sortRankAfter=false;if(u.table_body.scroll_left||u.table_body.scroll_top){if(l&&l==s){u.table_body.needKeepScrollTopAndLeft=true}if(j){u.table_body.sortRankAfter=true}}o.reProcessTableMain(u)})},addJboltPageBox:function(l){var k=l.data("page");if(!k){return false}var j=juicer(d,{pageId:k});var m=f(j);l.table_box.after(m);return m},initJboltTablePage:function(n,l){var k=n.data("page");if(!k){return false}n.data("totalpage",l.totalPage);var o=n.table_view.find(".jbolt_table_pages");if(!isOk(o)){o=addJboltPageBox(n)}var j=o.find("#"+k);o.find("#gonu").val(l.pageNumber).attr("max",l.totalPage);o.find("#totalPage").text(l.totalPage);o.find("#totalRow").text(l.totalRow);o.find("#pageSize").val(l.pageSize);var m=this;j.pagination(l.totalPage,{num_edge_entries:1,current_page:(l.pageNumber-1),callback:function(p,q){if(isNaN(p)==false){var r=p+1;m.readByPage(n,r);return false}}});if(!n.data("page-ok")){o.find("#gonu").on("keydown",function(p){if(p.keyCode==109||p.keyCode==189){return false}});o.find("#pageSize").on("change",function(){m.readByPage(n,1)});o.find(".page-btn").on("click",function(){m.readByPage(n)})}n.page=o;n.data("page-ok",true)},addRowDatas:function(n,m){var k=n[0].tagName.toLowerCase();var o,l;if(k=="tbody"){o=n;l=n.parent().data("rowtpl")}else{o=n.find("tbody");l=n.data("rowtpl")}var j=g(l).innerHTML;if(m){if(isArray(m)){o.append(juicer(j,{datas:m}));return true}if(m.pageSize&&m.totalRow){o.append(juicer(j,{datas:m.list,pageNumber:m.pageNumber,pageSize:m.pageSize}))}}},addRowData:function(n,m){var k=n[0].tagName.toLowerCase();var o,l;if(k=="tbody"){o=n;l=n.parent().data("rowtpl")}else{o=n.find("tbody");l=n.data("rowtpl")}var j=g(l).innerHTML;o.append(juicer(j,{datas:[m]}))},setTableData:function(l,m){if(l.data("tolastpage")){return false}var k=this;k.addRowDatas(l.tbody,m);k.processTableTbodyColumnPrepend(l);if(m.pageSize){var j={pageNumber:m.pageNumber,pageSize:m.pageSize,totalPage:m.totalPage,totalRow:m.totalRow,firstPage:m.firstPage,lastPage:m.lastPage};k.initJboltTablePage(l,j)}l.jsonData=m},showLoading:function(j){var k=j.table_view.find(".jbolt_table_loading");if(!isOk(k)){k=f('<div class="jbolt_table_loading noselect"><span class="loading_msg"><i class="fa fa-spinner fa-pulse mr-2"></i>数据加载中...</span></div>');j.table_view.append(k)}k.show()},hideLoading:function(j){j.table_view.find(".jbolt_table_loading").hide()},processTheadOldWidth:function(n){var m,k,l,j=n.thead.find("tr>th[data-col-index]");if(isOk(j)){j.each(function(){m=f(this);k=m.outerWidth();l=m.data("min-width")||m.data("width");if(k<l){k=l}m.data("old-width",k).attr("data-old-width",k)})}},ajaxLoadTableData:function(s,r){var n=this;var j=s.data("url");if(!j){LayerMsgBox.alert("请指定表格数据加载地址：data-url属性",2);return false}s.table_view.find(".jbolt_table_fixed").remove();n.processTheadOldWidth(s);n.showLoading(s);var o=s.data("page");if(o){var q=s.data("pagenumber");var p=s.data("pagesize");if(!p){p=10}if(!q){q=1}if(j.indexOf("?")!=-1){j=j+"&page="+q+"&pageSize="+p}else{j=j+"?page="+q+"&pageSize="+p}}var k=s.data("sort-column");var l=s.data("sort-type");if(k&&k){if(j.indexOf("?")!=-1){j=j+"&sortColumn="+k+"&sortType="+l}else{j=j+"?sortColumn="+k+"&sortType="+l}}var m=s.data("conditions-form");if(m!=undefined&&m!=""&&m!="undefined"){Ajax.getWithForm(m,j,function(v){if(s.data("page")){var w=s.data("tolastpage");if(w){s.data("tolastpage",false);s.removeAttr("data-tolastpage");var t=v.data.totalPage;var u=s.data("totalpage");if(t!=u){s.data("pagenumber",v.data.pageNumber);s.data("pagesize",v.data.pageSize);s.data("totalpage",t);n.readByPage(s,t);return true}}}s.tbody.empty();n.setTableData(s,v.data);if(r){r()}n.hideLoading(s)})}else{Ajax.get(j,function(v){if(s.data("page")){var w=s.data("tolastpage");if(w){s.data("tolastpage",false);s.removeAttr("data-tolastpage");var t=v.data.totalPage;var u=s.data("totalpage");if(t!=u){s.data("pagenumber",v.data.pageNumber);s.data("pagesize",v.data.pageSize);s.data("totalpage",t);n.readByPage(s,t);return true}}}s.tbody.empty();n.setTableData(s,v.data);if(r){r()}n.hideLoading(s)})}},processEmptyTableBody:function(l){var k=l.find("tbody");var j=k.find("tr");if(!isOk(j)){k.append('<tr><td colspan="100%" class="text-center"><div class="alert alert-warning d-inline-block px-5 py-1 my-2" style="font-size:16px;"><i class="fa fa-warning mr-1"></i>暂无数据</div></td></tr>');l.table_view.find(".jbolt_table_fixed").hide()}else{l.table_view.find(".jbolt_table_fixed:not(.jbolt_table_fixed_hide)").show()}},processTableWidthAndHeight:function(j){this.initTableDataSet(j);this.setTableWidth(j);this.setTableHeight(j)},initTableDataSet:function(r){var k=r.data("width");
if(!k||(typeof(k)=="string"&&k=="100%")){k="fill";r.data("width","fill").attr("data-width","fill")}var n,j,l;var m=r.thead.find("th[data-col-index][data-width='auto'],th[data-col-index][data-min-width],th[data-col-index]:not([data-width])");var o=isOk(m);r.thead.find("th").each(function(){j=f(this);n=j.data("width");if(!n){l=this.style.width;if(!l){n="auto"}else{if(l.indexOf("px")!=-1){n=parseInt(l)}}j.data("width",n).attr("data-width",n);if(n="auto"&&this.hasAttribute("data-col-index")&&!this.hasAttribute("data-min-width")){j.data("min-width","100").attr("data-min-width","100")}}else{if(typeof(n)=="number"&&this.hasAttribute("data-col-index")){if(o){j.attr("data-nochange","true").data("nochange",true)}}}});var q=r.data("height");if(!q){var p=r.data("max-height");if(!p){r.data("height","fill").attr("data-height","fill")}}},setTableWidth:function(l){var k=l.data("width");if(k){var j=typeof(k);if(j=="number"){k=k+"px";l.table_view.css("width",k)}else{if(j=="string"&&k=="auto"){l.table_view.css({"width":"100%","max-width":"100%"})}else{if(j=="string"&&k=="fill"){l.table_view.css({"width":"100%","max-width":"100%"})}else{if(j=="string"&&k.indexOf("%")!=-1&&k!="100%"){l.table_view.css({"width":k,"max-width":k})}else{l.table_view.css({"width":k,"max-width":k})}}}}}},processMasterSlaveBoxHeight:function(n){mainPjaxContainer.css({"overflow":"auto"});var m=n.closest(".jbolttable_master_slave_box");if(!isOk(m)){return false}mainPjaxContainer.css({"overflow":"hidden"});n.data("in-master-slave",true);var l=m.closest(".jbolt_page");var j=l.height();var k=l.find(".jbolt_page_title");if(isOk(k)){j=j-parseInt(k.outerHeight())}j=j-18;m.css({"height":j,"max-height":j})},processTableFillBox:function(k){if(k.data("height")!="fill_box"){return false}var j=k.table_view.outerHeight();j=j-41;if(k.data("page")){j=j-44}if(k.data("toolbar")){j=j-44}k.table_body.css("height",j+"px")},setTableHeight:function(r){var n=this,q=r.data("height");maxheight=r.data("max-height");if(!q&&maxheight){q=maxheight}if(q){var p=typeof(q);if(p=="string"&&(q=="100%"||q=="fill")){var l=n.getFillHeight(r);if(!maxheight){r.table_body.css("height",l+"px")}r.table_body.css("max-height",l+"px")}else{if(p=="string"&&q=="fill_box"){n.processTableFillBox(r)}else{if(p=="string"&&q.indexOf("%")!=-1){var l=n.getFillHeight(r);var m=Number(q.replace("%",""))/100;var j=parseInt(l*m);if(!maxheight){r.table_body.css("height",j+"px")}r.table_body.css("max-height",j+"px")}else{var o=r.find("thead"),k=o.outerHeight();q=q-k-4;if(!maxheight){r.table_body.css("height",q+"px")}r.table_body.css("max-height",q+"px")}}}n.refreshMainTableVScroll(r)}},getFillHeightInMasterSlaveBox:function(k){var j=k.table_view.closest(".split");if(isOk(j)){return parseInt(j.height())-thh}},getFillHeight:function(w){var l=w.table_view.closest(".jbolttable_master_slave_box");if(isOk(l)){return this.getFillHeightInMasterSlaveBox()}var p=this,q=w.find("thead"),o=q.outerHeight(),t=parseInt(w.height()),v=t;var n=w.table_view.closest(".jbolt_page");if(isOk(n)){v=0;if(self!=top){v=Math.floor(jboltWindowHeight-50)}else{var r=n.closest(".jbolt_layer_portal");if(isOk(r)){v=Math.floor(r.height())-50}else{v=Math.floor(mainPjaxContainer.height())-50}}var m=n.find(".jbolt_page_title");if(isOk(m)){v=v-parseInt(m.outerHeight())}}else{v=0;if(self!=top){v=parseInt(jboltWindowHeight-50)}else{var r=n.closest(".jbolt_layer_portal");if(isOk(r)){v=Math.floor(r.height())-50}else{v=jboltWindowHeight-50;var k=f(".jbolt_admin_main_top");if(isOk(k)){v=parseInt(v-k.outerHeight())}}}}var j=w.table_view.find(".jbolt_table_pages");if(isOk(j)){var s=Math.ceil(j.outerHeight());v=v-s}if(isOk(w.toolbar)){var u=Math.ceil(w.toolbar.outerHeight());v=v-u}var x=w.data("height-elements");if(isOk(x)){n.find(x).each(function(){v=v-Math.ceil(f(this).outerHeight())})}v=v-o;return Math.floor(v)},isSetRightFixedColumn:function(j){return j.data("fixed-columns-right")},isSetFixedColumn:function(j){return(j.data("fixed-columns-left")||j.data("fixed-columns-right"))},processTableStyle:function(k){var j=this;j.processCellWidthAndHeight(k);j.processHeaderFixed(k);j.processColumnFixed(k);j.processEmptyTableBody(k)},processColumnFixed:function(j){this.processColumnFixedLeft(j);this.processColumnFixedRight(j);this.refreshFixedColumnHScroll(j)},processFixedColumnTableTrHoverEvent:function(j){j.table_box.on("mouseenter",".jbolt_table_fixed>.jbolt_table_body>table>tbody>tr",function(){var l=f(this);var k=l.index();j.find("tbody>tr:eq("+k+")").addClass("hover");if(isOk(j.fixedColumnTables)){j.fixedColumnTables.find("tbody>tr:eq("+k+")").addClass("hover")}}).on("mouseleave",".jbolt_table_fixed>.jbolt_table_body>table>tbody>tr",function(){var l=f(this);var k=l.index();j.find("tbody>tr:eq("+k+")").removeClass("hover");if(isOk(j.fixedColumnTables)){j.fixedColumnTables.find("tbody>tr:eq("+k+")").removeClass("hover")}})},processMainTableTrHoverEvent:function(j){j.on("mouseenter","tbody>tr",function(){var l=f(this);l.addClass("hover");var k=l.index();if(isOk(j.fixedColumnTables)){j.fixedColumnTables.find("tbody>tr:eq("+k+")").addClass("hover")
}}).on("mouseleave","tbody>tr",function(){var l=f(this);l.removeClass("hover");var k=l.index();if(isOk(j.fixedColumnTables)){j.fixedColumnTables.find("tbody>tr:eq("+k+")").removeClass("hover")}})},processMainTableBodyScrollAndResizeEvent:function(k){var j=this;k.table_body.on("scroll",function(m){var n=k.table_body.scrollLeft();k.fixed_header.table.css("margin-left",(0-n)+"px");var l=k.table_body.scrollTop();if(isOk(k.fixedColumnTables)){k.fixedColumnTables.css("margin-top",(0-k.thead.height-l)+"px")}}).on("resize",function(){j.processTableColWidthAfterResize(k);j.refreshMainTableVScroll(k);j.refreshFixedColumnHScroll(k)})},processTableEvent:function(k){var j=this;j.processMainTableBodyScrollAndResizeEvent(k);j.processMainTableTrHoverEvent(k);j.processFixedColumnTableTrHoverEvent(k);j.processTableColWidthResizeAndColSortEvent(k);j.processTableColumnPrependEvent(k);j.processFixedColumnScrollEvent(k)},processFixedColumnScrollEvent:function(j){j.table_view.on("mousewheel",".jbolt_table_fixed",function(l){var k=j.table_body.scrollTop();k=k-l.originalEvent.wheelDelta;j.table_body.scrollTop(k);return false})},processTableColumnPrependEvent:function(k){var l=k.data("column-prepend");if(!l){return false}var j=this;k.table_view.on("change",".jbolt_table_checkbox>input[type='checkbox']",function(m){if(this.checked){f(this).parent().addClass("checked")}else{f(this).parent().removeClass("checked")}});k.table_view.on("click","table>thead>tr>th>.jbolt_table_checkbox>input[type='checkbox']",function(n){var o=f(this).parent();var m=this.name;if(this.checked){CheckboxUtil.checkAll(m)}else{CheckboxUtil.uncheckAll(m)}});k.table_view.on("click","table>tbody>tr>td>.jbolt_table_checkbox>input[type='checkbox']",function(r){var m=f(this).parent();var u=m.closest("tr").index();var x=m.closest("td").data("col-index");var s=f(this);var o=s.closest("table.jbolt_main_table");var n=isOk(o);var t=s.closest(".jbolt_table_fixed");var q=isOk(t);var w=k.table_view.find("table>thead>tr>th[data-col-index='"+x+"']>.jbolt_table_checkbox>input[type='checkbox']");if(this.checked){if(j.isCheckboxCheckedAll(k)){CheckboxUtil.checkIt(w)}}else{CheckboxUtil.uncheckIt(w)}if(n&&!q){if(isOk(k.fixedColumnTables)){var v=k.fixedColumnTables.find("tbody>tr:eq("+u+")>td[data-col-index='"+x+"']>.jbolt_table_checkbox>input[type='checkbox']");if(isOk(v)){if(this.checked){CheckboxUtil.checkIt(v)}else{CheckboxUtil.uncheckIt(v)}}}}else{if(q&&!n){var p=k.find("tbody>tr:eq("+u+")>td[data-col-index='"+x+"']>.jbolt_table_checkbox>input[type='checkbox']");if(isOk(p)){if(this.checked){CheckboxUtil.checkIt(p)}else{CheckboxUtil.uncheckIt(p)}}}}})},getCheckboxCheckedCount:function(j){return j.find("tbody>tr>td>.jbolt_table_checkbox>input[type='checkbox'][name='jboltTableCheckbox']:checked").length},getRadioCheckedCount:function(j){return j.find("tbody>tr>td>.jbolt_table_radio>input[type='radio'][name='jboltTableRadio']:checked").length},isCheckboxCheckedAll:function(j){return j.find("tbody>tr").length==this.getCheckboxCheckedCount(j)},isCheckboxCheckedOne:function(j){return this.getCheckboxCheckedCount(j)==1},isCheckboxCheckedNone:function(j){return this.getCheckboxCheckedCount(j)==0},isRadioCheckedOne:function(j){return this.getRadioCheckedCount(j)==1},isRadioCheckedNone:function(j){return this.getRadioCheckedCount(j)==0},isCheckboxCheckedMulti:function(j){return this.getCheckboxCheckedCount(j)>1},processTableThResizeAndSortStyleEvent:function(p){if(p.target.tagName=="TH"){var m=f(p.target);m.data("can-sort",false).attr("data-can-sort",false);var n=m.parent(),j=m.data("resizing");var k=m.outerWidth()-10,o=m.offset().left;var l=p.clientX-o;if(m.hasClass("resize_col")){if(!j){if(l>=k){m.data("can-resize",true).attr("data-can-resize",true);if(n.css("cursor")!="col-resize"){n.css("cursor","col-resize")}}else{m.data("can-resize",false).attr("data-can-resize",false);if(m.hasClass("sort_col")){n.css("cursor","pointer");m.data("can-sort",true).attr("data-can-sort",true)}else{if(n.css("cursor")!="auto"){n.css("cursor","auto")}}}}}else{if(m.hasClass("sort_col")){n.css("cursor","pointer");m.data("can-sort",true).attr("data-can-sort",true)}else{n.css("cursor","auto");m.data("can-resize",false).attr("data-can-resize",false).data("can-sort",false).attr("data-can-sort",false)}}}},processTableColWidthResizeAndColSortEvent:function(k){var j=this;if(k.data("column-resize")){k.table_view.on("mousemove",function(q){var s=k.table_view.find("table>thead>tr>th[data-resizing='true']");if(isOk(s)){if(k.right_fixed){k.right_fixed.addClass("jbolt_table_fixed_hide")}var m=s.outerWidth()-10,p=s.offset().left;var o=q.clientX-p;var n=s.data("width");var r=s.data("min-width");if(r){n=r}if(o>n){j.resizeTheadTh(k,s.data("col-index"),o)}}else{j.processTableThResizeAndSortStyleEvent(q)}}).on("mousedown",".jbolt_table_header>table>thead>tr>th.resize_col",function(n){var m=f(this);var p=m.data("can-resize");m.data("resizing",p?true:false).attr("data-resizing",p?true:false);if(p){var o=m.parent().css("cursor");if(o="col-resize"){k.table_box.find("table.jbolt_table.novscroll").addClass("col_last_need_border_right active")
}}return false}).on("mouseup",function(m){m.preventDefault();f(this).find(".jbolt_table_header>table>thead>tr>th").data("resizing",false).data("can-resize",false).attr("data-resizing",false).attr("data-can-resize",false);j.refreshFixedColumnHScroll(k)})}else{k.table_view.on("mousemove",function(m){j.processTableThResizeAndSortStyleEvent(m)})}k.table_view.on("click",".jbolt_table_header>table>thead>tr>th[data-can-sort='true']",function(p){p.preventDefault();p.stopPropagation();if(p.target.tagName=="I"){var m=f(p.target),n,o=m.closest("th");if(m.hasClass("sort_asc")){n="asc"}else{if(m.hasClass("sort_desc")){n="desc"}}j.sortByCol(k,o,n)}else{j.sortByCol(k,f(this))}return false});var l=k.data("ajax");if(!l){k.table_view.on("mouseenter",".jbolt_table_header>table>thead>tr",function(r){if(r.target.tagName=="TH"){var o=f(r.target),p=o.parent();var m=o.outerWidth()-10,q=o.offset().left;var n=r.clientX-q;if(n<m){p.css("cursor","pointer");o.data("can-sort",true).attr("data-can-sort",true)}}})}},sortByCol:function(s,k,n){var l=k.data("column");var r=k.data("col-index");s.data("sort-column",l).attr("data-sort-column",l);var m=s.data("default-sort-column");if(m&&l==m&&!n){var j=k.find("i.sort.active");if(isOk(j)){if(j.hasClass("sort_desc")){n="asc"}}}if(n){var p=s.table_view.find("table>thead>tr>th[data-col-index='"+r+"']");s.table_view.find("i.sort.active").removeClass("active");if(n=="desc"){s.data("sort-type","desc").attr("data-sort-type","desc");p.find("i.sort.sort_desc").addClass("active")}else{if(n=="asc"){s.data("sort-type","asc").attr("data-sort-type","asc");p.find("i.sort.sort_asc").addClass("active")}}}else{var o=k.find("i.sort.active");var p=s.table_view.find("table>thead>tr>th[data-col-index='"+r+"']");s.table_view.find("i.sort.active").removeClass("active");if(isOk(o)){if(o.hasClass("sort_asc")){s.data("sort-type","desc").attr("data-sort-type","desc");p.find("i.sort.sort_desc").addClass("active")}else{if(o.hasClass("sort_desc")){s.data("sort-column","").removeAttr("data-sort-column").data("sort-type","").removeAttr("data-sort-type")}}}else{p.find("i.sort.sort_asc").addClass("active");s.data("sort-type","asc").attr("data-sort-type","asc")}}var q=s.data("ajax");if(q){this.readByPage(s,1)}else{this.tableSubmitForm(s,1)}},resizeTheadTh:function(l,k,j){l.table_view.find("table>thead>tr>th[data-col-index='"+k+"']").css({"width":j+"px","min-width":j+"px","max-width":j+"px"});l.table_view.find("table>tbody>tr>td[data-col-index='"+k+"']").css({"width":j+"px","min-width":j+"px","max-width":j+"px"})},refreshMainTableVScroll:function(j){var n=this;var l=parseInt(j.find("thead").outerHeight())+1;var q=checkTableBodyHasScrolled(j,"v");if(q){j.table_box.find("table").removeClass("novscroll")}else{j.table_box.find("table").addClass("novscroll")}n.processHeaderRight(j);var p=j.data("height");var o=(typeof(p)=="string"&&p=="fill");var m=parseInt(j.height());var k=parseInt(j.table_body.height());if(o){if(q){j.table_box.find(".jbolt_table_body>table").addClass("noBottomBorder")}else{j.table_box.find(".jbolt_table_body>table").removeClass("noBottomBorder")}}else{if(m<k){j.table_box.find(".jbolt_table_body>table").removeClass("noBottomBorder")}else{j.table_box.find(".jbolt_table_body>table").addClass("noBottomBorder")}}},refreshFixedColumnHScroll:function(j){var p=this;var l=checkTableBodyHasScrolled(j,"h");var o=checkTableBodyHasScrolled(j,"v");var t=parseInt(j.find("thead").outerHeight())+1;var r=parseInt(j.table_body.height());var s=parseInt(j.height());var q=j.data("height");var m=(typeof(q)=="string"&&q=="fill");if(m){if(l){var u=getScrollBarHeight(j.table_body[0]);r=r-u}else{if(!o){r=s-t}}}else{if(l){var u=getScrollBarHeight(j.table_body[0]);r=r-u}}if(isOk(j.left_fixed)){j.left_fixed.body.css({"max-height":r+"px","height":"auto"});if(l){j.left_fixed.removeClass("jbolt_table_fixed_hide")}else{j.left_fixed.addClass("jbolt_table_fixed_hide")}}if(isOk(j.right_fixed)){j.right_fixed.body.css({"max-height":r+"px","height":"auto"});if(o){var n=getScrollBarWidth(j.table_body[0]);j.right_fixed.css({"right":n+"px"});var k=j.right_fixed.header.find(".jbolt_table_fixed_right_mend");if(!isOk(k)){j.right_fixed.header.append("<div class='jbolt_table_fixed_right_mend' style='width:"+n+"px;right:"+(0-n)+"px'></div>")}}else{j.right_fixed.css({"right":"-1px"});j.right_fixed.header.find(".jbolt_table_fixed_right_mend").remove()}if(l){j.right_fixed.removeClass("jbolt_table_fixed_hide")}else{j.right_fixed.addClass("jbolt_table_fixed_hide")}}},getColumnFixedIndexArr:function(k,l){var j=k.data("fixed-columns-"+l),m;if(j){if(typeof(j)=="number"){m=[j]}else{m=j.split(",")}}return m},cloneTableBoxContent:function(t,v,j){var r=this;var k="jbolt_table_fixed_"+v;var n=f('<div class="jbolt_table_fixed"></div>');n.addClass(k);var l=t.find(".jbolt_table_header:first").clone();var w=t.find(".jbolt_table_body:first").clone();var u=j.length;var s=l.find("thead>tr");var q=s.length;if(q==1){var p="table>thead>tr>th:not(",m="table>tbody>tr>td:not(";for(var x=0;x<u;
x++){p=p+(x>0?",":"")+":nth-child("+j[x]+")";m=m+(x>0?",":"")+":nth-child("+j[x]+")"}p=p+")";m=m+")";l.find(p).remove();w.find(p).remove();w.find(m).remove()}else{var z="table>thead>tr>th:not(",o="table>tbody>tr>td:not(";for(var x=0;x<u;x++){z=z+(x>0?",":"")+"[data-fixed-col-index='"+j[x]+"']";o=o+(x>0?",":"")+"[data-fixed-col-index='"+j[x]+"']"}z=z+")";o=o+")";l.find(z).remove();w.find(z).remove();w.find(o).remove()}if(v=="right"){l.find("table>thead>tr>th.resize_col").removeClass("resize_col")}n.append(l);n.append(w);l.table=l.find("table");var A=l.table.css("width");if(A&&typeof(A)=="string"&&A.indexOf("px")!=-1){l.table.css({"width":"auto"})}w.table=w.find("table");var y=w.table.css("width");if(y&&typeof(y)=="string"&&y.indexOf("px")!=-1){w.table.css({"width":"auto"})}r.clearTableData(l.table);r.clearTableData(w.table);n.header=l;n.body=w;return n},processColumnFixedLeft:function(l){var k=this;var m=k.getColumnFixedIndexArr(l,"left");if(!m||m.length==0){return false}var j=k.cloneTableBoxContent(l.table_box,"left",m);l.table_box.append(j);initToolTip(j);l.left_fixed=j;l.fixedColumnTables=l.table_box.find(".jbolt_table_fixed>.jbolt_table_body>table")},processColumnFixedRight:function(l){var k=this;var m=k.getColumnFixedIndexArr(l,"right");if(!m||m.length==0){return false}var j=k.cloneTableBoxContent(l.table_box,"right",m);j.addClass("jbolt_table_fixed_hide");l.table_box.append(j);initToolTip(j);l.right_fixed=j;l.fixedColumnTables=l.table_box.find(".jbolt_table_fixed>.jbolt_table_body>table")},processHeaderRight:function(k){var j=getScrollBarWidth(k.table_body[0]);if(j){k.table_box.find(".jbolt_table_header").css("padding-right",j+"px")}else{k.table_box.find(".jbolt_table_header").css("padding-right","0px")}},clearTableData:function(j){j.removeAttr("data-jbolttable");j.removeAttr("data-fixed-columns-left");j.removeAttr("data-fixed-columns-right");j.removeClass("jbolt_main_table");j.removeAttr("id")},processHeaderFixed:function(m){var l=this,k=m.clone(),n=k.find("thead");l.clearTableData(k);if(m.data("column-resize")){n.find("tr>th").addClass("resize_col")}k.find("tbody").remove();var j=f("<div>");j.addClass("jbolt_table_header");j.append(k);m.table_body.before(j);m.css("margin-top","-"+m.thead.height+"px");m.table_box.addClass("fixedHeader");l.processHeaderRight(m);initToolTip(n);j.table=k;m.fixed_header=j},processTableColWidthAfterResize:function(k){var j=this;j.processCellWidthAndHeight(k)},processTheadWidthCompletion:function(u){var r=this,v=60,m,p,t,s=0;var q=checkTableBodyHasScrolled(u,"v");var o=q?getScrollBarWidth(u.table_body[0]):0;if(q){u.tableBodyLeaveWidth=u.tableBodyLeaveWidth-o-1}t=u.thead.find("tr>th[data-col-index][data-width='auto'],tr>th[data-col-index]:not([data-width]),tr>th[data-col-index]:not([data-nochange]):not([data-column='index']):not([data-column='checkbox']):not([data-column='optcol'])");if(isOk(t)){p=t.length;if(u.tableBodyLeaveWidth<200&&p>=2){v=100}else{v=Math.floor(u.tableBodyLeaveWidth/p);s=u.tableBodyLeaveWidth-v*p;var l=u.closest(".jbolt_page").find("[data-jbolttable]");if(l.length==1){if(u.thead.trs.length>1){s=s-2}}else{if(u.thead.trs.length>2){s=s-2}else{if(u.thead.trs.length>1){s=s-1}}}}var k,j,n;t.each(function(w){m=f(this);j=v;if(w==p-1){j=j+s}n=m.data("min-width")||m.data("width");if(n<100){n=100}if(j<n){j=n}r.resizeTheadTh(u,m.data("col-index"),j)})}},processCellWidthAndHeight:function(n){var m=this;var j=n.thead.find("th[data-col-index]");var o=j.length;n.tableBodyLeaveWidth=n.table_body.width()-1;for(var k=0;k<o;k++){m.setOneColumnWidth(n,k,j.eq(k))}var l=n.data("width");if(l&&l!="auto"){m.processTheadWidthCompletion(n)}if(!n.data("ajax")){m.processCellHeight(n)}m.processTheadThHeight(n);if(n.hasClass("novscroll")){n.addClass("col_last_need_border_right")}},processHeadThAndBodyTbFinalWidth:function(y){var t=this;var u=y.find("thead"),q=y.find("tbody"),l=u.find("tr>th[data-col-index]:not(.jbolt_table_last_th)");if(!isOk(l)){return false}var x=l.length,o,n,k,m,s=0,r=new Array();for(var p=0;p<x;p++){n=l.eq(p);o=n.data("col-index");k=n[0].offsetWidth;var v=parseInt(n.css("border-left-width"));var w=parseInt(n.css("border-right-width"));k=k-v;m=n.data("width");if(!m||m=="auto"){r.push(o)}else{if(k<m){k=m}s=s+k;t.resizeTheadTh(y,o,k)}}var j={totalWidth:s,autoThColIndex:r};return j},processHeadThAndBodyTbAutoWidth:function(s){var p=this;var q=s.find("thead"),o=s.find("tbody"),k=q.find("tr>th[data-col-index][data-width='auto']:not(.jbolt_table_last_th)");if(!isOk(k)){return false}o.hide();var r=k.length,m,l,j;for(var n=0;n<r;n++){l=k.eq(n);m=l.data("col-index");j=l.outerWidth();p.resizeTheadTh(s,m,j)}o.show()},processCellWidthAfterAjax:function(s){var p=this;var k,t,r,j=s.thead.find("th[data-col-index]");j.each(function(u){k=f(this);t=k.data("old-width");p.resizeTheadTh(s,k.data("col-index"),t)});s.table_view.find("table").removeClass("col_last_need_border_right");p.processCellHeight(s);var o=checkTableBodyHasScrolled(s,"v");var l=s.outerWidth()-(s.table_body.outerWidth()-1);
var n=getScrollBarWidth(s.table_body[0]);var q=s.thead.find("tr>th[data-col-index][data-width='auto'],tr>th[data-col-index]:not([data-width]),tr>th[data-col-index]:not([data-nochange]):not([data-column='index']):not([data-column='checkbox']):not([data-column='optcol'])");if(isOk(q)){var m=q.eq(0);if(l>=0){if(o){r=m.outerWidth()-n-l}else{r=m.outerWidth()-l+1}}else{if(o){r=m.outerWidth()-l-n}else{r=m.outerWidth()-l+n}}if(r){p.resizeTheadTh(s,m.data("col-index"),r)}}},processOneAutoThWidthByTrChange:function(s){var p=this;var o=checkTableBodyHasScrolled(s,"v");var m=checkTableBodyHasScrolled(s,"h");var q=s.find("thead");if(!o&&!m){var n=s[0].style.width="auto";if(n){var j=parseInt(s.fixed_header.css("padding-right"));var k=s.table_body.width()-s.width();if(k>=10||k<=-10){var l=q.find("tr>th[data-col-index][data-width='auto']:first");if(!isOk(l)){l=q.find("tr>th[data-col-index]:not([data-width]):first")}if(isOk(l)){var r=l.outerWidth()+k;p.resizeTheadTh(s,l.data("col-index"),r)}return}}}else{if(o&&!m){var n=s[0].style.width="auto";if(n){var j=parseInt(s.fixed_header.css("padding-right"));var k=s.table_body.width()-s.width();if(j==0&&(k<=5||k>=-5)){var l=q.find("tr>th[data-col-index][data-width='auto']:first");if(!isOk(l)){l=q.find("tr>th[data-col-index]:not([data-width]):first")}if(isOk(l)){var r=l.outerWidth()-17;p.resizeTheadTh(s,l.data("col-index"),r)}}}}}},processCellHeight:function(k){var l,j;k.find("tbody>tr").each(function(){l=f(this);j=l.find("td:first").outerHeight()+"px";l.find("td").css({"height":j,"min-height":j,"max-height":j,})})},processTheadThHeight:function(k){var j,l;k.find("thead>tr>th").each(function(){j=f(this);l=j.outerHeight()+"px";j.css({"height":l,"min-height":l,"max-height":l,})})},setOneAutoWidthColumnWidth:function(o,j,n,l){var k=n.data("width"),p=(typeof(k)=="string"&&k=="auto"),q=j+1,m;if(!p){return false}if(o.data("width")=="auto"){l=n.data("min-width")||100}else{l=n.data("min-width")||l}k=l;m=n.data("max-width")||k;n.css({"min-width":l,"max-width":m,"width":k});if(!o.data("ajax")){o.tbody.find("tr>td[data-col-index='"+j+"']").css({"min-width":l,"max-width":m,"width":k})}},setOneColumnWidth:function(n,j,m){var l=m.data("width");var o=m.data("min-width");if(o){l=o}if(!l||(typeof(l)=="string"&&l=="auto")){return false}var k=m.data("column");if((k&&(k=="index"||k=="checkbox"||k=="radio"||k=="optcol"))||m[0].hasAttribute("data-nochange")){n.tableBodyLeaveWidth=n.tableBodyLeaveWidth-l}this.resizeTheadTh(n,m.data("col-index"),l)},setOneColumnWidthAfterAjax:function(n,k,m,p,j,o){var q=k+1,n=p.find("tr>th[data-col-index='"+k+"']");var l=n[0].offsetWidth;m.tbody.find("tr>td[data-col-index='"+k+"']").css({"min-width":l,"max-width":l,"width":l})}};f.fn.jboltTable=function(j){if(h[j]){return h[j].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof j==="object"||!j){return h.init(this)}else{f.error("Method"+j+"does not exist on jQuery.jboltTable")}}}})(jQuery);(function(a){var b={init:function(c){var d=this;return c.each(function(){var j=a(this);j.removeClass("table-striped");j.addClass("jbolt_tree_table text-nowrap");var f=j.find("tbody");var k=j.data("parent-td-index");if(k==undefined||k=="undefined"){k=0}f.find("tr[data-parent]>td:nth-child("+k+")").data("parent-td",true).attr("data-parent-td","true").append('<i class="fa fa-angle-down parent_flag">').off("click").on("click",function(){var m=a(this);var l=m.closest("tr");if(m.hasClass("expand")){d.collapseAll(l)}else{d.expand(l)}});var i=j.data("expandall-trigger");if(i){a(i).off("click").on("click",function(l){l.preventDefault();l.stopPropagation();j.jboltTreeTable("expandAll");return false})}var h=j.data("collapseall-trigger");if(h){a(h).off("click").on("click",function(l){l.preventDefault();l.stopPropagation();j.jboltTreeTable("collapseAll");return false})}var e=j[0].hasAttribute("data-expandall");if(e){j.jboltTreeTable("expandAll")}if(j[0].hasAttribute("data-jbolttable")){j.jboltTable()}j.data("inited",true)})},expand:function(d){var c=d.data("id");d.siblings("tr[data-pid='"+c+"']").show(200);d.find("td[data-parent-td]").addClass("expand")},expandAll:function(h){var f=this;if(h){f.expand(h);if(h[0].hasAttribute("data-parent")){var e=h.data("id");var d=h.siblings("tr[data-pid='"+e+"']");if(d&&d.length>0){var c;d.each(function(){c=a(this);f.expand(c);f.expandAll(c)})}}}else{f.find("tr[data-son]").show(200);f.find("td[data-parent-td]").addClass("expand")}},collapse:function(d){var c=d.data("id");d.siblings("tr[data-pid='"+c+"']").hide(200);d.find("td[data-parent-td]").removeClass("expand")},collapseAll:function(h){var f=this;if(h){var e=h.data("id");if(h[0].hasAttribute("data-parent")){var d=h.siblings("tr[data-pid='"+e+"']");if(d&&d.length>0){var c;d.each(function(){c=a(this);f.collapse(c);f.collapseAll(c)})}}f.collapse(h)}else{f.find("tr[data-son]").hide(200);f.find("td[data-parent-td]").removeClass("expand")}},};a.fn.jboltTreeTable=function(c){if(b[c]){return b[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return b.init(this)
}else{a.error("Method"+c+"does not exist on jQuery.jboltTreeTable")}}}})(jQuery);